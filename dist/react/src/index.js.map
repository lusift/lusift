{"version":3,"file":"index.js","sources":["../../../node_modules/global/window.js","../../../src/common/logger.ts","../../../src/common/store/localStorage.ts","../../../src/common/utils/isOfType/index.ts","../../../src/common/utils/mergeObjects.ts","../../../src/common/utils/styleObjectToString.ts","../../../src/common/utils/getStepUID.ts","../../../src/common/utils/getElementPosition.ts","../../../src/common/utils/changeAsyncStepStatus.ts","../../../src/common/utils/roundNum.ts","../../../src/common/utils/doesStepMatchDisplayCriteria.ts","../../../src/common/utils/doesStringMatchRegex.ts","../../../src/common/constants/index.ts","../../../src/common/progressBar/renderProgressBar.ts","../../../src/common/closeXButton/renderCloseXButton.ts","../../../../floating-ui-tooltip/dist/index.js","../../../src/common/createTooltip.ts","../../../src/tooltip/createTooltip.ts","../../../src/tooltip/defaultTooltipActions.ts","../../../src/backdrop/Backdrop.ts","../../../src/common/utils/dimensions.ts","../../../src/tooltip/Tooltip.ts","../../../src/modal/Modal.ts","../../../src/modal/createModal.ts","../../../src/hotspot/createHotspotTooltip.ts","../../../src/hotspot/beacon-element.ts","../../../src/hotspot/Hotspot.ts","../../../src/common/utils/startStepInstance.ts","../../../node_modules/tabbable/dist/index.esm.js","../../../node_modules/focus-trap/dist/focus-trap.esm.js","../../../src/common/utils/addFocusTrap.ts","../../../src/common/utils/debounce.ts","../../../src/lusift/Guide.ts","../../../node_modules/lodash.isequal/index.js","../../../src/lusift/Lusift.ts","../../../src/lusift/addDefaultCSS.ts","../../../src/react/src/index.tsx","../../../src/common/utils/vanillaRender.ts"],"sourcesContent":["var win;\n\nif (typeof window !== \"undefined\") {\n    win = window;\n} else if (typeof global !== \"undefined\") {\n    win = global;\n} else if (typeof self !== \"undefined\"){\n    win = self;\n} else {\n    win = {};\n}\n\nmodule.exports = win;\n","const messagePrefix = \"Lusift:\";\n\n/* export function log(message: string, ...args: any[]) {\n    console.log(`${messagePrefix} ${message}`, ...args);\n} */\nexport const log = console.log;\n\nexport function warn(message: string, ...args: any[]) {\n    console.warn(`${messagePrefix} ${message}`, ...args);\n}\n\nexport function error(message: string, ...args: any[]) {\n    console.error(`${messagePrefix} ${message}`, ...args);\n}\n","import { window, document } from \"global\";\nimport { error } from \"../logger\";\n\nif (!window) {\n    error(\"window is undefined\");\n}\n\n/**\n * This function checks if the lusift_state is saved in localStorage\n */\nexport const loadState = () => {\n    try {\n        // Load the data saved in localStorage, against the key 'lusift_state'\n        const serialisedState = window.localStorage.getItem(\"lusift_state\");\n\n        // Passing undefined to createStore will result in our app getting the default state\n        // If no data is saved, return undefined\n        if (!serialisedState) return undefined;\n\n        // De-serialise the saved state, and return it.\n        return JSON.parse(serialisedState);\n    } catch (err) {\n        // Return undefined if localStorage is not available,\n        // or data could not be de-serialised,\n        // or there was some other error\n        return undefined;\n    }\n};\n\n/**\n * This function accepts the app state, and saves it to localStorage\n * @param state\n */\n\nexport const saveState = state => {\n    try {\n        // Convert the state to a JSON string\n        const serialisedState = JSON.stringify(state);\n\n        // Save the serialised state to localStorage against the key 'lusift_state'\n        window.localStorage.setItem(\"lusift_state\", serialisedState);\n    } catch (err) {\n        // Log errors here, or ignore\n    }\n};\n","import { GuideType, Content } from \"../../types\";\nimport { log } from \"../../logger\";\n\nexport function isObject(item: any): boolean {\n    return item instanceof Object && item.constructor === Object;\n}\n\nexport function isObjectOrUndefined(object: any): boolean {\n    return isObject(object) || typeof object === \"undefined\";\n}\n\nexport function isOfTypeTooltipData(object: any): boolean {\n    const placements = [\"bottom\", \"top\", \"right\", \"left\", \"auto\"];\n    placements.forEach(p => {\n        placements.push(`${p}-start`);\n        placements.push(`${p}-end`);\n    });\n\n    return (\n        isObject(object) &&\n        typeof object.arrow === \"boolean\" &&\n        (!object.offset || (object.offset instanceof Object && object.offset.length === 2)) &&\n        (!object.actions || isObject(object.actions)) &&\n        placements.includes(object.placement) &&\n        (typeof object.contentBody === \"string\" ||\n            (!object.contentBody && typeof object.contentBody !== \"boolean\")) &&\n        // (typeof object.contentBody === 'string' && !!object.contentBody) &&\n        isObjectOrUndefined(object.progressOn) &&\n        isObjectOrUndefined(object.backdrop)\n    );\n}\n\nexport function isOfTypeTarget(object: any, type: string): boolean {\n    const comparators = [\"is\", \"contains\", \"endsWith\", \"startsWith\"];\n    const elementSelectorExists =\n        typeof object.elementSelector === \"string\" && !!object.elementSelector;\n\n    return (\n        isObject(object) &&\n        (elementSelectorExists || type === \"modal\") && //validate element selector\n        isObject(object.path) &&\n        typeof object.path.comparator === \"string\" &&\n        comparators.includes(object.path.comparator) &&\n        typeof object.path.value === \"string\"\n    ); //validate path\n}\n\nexport function isOfTypeTooltipActions(object: any): boolean {\n    return (\n        isObject(object) &&\n        Object.entries(object).every(prop => isObject(prop)) &&\n        isObjectOrUndefined(object.closeButton.styleProps) &&\n        isObjectOrUndefined(object.navSection.styleProps) &&\n        isObjectOrUndefined(object.navSection.nextButton) &&\n        isObjectOrUndefined(object.navSection.nextButton.styleProps) &&\n        isObjectOrUndefined(object.navSection.prevButton) &&\n        isObjectOrUndefined(object.navSection.dissmissLink) &&\n        isObjectOrUndefined(object.navSection.dissmissLink.styleProps)\n    );\n}\n\nexport function isOfTypeTooltip(object: any): boolean {\n    return (\n        isOfTypeTooltipData(object.data) &&\n        isObjectOrUndefined(object.styleProps) &&\n        object.type === \"tooltip\" &&\n        isOfTypeTooltipData(object.data)\n    );\n}\n\nexport function isOfTypeModal(object: any): boolean {\n    return (\n        object.type === \"modal\" && isObject(object.data) && isObjectOrUndefined(object.closeButton)\n    );\n}\n\nexport function isOfTypeHotspot(object: any): boolean {\n    return object.type === \"hotspot\";\n}\n\nexport function isOfTypeStep(object: any): boolean {\n    const stepTypes = [\"tooltip\", \"hotspot\", \"modal\"];\n\n    return (\n        isObject(object) &&\n        typeof object.index === \"number\" &&\n        stepTypes.includes(object.type) &&\n        // target\n        isOfTypeTarget(object.target, object.type) &&\n        (isOfTypeTooltip(object) || isOfTypeHotspot(object) || isOfTypeModal(object))\n    );\n}\n\nexport function isOfTypeGuide(object: any): boolean {\n    return (\n        isObject(object) &&\n        typeof object.id === \"string\" &&\n        !!object.id &&\n        typeof object.name === \"string\" &&\n        typeof object.description === \"string\" &&\n        object.steps instanceof Object &&\n        object.steps.hasOwnProperty(\"length\") &&\n        object.steps.every(isOfTypeStep)\n    );\n}\n\nexport function isOfTypeContent(object: Content): boolean {\n    const itemTypes = [\"guide\"];\n    return (\n        isObject(object) &&\n        Object.values(object).every((item: any) => {\n            return typeof itemTypes.includes(item.type) && isOfTypeGuide(item.data);\n        })\n    );\n}\n\nexport function isOfTypeHtmlElement(element): boolean {\n    log(\"bodyContent\");\n    if (typeof element !== \"object\") return false;\n    return (\n        element.constructor.name.startsWith(\"HTML\") && element.constructor.name.endsWith(\"Element\")\n    );\n}\n\nexport const isReactComponent = (component: any): boolean => {\n    return typeof component === \"function\";\n};\n\nexport const isReactClassComponent = (component: any): boolean => {\n    // there's component.prototype.isReactComponent too\n    return isReactComponent(component) && typeof component.prototype.render === \"function\";\n};\n","import { isObject } from \"./isOfType\";\n/*\n * Deep merge properties of two objects\n * replace with lodash.merge if insufficient\n * or check this thread:\n * https://stackoverflow.com/questions/27936772/how-to-deep-merge-instead-of-shallow-merge\n */\nfunction mergeObjects(obj1: Object, obj2: Object): any {\n    obj1 = Object.assign({}, obj1);\n    obj2 = Object.assign({}, obj2);\n\n    Object.keys(obj2).forEach(key => {\n        try {\n            // Property in destination object set; update its value.\n            if (isObject(obj2[key])) {\n                obj1[key] = mergeObjects(obj1[key], obj2[key]);\n            } else {\n                obj1[key] = obj2[key];\n            }\n        } catch (e) {\n            // Property in destination object not set; create it and set its value.\n            obj1[key] = obj2[key];\n        }\n    });\n    return obj1;\n}\n\nexport default mergeObjects;\n","const camelCaseToHyphenCase = (camelCaseString: string) => {\n    return camelCaseString.replace(/[A-Z]/g, m => \"-\" + m.toLowerCase());\n};\n\nconst styleObjectToString = (styleProps: Object) => {\n    // convert and layout styleProps into string literal\n    let stylesString = \"\";\n    Object.keys(styleProps).forEach(key => {\n        stylesString += `${camelCaseToHyphenCase(key)}: ${styleProps[key]} !important;\\n`;\n    });\n    return stylesString;\n};\n\nexport default styleObjectToString;\n","const getStepUID = ({ guideID, index, type }): string => {\n    return `lusift--g-${guideID}--${type}-${index}`;\n};\nexport default getStepUID;\n","import { window, document } from \"global\";\nimport { ElementPosition } from \"../types\";\n\nconst getElementPosition = (element: HTMLElement): ElementPosition => {\n    const { documentElement, body } = document;\n\n    const scrollTop = window.pageYOffset || documentElement.scrollTop || body.scrollTop;\n    const scrollLeft = window.pageXOffset || documentElement.scrollLeft || body.scrollLeft;\n    const elementRect = element.getBoundingClientRect();\n\n    const position: ElementPosition = {\n        top: elementRect.top + scrollTop,\n        left: elementRect.left + scrollLeft,\n        right: elementRect.left + scrollLeft + elementRect.width,\n        bottom: elementRect.top + scrollTop + elementRect.height,\n        height: elementRect.height,\n        width: elementRect.width,\n    };\n    return position;\n};\n\nexport default getElementPosition;\n","import { window } from \"global\";\nimport { loadState, saveState } from \"../store\";\n\nconst changeAsyncStepStatus = (stepIndex: number, toOpen: boolean): void => {\n    const exisitingState = loadState();\n    const { id: activeGuideID } = window.Lusift.activeGuide;\n    saveState({\n        ...exisitingState,\n        [activeGuideID]: {\n            ...exisitingState[activeGuideID],\n            trackingState: {\n                ...exisitingState[activeGuideID].trackingState,\n                asyncSteps: {\n                    ...exisitingState[activeGuideID].trackingState.asyncSteps,\n                    [stepIndex]: {\n                        toOpen,\n                    },\n                },\n            },\n        },\n    });\n};\n\nexport default changeAsyncStepStatus;\n","const roundNum = (value: number, decimalPlaces: number = 2): number => {\n    return (\n        Math.round((value + Number.EPSILON) * Math.pow(10, decimalPlaces)) /\n        Math.pow(10, decimalPlaces)\n    );\n};\nexport default roundNum;\n","import { window, document } from \"global\";\nimport doesStringMatchRegex from \"./doesStringMatchRegex\";\n\nconst doesStepPathMatch = (targetPath): boolean => {\n    // is, endsWith, startsWith, contains, regex\n    const { value, comparator } = targetPath;\n    const { pathname, hash } = window.location;\n    const currentPath = pathname + hash;\n\n    switch (comparator) {\n        case \"is\":\n            return currentPath === value;\n        case \"contains\":\n            return currentPath.includes(value);\n        case \"endsWith\":\n            return currentPath.endsWith(value);\n        case \"startWith\":\n            return currentPath.startsWith(value);\n        case \"regex\":\n            return doesStringMatchRegex(currentPath, value);\n        default:\n            return false;\n    }\n};\n\nconst isStepElementFound = (elementSelector: string): boolean => {\n    /* log(this.guideData);\n     log('checking if element exists') */\n    return Boolean(document.querySelector(elementSelector));\n};\n\nconst doesStepMatchesDisplayCriteria = ({ target, type }): boolean => {\n    let criteriaMatch = doesStepPathMatch(target.path);\n    if (type !== \"modal\") {\n        criteriaMatch = criteriaMatch && isStepElementFound(target.elementSelector);\n    }\n    return criteriaMatch;\n};\n\nexport default doesStepMatchesDisplayCriteria;\n","const doesStringMatchRegex = (str: string, regex: string): boolean => {\n    // see if regex pattern matches url string (case insensitive)\n    // e.g. '/.+/dashboard' matches '/lusift/dashboard'\n    const regexPattern = new RegExp(regex, \"i\");\n    return regexPattern.test(str);\n};\nexport default doesStringMatchRegex;\n","export const MODAL_OVERLAY_CLASS = \"lusift-modal-overlay\";\nexport const BEACON_CONTAINER_CLASS = \"lusift-beacon-container\";\nexport const DEFAULT_TOOLTIP_BORDER_RADIUS = \"4px\";\nexport const DEFAULT_MODAL_BORDER_RADIUS = \"4px\";\nexport const PRIMARY_COLOR = \"#17a3a8\";\nexport const DEFAULT_PROGRESS_BAR_HEIGHT = \"3px\";\nexport const LUSIFT_CONTAINER_ID = \"lusift\";\nexport const LUSIFT_SHADOW_ROOT_ID = \"lusift-root\";\n","import { window } from \"global\";\nimport { loadState } from \"../store\";\nimport {\n    DEFAULT_TOOLTIP_BORDER_RADIUS,\n    DEFAULT_MODAL_BORDER_RADIUS,\n    PRIMARY_COLOR,\n    DEFAULT_PROGRESS_BAR_HEIGHT,\n} from \"../constants\";\n\nconst renderProgressBar = () => {\n    const currentGuide = loadState()[window.Lusift.activeGuide.id];\n\n    if (!currentGuide) return \"\";\n    if (!currentGuide) {\n        // Assuming that this is dev mode\n        let progress = \"66.66\";\n        let max = 100;\n        return `\n      <progress class=\"lusift-progress\" aria-label=\"progressbar\" max=\"${max}\" value=\"${progress}\">\n        ${progress}%\n      </progress>\n    `;\n    }\n\n    const currentStep = currentGuide.steps[currentGuide.trackingState.currentStepIndex];\n    const progressBarData = currentGuide.progressBar || {};\n\n    // find out borderRadius based on step type (their default border radii), or via styleProps\n    let {\n        height = DEFAULT_PROGRESS_BAR_HEIGHT,\n        color = PRIMARY_COLOR,\n        borderRadius,\n    } = progressBarData;\n\n    if (!borderRadius) {\n        if (currentStep.type === \"modal\") {\n            if (currentStep.styleProps) {\n                borderRadius = currentStep.styleProps.borderRadius || DEFAULT_MODAL_BORDER_RADIUS;\n            } else {\n                borderRadius = DEFAULT_MODAL_BORDER_RADIUS;\n            }\n        } else {\n            if (currentStep.styleProps) {\n                borderRadius = currentStep.styleProps.borderRadius || DEFAULT_TOOLTIP_BORDER_RADIUS;\n            } else {\n                borderRadius = DEFAULT_TOOLTIP_BORDER_RADIUS;\n            }\n        }\n    }\n    // filter out steps that are not of type hotspot with async property of true\n    const syncSteps = currentGuide.steps.filter(step => {\n        return !(step.type === \"hotspot\" && step.async);\n    });\n\n    const progress =\n        ((syncSteps.findIndex(step => {\n            return step.index === currentStep.index;\n        }) +\n            1) /\n            (syncSteps.length + 1)) *\n        100;\n\n    const max = 100;\n\n    // TODO: put this with right defaults in global default css file\n    return `\n    <style>\n      .lusift-progress {\n        height: ${height};\n      }\n      .lusift-progress::-webkit-progress-bar {\n        border-radius: ${borderRadius}; /*border-radius of tooltip*/\n      }\n      .lusift-progress::-webkit-progress-value {\n        background-color: ${color}; /*color of progress bar*/\n      }\n    </style>\n\n    <progress class=\"lusift-progress\" aria-label=\"progressbar\" max=\"${max}\" value=\"${progress}\">\n      ${progress}%\n    </progress>\n    `;\n};\n\nexport default renderProgressBar;\n","import { styleObjectToString } from \"../utils\";\n\nconst renderCloseXButton = (closeButton: any, stepType: string): string => {\n    if (closeButton.disabled) return `<div style=\"margin-top: 0.7rem\"></div>`;\n    return `\n    <style>\n      .lusift .${stepType.toLowerCase()} .closeX{\n        ${styleObjectToString(closeButton.styleProps)}\n      }\n    </style>\n\n    <section class=\"close-btn\">\n      <button onclick=\"Lusift.close()\" class=\"closeX close\">&times;</button>\n    </section>\n  `;\n};\n\nexport default renderCloseXButton;\n","!function(t,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=e(require(\"tslib\"),require(\"@floating-ui/dom\")):\"function\"==typeof define&&define.amd?define([\"tslib\",\"@floating-ui/dom\"],e):(t=\"undefined\"!=typeof globalThis?globalThis:t||self)[\"floating-ui-tooltip\"]=e(t.tslib,t.dom)}(this,(function(t,e){\"use strict\";function i(t,e,i){var o=e+\"EventListener\";[\"transitionend\",\"webkitTransitionEnd\",\"oTransitionEnd\"].forEach((function(e){t[o](e,i)}))}function o(t,e){t.setAttribute(\"data-transition-state\",e),console.log(\">> new transition state: \"+e)}function n(t,e){t.setAttribute(\"data-state\",e),Object.assign(t.style,{visibility:e})}function r(){return document.createElement(\"div\")}function s(t){return{box:t.querySelector(\".floating-ui-tooltip-box\"),content:t.querySelector(\".floating-ui-tooltip-content\"),arrow:t.querySelector(\".floating-ui-tooltip-arrow\")||void 0}}function a(t,e){var r=t._instance,s=t.getAttribute(\"data-transition-state\");if(console.log(\"``````````\"),console.log(\"\\n\"),console.log(e,s),\"visible\"===e){if(\"shown\"===s||\"showing\"===s)return void console.log(\"already \"+s);if(\"hidden\"===s)console.log(\"showing\"),o(t,\"showing\");else if(\"hiding\"===s)return void console.log(\"cancelling \"+s)}else{if(\"hidden\"===s||\"hiding\"===s)return void console.log(\"already \"+s);if(\"shown\"===s)o(t,\"hiding\"),r.props.onHide(r);else if(\"showing\"===s)return void console.log(\"cancelling \"+s)}var a=\"visible\"===e?\"shown\":\"hidden\";0!==r.transitionDuration?(!function(t,e){function o(n){if(n.target===t){i(t,\"remove\",o);try{e()}catch(e){console.error(e),t._instance.props.onHide()}}}i(t,\"remove\",o),i(t,\"add\",o)}(t,(function(){!function(t,e){t._instance.setState({isShown:\"visible\"===e})}(t,e),o(t,a),\"visible\"===e&&r.props.onShow(r)})),n(t,e)):(n(t,e),o(t,a),\"visible\"===e&&r.props.onShow(r))}var l={top:\"bottom\",right:\"left\",bottom:\"top\",left:\"right\"},d=function(i,o,n,r,d,p){return t.__awaiter(void 0,void 0,void 0,(function(){var c,u,h,f,g,b,v,w,m,x,y,_,E,S,O,k,C,T,H,D,L,A,z,j,P,R,U,q,M,N,I,W,V,F,X,B,G;return t.__generator(this,(function(J){switch(J.label){case 0:return h=void 0!==(u=(c={}).toFlip)&&u,g=void 0===(f=c.toShift)||f,b=i.placement,v=i.hideOnReferenceHidden,w=i.offset,m=i.hideOnTooltipEscape,x=i.arrowSizeScale,y=i.resetPlacementOnUpdate,_=i.arrow,E=i.showOnCreate,S=s(o),O=S.arrow,k=12*x,n?(C=\"auto\"===b&&(d||y),T=\"auto\"!==b&&h,H=g&&d,D={middleware:t.__spreadArray(t.__spreadArray(t.__spreadArray(t.__spreadArray(t.__spreadArray([e.offset({mainAxis:w[0],crossAxis:w[1]})],C?[e.autoPlacement()]:[],!0),H?[e.shift({padding:16})]:[],!0),T?[e.flip({fallbackPlacements:[\"right\",\"left\"],fallbackStrategy:\"initialPlacement\"})]:[],!0),_?[e.arrow({element:O,padding:2})]:[],!0),[e.size({apply:function(t){t.width,t.height,t.reference,t.floating}}),e.hide()],!1)},\"auto\"!==b&&(D.placement=b),[4,e.computePosition(n,o,D)]):[2];case 1:switch(L=J.sent(),A=L.x,z=L.y,j=L.placement,P=L.middlewareData,R=P.hide,U=R.referenceHidden,q=R.escaped,U&&d&&n.scrollIntoView({behavior:\"smooth\",block:\"center\",inline:\"center\"}),P.arrow&&(M=P.arrow.x,N=P.arrow.y),I=0!==P.arrow.centerOffset,\"visible\"===(W=v&&U||m&&q||r?\"hidden\":\"visible\")&&d&&!E&&(W=\"hidden\"),a(o,W),Object.assign(o.style,{left:A+\"px\",top:z+\"px\"}),V=l[j.split(\"-\")[0]],F=0,X=0,B=0,B=null!==M?M+k+\"px\":\"\",V){case\"top\":F=1/1.7,B=null!==M?M+k*F+\"px\":\"\";break;case\"bottom\":F=.5,B=null!==M?M+k*F+\"px\":\"\";break;case\"left\":F=.005,B=null!==M?M+\"px\":\"\",X=null!==N?N-k*F/2+\"px\":\"\";break;case\"right\":F=1.2,B=null!==M?M+\"px\":\"\",X=null!==N?N-k*F/2+\"px\":\"\"}return X=null!==N?N-k*F/2+\"px\":\"\",X=null!==N?N+\"px\":\"\",Object.assign(O.style,((G={visibility:I?\"hidden\":\"visible\",left:B,top:X,right:\"\",bottom:\"\"})[V]=\"-\"+k*F+\"px\",G)),p({fui:L}),[2,L]}}))}))},p={allowHTML:!0,content:\"\",arrow:!0,scrollIntoView:!1,transitionDuration:[300,250],offset:[10,0],hideOnClick:!0,onClickOutside:function(t,e){},onShow:function(t){},onHide:function(t){},onStateChange:function(t,e){},onRemove:function(){},placement:\"top\",resetPlacementOnUpdate:!1,hideOnTooltipEscape:!0,hideOnReferenceHidden:!0,showOnCreate:!0,maxWidth:350,updateDebounce:100,zIndex:99999,arrowSizeScale:1,updateOnEvents:\"resize scroll\"};var c=function(){function i(t,e){var i,o=this;this.state={isShown:!1,isRemoved:!1,fui:void 0},this.updateListenerCleanup=function(){},this.toHideTooltip=!1,this.transitionDuration=0,this.clickHandler=function(t){o.state.isShown&&(o.tooltipElement.contains(t.target)||o.reference.contains(t.target)||o.props.onClickOutside&&o.props.onClickOutside(o,t),\"target\"===o.props.hideOnClick?t.target===o.reference&&o.hide():o.props.hideOnClick&&o.hide())},this.props=t,this.reference=e,(i=document.createElement(\"style\")).type=\"text/css\",i.setAttribute(\"floating-ui-tooltip-default\",\"\"),i.textContent=\".floating-ui-tooltip-root{--color:#fff;--border-color:#fefefe;--border-color:red;backface-visibility:hidden;background:var(--color);border-radius:6px;box-shadow:0 0 0 1px rgba(6,44,82,.1),0 2px 16px rgba(33,43,54,.08);box-shadow:0 0 20px 4px rgba(154,161,177,.15),0 4px 80px -8px rgba(36,40,47,.25),0 4px 4px -2px rgba(91,94,105,.15);display:flex;font-size:90%;line-height:0px;margin:0;max-width:calc(100vw - 10px);padding:0;position:absolute;transition-duration:.2s;transition-property:transform,visibility,opacity;transition-timing-function:cubic-bezier(.54,1.5,.38,1.11);z-index:9999}.floating-ui-tooltip-arrow{box-shadow:0 0 0 1px rgba(6,44,82,.1),0 2px 16px rgba(33,43,54,.08);height:14px;position:absolute;transform:translateX(-50%) rotate(45deg);width:14px;z-index:-1}.floating-ui-tooltip-box{border-radius:inherit;line-height:normal;margin:0;outline:0;position:relative}.floating-ui-tooltip-root[data-state=hidden]{opacity:0}.floating-ui-tooltip-root[data-state=visible]{opacity:1}.floating-ui-tooltip-content{background-color:#fff;border-radius:inherit;color:#111;padding:0;position:relative;z-index:2}.floating-ui-tooltip-arrow,.floating-ui-tooltip-root{background:var(--color)}\",document.head.appendChild(i),this.toHideTooltip=!this.props.showOnCreate}return i.prototype.hookEventListeners=function(){var t,i,o,n=this;this.debouncedUpdate=(t=this.update.bind(this),0===(i=this.props.updateDebounce)?t:function(e){clearTimeout(o),o=setTimeout((function(){t(e)}),i)});var r=e.autoUpdate(this.reference,this.tooltipElement,(function(){return n.debouncedUpdate(void 0)})),s=function(){return n.debouncedUpdate(void 0)};this.props.updateOnEvents.split(\" \").forEach((function(t){window.addEventListener(t,s)})),window.addEventListener(\"click\",this.clickHandler.bind(this)),this.updateListenerCleanup=function(){r(),window.removeEventListener(\"click\",n.clickHandler.bind(n)),n.props.updateOnEvents.split(\" \").forEach((function(t){window.removeEventListener(t,s)}))}},i.prototype.updateTransitionDuration=function(t){this.transitionDuration=t,this.tooltipElement.style.transitionDuration=t+\"ms\"},i.prototype.create=function(){return t.__awaiter(this,void 0,void 0,(function(){var e,i,a,l,p;return t.__generator(this,(function(t){switch(t.label){case 0:return e=!this.props.showOnCreate,this.tooltipElement=(c=this,u=r(),h=r(),f=r(),g=r(),u.className=\"floating-ui-tooltip-root\",h.className=\"floating-ui-tooltip-box\",f.className=\"floating-ui-tooltip-content\",g.className=\"floating-ui-tooltip-arrow\",h.appendChild(f),h.appendChild(g),u.appendChild(h),Object.assign(f.style,{maxWidth:c.props.maxWidth+\"px\"}),f.innerHTML='\\n    <div id=\"tooltip-container\">\\n    <h3>Default tooltip</h3>\\n    </div>\\n  ',h.setAttribute(\"role\",\"tooltip\"),n(u,\"hidden\"),o(u,\"hidden\"),Object.assign(u.style,{visibility:\"hidden\",left:\"0px\",top:\"0px\"}),u._instance=c,u),this.updateTransitionDuration(this.props.transitionDuration[e?0:1]),i=s(this.tooltipElement).content,a=this.props,l=a.allowHTML,p=a.content,l?i.innerHTML=p:i.innerText=\"\"+p,document.body.appendChild(this.tooltipElement),[4,d(this.props,this.tooltipElement,this.reference,e,!0,this.setState.bind(this))];case 1:return t.sent(),this.hookEventListeners(),[2]}var c,u,h,f,g}))}))},i.prototype.getState=function(){return this.state},i.prototype.setState=function(e){void 0!==e.isShown&&e.isShown!==this.state.isShown&&this.updateTransitionDuration(this.props.transitionDuration[e.isShown?1:0]),this.props.onStateChange(this.state,e),this.state=t.__assign(t.__assign({},this.state),e)},i.prototype.update=function(e){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return e=e||this.toHideTooltip||!1,[4,d(this.props,this.tooltipElement,this.reference,e,!1,this.setState.bind(this))];case 1:return t.sent(),[2]}}))}))},i.prototype.hide=function(){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return this.toHideTooltip=!0,[4,this.update(!0)];case 1:return t.sent(),[2]}}))}))},i.prototype.show=function(){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return this.toHideTooltip=!1,[4,this.update(!1)];case 1:return t.sent(),[2]}}))}))},i.prototype.remove=function(){this.tooltipElement.remove(),this.state={isShown:!1,isRemoved:!0,fui:void 0},this.updateListenerCleanup(),console.log(\"removed all event listeners and observers\"),this.props.onRemove()},i}();return function(e,i){return t.__awaiter(this,void 0,void 0,(function(){var o,n,r,s,a;return t.__generator(this,(function(l){switch(l.label){case 0:return o=i.placement||p.placement,n=i.transitionDuration||p.transitionDuration,r=i.offset||p.offset,Object.keys(i).forEach((function(t){return void 0===i[t]&&delete i[t]})),s=t.__assign(t.__assign(t.__assign({},p),i),{placement:o,transitionDuration:n,offset:r}),[4,(a=new c(s,e)).create()];case 1:return l.sent(),[2,{props:a.props,reference:a.reference,tooltipElement:a.tooltipElement,getState:a.getState.bind(a),show:a.show.bind(a),hide:a.hide.bind(a),remove:a.remove.bind(a),update:a.update.bind(a)}]}}))}))}}));\n//# sourceMappingURL=index.js.map\n","/* import floatingTooltip from 'floating-ui-tooltip/dev/index';\nimport { Instance } from 'floating-ui-tooltip/dev/types'; */\nimport floatingTooltip from 'floating-ui-tooltip';\nimport { Instance, Props } from 'floating-ui-tooltip/dist/types';\n\nconst createTooltip = async (props): Promise<Instance> => {\n\n    let {\n        target,\n        remove,\n        content,\n        arrow,\n        offset,\n        placement,\n        onShow,\n        onHide,\n        showOnCreate,\n        onClickOutside,\n        hideOnReferenceHidden,\n        hideOnTooltipEscape,\n        scrollIntoView\n    } = props;\n\n    if (!remove) {\n        remove = () => {};\n    }\n\n    return floatingTooltip(target, {\n        allowHTML: true,\n        zIndex: 99999,\n        hideOnClick: false,\n        onClickOutside,\n        onShow,\n        onHide,\n        content,\n        hideOnReferenceHidden,\n        hideOnTooltipEscape,\n        arrow,\n        offset,\n        placement,\n        showOnCreate,\n        scrollIntoView\n    });\n};\n\nexport default createTooltip;\n","import { styleObjectToString } from \"../common/utils\";\nimport renderProgressBar from \"../common/progressBar\";\nimport renderCloseXButton from \"../common/closeXButton\";\nimport createTooltip from \"../common/createTooltip\";\nimport { DEFAULT_TOOLTIP_BORDER_RADIUS } from \"../common/constants\";\nimport { log } from \"../common/logger\";\n\nconst defaultBodyContent = `\n  <h3 style=\"font-weight: bold;\">Default title</h3>\n  <p style=\"font-weight: normal;\">Default tooltip content</p>\n`;\n\nconst renderNavButtons = (navSection: any): string => {\n    const { nextButton, prevButton, dismissLink } = navSection;\n\n    return `\n    <style>\n    .lusift .tooltip section.nav-buttons{\n      ${styleObjectToString(navSection.styleProps)}\n    }\n    .lusift .tooltip .nav-buttons .next{\n      ${styleObjectToString(nextButton.styleProps)}\n    }\n    .lusift .tooltip .nav-buttons .prev{\n      ${styleObjectToString(prevButton.styleProps)}\n    }\n    </style>\n\n    <section class=\"nav-buttons\">\n      ${\n          dismissLink.disabled\n              ? \"\"\n              : `\n        <button onclick=\"Lusift.close()\" class=\"close dismiss-link\">\n          skip this\n        </button>\n        `\n      }\n      ${\n          prevButton.disabled\n              ? \"\"\n              : `<button onclick=\"Lusift.prev()\" class=\"prev lusift-button\">Prev</button>`\n      }\n      ${\n          nextButton.disabled\n              ? \"\"\n              : `<button onclick=\"Lusift.next()\" class=\"next lusift-button\">Next</button>`\n      }\n    </section>\n  `;\n};\n\nconst renderTooltip = async ({ data, target, styleProps, actions, uid, index, onShow, onHide, scrollIntoView }) => {\n    const { closeButton, navSection } = actions;\n    const {\n        arrow,\n        // bodyContent = defaultBodyContent,\n        placement,\n        offset,\n    } = data;\n\n    const content = `\n    <style>\n      .tippy-box{\n        border-radius: ${DEFAULT_TOOLTIP_BORDER_RADIUS};\n        ${styleObjectToString(styleProps)}\n      }\n    </style>\n\n    <div class=\"lusift\">\n      ${renderProgressBar()}\n      <div class=\"tooltip\" id=\"tooltip-${uid}\">\n        ${renderCloseXButton(closeButton, \"tooltip\")}\n        <section class=\"body-content\">\n        </section>\n        ${renderNavButtons(navSection)}\n      </div>\n    <div>\n  `;\n\n    const tooltipInstance = await createTooltip({\n        target,\n        content,\n        arrow,\n        offset,\n        placement,\n        remove: () => {},\n        onShow,\n        onHide,\n        scrollIntoView\n    });\n\n    // tooltipInstance.show();\n\n    const Lusift = window[\"Lusift\"];\n\n    const bodyContent =\n        Lusift.content[Lusift.activeGuide.id].data.steps[index].data.bodyContent ||\n        defaultBodyContent;\n\n    Lusift.render(bodyContent, \".lusift > .tooltip > .body-content\", () => {\n        tooltipInstance.update();\n    });\n\n    return tooltipInstance;\n};\n\nexport default renderTooltip;\n","export default {\n    styleProps: {},\n    closeButton: {\n        styleProps: {},\n        disabled: false,\n    },\n    navSection: {\n        styleProps: {},\n        nextButton: {\n            text: \"next\",\n            styleProps: {},\n            disabled: false,\n        },\n        prevButton: {\n            text: \"prev\",\n            styleProps: {},\n            disabled: true,\n        },\n        dismissLink: {\n            text: \"skip this\",\n            styleProps: {},\n            disabled: true,\n        },\n    },\n};\n","import { document, window } from \"global\";\nimport {\n    styleObjectToString,\n    getStepUID,\n    getElementPosition,\n    roundNum,\n    addFocusTrap,\n    getScrollBarWidth,\n    getDocumentDimensions,\n} from \"../common/utils/\";\nimport { log, warn, error } from \"../common/logger\";\nimport { BackdropData } from \"../common/types\";\n\nconst areNumbersEqual = (num1: number, num2: number): boolean => {\n    let num1Precision = num1.toString().substring(num1.toString().indexOf(\".\")).length - 1;\n    if (num1.toString().indexOf(\".\") == -1) num1Precision = 0;\n\n    let num2Precision = num2.toString().substring(num2.toString().indexOf(\".\")).length - 1;\n    if (num2.toString().indexOf(\".\") == -1) num2Precision = 0;\n    let decimalPlaces = Math.min(num1Precision, num2Precision);\n    if (decimalPlaces > 2) {\n        decimalPlaces = 1; //most reliable precision\n    }\n    /* log(num1, num2)\n  log(num1Precision, num2Precision, decimalPlaces);\n\n  log(roundNum(num1, decimalPlaces), roundNum(num2, decimalPlaces)); */\n\n    return roundNum(num1, decimalPlaces) === roundNum(num2, decimalPlaces);\n};\n\nObject[\"fromEntries\"] = arr => Object.assign({}, ...arr.map(([k, v]) => ({ [k]: v })));\nconst getDefinedProps = obj =>\n    Object[\"fromEntries\"](Object.entries(obj).filter(([k, v]) => v !== undefined));\n\nclass Backdrop {\n    private targetSelector: string;\n    readonly stagedTargetClass: string;\n    readonly overlaySelectorClass: string = \"lusift-backdrop-overlay\";\n    private data: BackdropData = {\n        stageGap: 5,\n        opacity: \"0.5\",\n        color: \"#444\",\n    };\n    private toStopOverlay: boolean = false;\n    private focusTrap: any;\n\n    constructor({\n        targetSelector,\n        guideID,\n        index,\n        data,\n    }: {\n        targetSelector: string;\n        index: number;\n        guideID: string;\n        data: any;\n    }) {\n        const uid = getStepUID({ guideID, index, type: \"backdrop\" });\n        this.stagedTargetClass = `${uid}__target`;\n\n        this.data = Object.assign({}, this.data, getDefinedProps(data));\n        this.targetSelector = targetSelector;\n\n        this.createOverlay();\n\n        // trap focus inside tooltip\n        this.focusTrap = addFocusTrap({\n            target: [\".lusift > .tooltip\", this.targetSelector],\n            escToClose: false,\n            clickOutsideToClose: false,\n        });\n        // TODO: Deligate this to floating-ui-tooltip, with an onUpdate hook\n    }\n\n    public resetBackdrop(): void {\n        // HACK: intervene in the event backdrop has already been closed and there's a rogue timeout: rare\n        if (this.toStopOverlay) return error(`Lusift: This overlay instance should be removed`);\n        this.removeOverlay();\n        this.createOverlay();\n    }\n\n    // TODO: Should we really be destroying and recreating the overlay every time? or to just change visibility?\n    // -- we could remove from dom, but preserve them in variables, between hide() and show()'s\n\n    private createOverlay(): void {\n        /* document.documentElement.style.overflow = 'hidden';\n   document.body.scroll = \"no\"; */\n        const targetElement = document.querySelector(this.targetSelector);\n        const padding = this.data.stageGap;\n\n        const { documentHeight, documentWidth } = getDocumentDimensions();\n\n        const targetPosition = getElementPosition(targetElement);\n\n        const hTop = document.createElement(\"div\");\n        hTop.id = \"hTop\";\n        const hBottom = document.createElement(\"div\");\n        hBottom.id = \"hBottom\";\n\n        const vLeft = document.createElement(\"div\");\n        vLeft.id = \"vLeft\";\n        const vRight = document.createElement(\"div\");\n        vRight.id = \"vRight\";\n\n        const overlayStyle = {\n            opacity: \"0.5\",\n            background: \"#444\",\n            transition: \"visibility 0.3s ease-in-out\",\n            position: \"absolute\",\n            top: \"0\",\n            bottom: \"0\",\n            left: \"0\",\n            right: \"0\",\n            zIndex: 998,\n            border: \"1px solid transparent\",\n        };\n\n        hTop.style.cssText = styleObjectToString({\n            ...overlayStyle,\n            height: `${targetPosition.bottom - targetPosition.height - padding}px`,\n            width: `${targetPosition.right - targetPosition.left + 2 * padding}px`,\n            left: `${targetPosition.left - padding}px`,\n            bottom: `${targetPosition.top - padding}px`,\n        });\n\n        hBottom.style.cssText = styleObjectToString({\n            ...overlayStyle,\n            height: `${documentHeight - (targetPosition.top + targetPosition.height + padding)}px`,\n            width: `${targetPosition.right - targetPosition.left + 2 * padding}px`,\n            left: `${targetPosition.left - padding}px`,\n            top: `${targetPosition.bottom + padding}px`,\n        });\n\n        vLeft.style.cssText = styleObjectToString({\n            ...overlayStyle,\n            width: `${targetPosition.left - padding}px`,\n            height: `${documentHeight}px`,\n            right: `${targetPosition.left - padding}px`,\n        });\n\n        vRight.style.cssText = styleObjectToString({\n            ...overlayStyle,\n            width: `${documentWidth - (targetPosition.left + targetPosition.width) - padding}px`,\n            height: `${documentHeight}px`,\n            left: `${targetPosition.right + padding}px`,\n        });\n\n        [hTop, hBottom, vLeft, vRight].forEach(el => {\n            el.classList.add(this.overlaySelectorClass);\n            document.body.appendChild(el);\n        });\n        targetElement.classList.add(this.stagedTargetClass);\n\n        // See that the overlay isn't glitchy, reset if it is\n        const { height: hTopHeight, width: hTopWidth } = getElementPosition(hTop);\n        const { height: hBottomHeight } = getElementPosition(hBottom);\n        const vLeftWidth = getElementPosition(vLeft).width;\n        const vRightWidth = getElementPosition(vRight).width;\n\n        const overlaySumWidth = hTopWidth + vLeftWidth + vRightWidth;\n        const overlaySumHeight = hTopHeight + hBottomHeight + targetPosition.height + 2 * padding;\n\n        /* log(screenWidth, overlaySumWidth);\n           log(screenHeight, overlaySumHeight); */\n\n        if (\n            !areNumbersEqual(documentWidth, overlaySumWidth) ||\n            !areNumbersEqual(documentHeight, overlaySumHeight)\n        ) {\n            this.resetBackdrop();\n        }\n    }\n\n    private removeOverlay(): void {\n        document.querySelectorAll(`.${this.overlaySelectorClass}`).forEach((el: HTMLElement) => {\n            if (el) el.remove();\n        });\n\n        const targetElement = document.querySelector(this.targetSelector);\n        if (targetElement) targetElement.classList.remove(this.stagedTargetClass);\n    }\n\n    public remove(): void {\n        // log('removing Backdrop');\n        // remove event listeners\n        this.toStopOverlay = true;\n        if (this.focusTrap) {\n            this.focusTrap.deactivate();\n        }\n        this.removeOverlay();\n    }\n}\n\nexport default Backdrop;\n","import getElementPosition from './getElementPosition';\nimport { document, window } from 'global';\n\nexport default function getDocumentDimensions(): { documentWidth: number; documentHeight: number } {\n    const { height: clientHeight, width: clientWidth } = getElementPosition(\n        document.documentElement,\n    );\n\n    const documentWidth = Math.max(\n        clientWidth,\n        document.body[\"scrollWidth\"],\n        document.documentElement[\"scrollWidth\"],\n        document.body[\"offsetWidth\"],\n        document.documentElement[\"offsetWidth\"],\n    );\n    const documentHeight = Math.max(\n        clientHeight,\n        document.body.scrollHeight,\n        document.documentElement.scrollHeight,\n        document.body.offsetHeight,\n        document.documentElement.offsetHeight,\n    );\n\n    return {\n        documentWidth,\n        documentHeight,\n    };\n}\n","import { document, window } from \"global\";\nimport createTooltip from \"./createTooltip\";\nimport { mergeObjects, getStepUID, debounce } from \"../common/utils\";\nimport { log, warn, error } from \"../common/logger\";\nimport { TooltipData, HotspotAndTooltipTarget as Target, StepActions } from \"../common/types\";\nimport defaultToolipActions from \"./defaultTooltipActions\";\nimport Backdrop from \"../backdrop\";\nimport { autoUpdate } from '@floating-ui/dom';\n\nconst defaultBackdropData = {\n    disabled: false,\n    color: \"#444\",\n    opacity: \"0.5\",\n    stageGap: 5,\n    nextOnOverlayClick: false,\n};\n\nconst tooltipArrowDefaultSize = 12;\nconst tooltipArrowSizeScale = 1;\nconst defaultOffset = [tooltipArrowSizeScale*tooltipArrowDefaultSize, 0]; // x needs to be size of arrow + backdrop gap\n\n// TODO: should we have transition effects for backdrop? it's kind of jerky\n\nexport default class Tooltip {\n    private targetElement: HTMLElement;\n    readonly target: Target;\n    private fuitInstance: any;\n    readonly uid: string;\n    readonly data: Partial<TooltipData>;\n    private actions: StepActions = defaultToolipActions;\n    readonly styleProps: Object = {};\n    private targetsAndEventListeners: {\n        method: string;\n        target: HTMLElement;\n        eventType: string;\n    }[] = [];\n    private backdropInstance: any;\n    private index: number;\n    private guideID: string;\n    private isTooltipShown: boolean = false;\n    private backdropAutoUpdateCleanup!: Function;\n\n    constructor({\n        target,\n        guideID,\n        index,\n        data,\n        actions,\n        styleProps,\n    }: {\n        target: Target;\n        guideID: string;\n        data: Partial<TooltipData>;\n        index: number;\n        actions: StepActions;\n        styleProps: Object;\n    }) {\n        log(\"%c Tooltip constructor! \", \"background: #222; color: #bada55\");\n\n        this.target = target;\n        const { elementSelector } = target;\n        this.styleProps = styleProps || {};\n        this.data = data;\n        this.index = index;\n\n\n        const progressOn = data.progressOn || {};\n        this.data.progressOn = {\n            eventType: \"click\",\n            elementSelector,\n            ...progressOn,\n        };\n\n        const backdrop = data.backdrop || {};\n        this.data.backdrop = {\n            ...defaultBackdropData,\n            ...backdrop,\n        };\n        this.data.offset = this.data.offset || defaultOffset;\n        if (!this.data.backdrop.disabled) {\n            // factor in backdrop stage gap in tooltip offset\n            this.data.offset[0] = this.data.offset[0] + this.data.backdrop.stageGap!;\n        }\n\n        this.consolidateActions(actions);\n        this.uid = getStepUID({ guideID, index, type: \"tooltip\" });\n        this.guideID = guideID;\n        this.targetElement = document.querySelector(elementSelector);\n        this.show();\n        log(\"tooltip started\");\n    }\n\n    private hide(): void {\n        // log('tooltip hide');\n        this.fuitInstance.hide();\n        this.removeAllEventListeners();\n        this.backdropInstance && this.backdropInstance.remove();\n        this.backdropInstance = null;\n        this.isTooltipShown = false;\n    }\n\n    private consolidateActions(actions: StepActions) {\n        // merge default actions with incoming actions provided by the developer(user)\n        this.actions = mergeObjects(this.actions, actions);\n    }\n\n    private addBackdrop(): void {\n        const { stageGap, opacity, color } = this.data.backdrop!;\n        const data = {\n            stageGap,\n            opacity,\n            color,\n        };\n        this.backdropInstance = new Backdrop({\n            targetSelector: this.target.elementSelector,\n            guideID: this.guideID,\n            index: this.index,\n            data,\n        });\n        if (this.data.backdrop!.nextOnOverlayClick) {\n            Array.from<HTMLElement>(\n                document.getElementsByClassName(this.backdropInstance.overlaySelectorClass),\n            ).forEach((target: HTMLElement) => {\n                this.addEventListenerToTarget(target, \"next\");\n            });\n        }\n    }\n\n    public async show() {\n        if (!this.targetElement) return error(\"Error: target element not found\");\n        if (this.isTooltipShown) return error(\"Tooltip is already displayed\");\n\n        const { progressOn, backdrop } = this.data;\n\n        const { eventType, disabled } = progressOn!;\n        disabled || this.addEventListenerToTarget(this.targetElement, \"next\", eventType);\n\n        if (!this.fuitInstance) {\n            // fuit was never initiated\n            const { uid, actions, styleProps, data, index } = this;\n            this.fuitInstance = await createTooltip({\n                uid,\n                target: this.targetElement,\n                actions,\n                styleProps,\n                data,\n                scrollIntoView: true,\n                index,\n                onShow: (instance) => {\n                    if(instance.state.isShown) {\n                        backdrop!.disabled || this.addBackdrop.bind(this)();\n                        this.isTooltipShown = true;\n                    } else {\n                        console.log('onShow: WOWWWW')\n                    }\n                },\n                onHide: (instance) => {\n                    if(!backdrop!.disabled) {\n                        this.backdropInstance && this.backdropInstance.remove();\n                        this.backdropInstance = null;\n                        this.isTooltipShown = false;\n                    }\n                },\n            });\n            if (!backdrop!.disabled) {\n\n                const debouncedBackdropReset = debounce((_x?) => {\n                    if (this.backdropInstance) {\n                        this.backdropInstance.resetBackdrop();\n                    }\n                }, 100);\n\n                this.backdropAutoUpdateCleanup = autoUpdate(\n                    this.targetElement,\n                    this.fuitInstance.tooltipElement,\n                    () => {\n                        debouncedBackdropReset(undefined);\n                    },\n                    {\n                        ancestorScroll: false,\n                        ancestorResize: true,\n                        elementResize: true\n                    });\n            }\n        } else {\n            // fuit was hidden\n            this.fuitInstance.show();\n        }\n    }\n\n    public remove(): void {\n        if (!this.isTooltipShown) return error(`Attempted to remove but tooltip is not shown`);\n        log(`removing tooltip ${this.uid}`);\n        this.removeAllEventListeners();\n        this.backdropInstance && this.backdropInstance.remove();\n        this.fuitInstance.remove();\n        this.fuitInstance = null;\n        this.isTooltipShown = false;\n    }\n\n    private getListenerFromMethod(method: string): EventListenerOrEventListenerObject {\n        switch (method) {\n            case \"next\":\n                return window.Lusift.next;\n            case \"prev\":\n                return window.Lusift.prev;\n            case \"close\":\n                return this.remove;\n            default:\n                return () => {};\n        }\n    }\n\n    private addEventListenerToTarget(\n        target: HTMLElement,\n        method = \"next\",\n        eventType = \"click\",\n    ): void {\n        // add this event listener at the creation of each tooltip step and\n        // remove it at removal of it\n        target.addEventListener(eventType, this.getListenerFromMethod(method));\n        this.targetsAndEventListeners.push({\n            method,\n            target,\n            eventType,\n        });\n    }\n\n    private removeAllEventListeners(): void {\n        this.backdropAutoUpdateCleanup && this.backdropAutoUpdateCleanup();\n        this.targetsAndEventListeners.forEach(({ method, target, eventType }) => {\n            target.removeEventListener(eventType, this.getListenerFromMethod(method));\n            log(`remove event listener of type ${eventType} ` + `and method ${method}`);\n        });\n        this.targetsAndEventListeners = [];\n    }\n}\n","import createModal from \"./createModal\";\nimport { document, window } from \"global\";\nimport { getStepUID, addFocusTrap } from \"../common/utils\";\nimport { ModalData } from \"../common/types\";\nimport { MODAL_OVERLAY_CLASS } from \"../common/constants\";\n\nclass Modal {\n    private uid: string;\n    private data: ModalData = {};\n    private closeButton: any;\n    private focusTrap: any;\n    private index: number;\n\n    constructor({ index, guideID, data, closeButton }) {\n        this.uid = getStepUID({ guideID, type: \"modal\", index });\n        this.data = data || {};\n        this.index = index;\n        this.closeButton = closeButton;\n        this.addModal();\n\n        const { escToClose, clickOutsideToClose } = this.data;\n\n        this.focusTrap = addFocusTrap({\n            target: \".modal\",\n            escToClose,\n            clickOutsideToClose,\n        });\n\n        if (escToClose) {\n            window.addEventListener(\"keydown\", this.escEventListener, true);\n        }\n        if (clickOutsideToClose) {\n            const overlayElement = document.querySelector(`.${MODAL_OVERLAY_CLASS}`);\n            overlayElement.addEventListener(\"click\", this.overlayClickEventListener, true);\n        }\n    }\n\n    private escEventListener(e): void {\n        if (\n            (e.key == \"Escape\" || e.key == \"Esc\" || e.keyCode == 27) &&\n            e.target.nodeName == \"BODY\"\n        ) {\n            window.Lusift.close();\n        }\n    }\n    private overlayClickEventListener(e): void {\n        if (!e.target.classList.contains(\"modal\")) {\n            window.Lusift.close();\n        }\n    }\n\n    private addModal(): void {\n        const { bodyContent } = this.data;\n\n        createModal({\n            uid: this.uid,\n            index: this.index,\n            closeButton: this.closeButton,\n        });\n    }\n\n    private remove(): void {\n        const overlayElement = document.querySelector(`.${MODAL_OVERLAY_CLASS}`);\n        document.getElementById(this.uid).remove();\n        this.focusTrap.deactivate();\n\n        // remove event listeners\n        if (this.data.escToClose) {\n            window.removeEventListener(\"keydown\", this.escEventListener, true);\n        }\n        if (this.data.clickOutsideToClose) {\n            overlayElement.removeEventListener(\"click\", this.overlayClickEventListener, true);\n        }\n        overlayElement.remove();\n    }\n}\n\nexport default Modal;\n","import { document } from \"global\";\nimport { styleObjectToString } from \"../common/utils\";\nimport { MODAL_OVERLAY_CLASS, DEFAULT_MODAL_BORDER_RADIUS } from \"../common/constants\";\nimport renderProgressBar from \"../common/progressBar\";\nimport renderCloseXButton from \"../common/closeXButton\";\n\nconst createModal = ({ uid, index, closeButton = {} }): void => {\n    const modalOverlay = document.createElement(\"div\");\n    const modal = document.createElement(\"div\");\n    modal.id = uid;\n    modalOverlay.classList.add(MODAL_OVERLAY_CLASS);\n\n    const modalStyleProps = {};\n    const modalOverlayStyleProps = {};\n    const defaultBodyContent = `\n    <style>\n    .modal .body-content {\n      max-height: 500px;\n      width: 600px;\n      display: flex;\n      flex-direction: column;\n    }\n    h2{\n      font-weight: bold;\n      font-size: 1.5rem;\n    }\n    .button-area{\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      margin: 2rem 0;\n    }\n    </style>\n    <h2>Default Modal Content</h2>\n    <div class=\"button-area\">\n      <button class=\"button\" onclick=\"Lusift.next()\">\n        Next\n      </button>\n    </div>`;\n\n    modalOverlay.style.cssText = styleObjectToString({\n        position: \"absolute\",\n        background: \"#444\",\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        opacity: \"0.5\",\n        top: \"0\",\n        left: \"0\",\n        bottom: \"0\",\n        right: \"0\",\n        zIndex: \"99998\",\n        ...modalOverlayStyleProps,\n    });\n\n    modal.style.cssText = styleObjectToString({\n        borderRadius: DEFAULT_MODAL_BORDER_RADIUS,\n        ...modalStyleProps,\n    });\n    modal.classList.add(\"modal\");\n\n    modal.innerHTML = `\n    ${renderProgressBar()}\n    ${renderCloseXButton(closeButton, \"modal\")}\n    <section class=\"body-content\">\n    </section>\n  `;\n    const lusiftWrapper = document.createElement(\"div\");\n    lusiftWrapper.classList.add(\"lusift\");\n    lusiftWrapper.appendChild(modal);\n\n    document.body.appendChild(modalOverlay);\n    document.body.appendChild(lusiftWrapper);\n\n    const Lusift = window[\"Lusift\"];\n\n    const bodyContent =\n        Lusift.content[Lusift.activeGuide.id].data.steps[index].data.bodyContent ||\n        defaultBodyContent;\n\n    Lusift.render(bodyContent, \".lusift > .modal > .body-content\");\n};\n\nexport default createModal;\n","import styleObjectToString from \"../common/utils/styleObjectToString\";\nimport createTooltip from \"../common/createTooltip\";\nimport renderProgressBar from \"../common/progressBar\";\nimport { DEFAULT_TOOLTIP_BORDER_RADIUS } from \"../common/constants\";\n\nconst defaultBodyContent = `\n  <h3 style=\"font-weight: bold;\">Default title</h3>\n  <p style=\"font-weight: normal;\">Default tooltip content</p>\n`;\n\nconst renderTooltip = async ({ remove, data, target, styleProps, uid, index, onClickOutside, showOnCreate }) => {\n    const {\n        arrow,\n        placement,\n        offset,\n        // bodyContent = defaultBodyContent,\n    } = data;\n\n    const content = `\n    <style>\n      .tippy-box{\n        z-index: 999999;\n        border-radius: ${DEFAULT_TOOLTIP_BORDER_RADIUS};\n        ${styleObjectToString(styleProps)}\n      }\n    </style>\n\n    ${renderProgressBar()}\n    <div class=\"lusift\">\n      <div class=\"hotspot-tooltip\" id=\"tooltip-${uid}\">\n        <section class=\"body-content\">\n        </section>\n      </div>\n    </div>\n  `;\n\n    const tooltipInstance = await createTooltip({\n        target,\n        content,\n        arrow,\n        offset,\n        placement,\n        onClickOutside,\n        hideOnReferenceHidden: false,\n        hideOnTooltipEscape: false,\n        showOnCreate,\n        remove: () => {},\n    });\n\n    const Lusift = window[\"Lusift\"];\n\n    const bodyContent =\n        Lusift.content[Lusift.activeGuide.id].data.steps[index].tip.data.bodyContent ||\n        defaultBodyContent;\n\n    Lusift.render(bodyContent, \".lusift > .hotspot-tooltip > .body-content\", () => {\n        tooltipInstance.update();\n    });\n\n    return tooltipInstance;\n};\n\nexport default renderTooltip;\n","import { document, window } from \"global\";\nimport { styleObjectToString, getElementPosition } from \"../common/utils\";\nimport { BEACON_CONTAINER_CLASS } from \"../common/constants\";\n\nconst appendTo = () => document.body;\n\nexport function div(): HTMLDivElement {\n  return document.createElement('div');\n}\n\nexport const positionBeacon = (\n  beaconElement: HTMLDivElement,\n  targetPosition,\n  beaconPlacement: { top: number; left: number; }\n) => {\n    const { targetTop, targetLeft, targetHeight, targetWidth } = targetPosition;\n\n    const { top, left } = beaconPlacement;\n\n    const beaconID = beaconElement.getAttribute('id');\n    const beaconContainer = beaconElement.parentElement!;\n    const beaconEventReceiver = <HTMLElement>beaconElement.querySelector(`#${beaconID}-er`)!;\n\n    Object.assign(beaconContainer.style, {\n      top: `${targetTop}px`,\n      left: `${targetLeft}px`,\n    });\n\n    const { width, height } = getElementPosition(<HTMLElement>beaconElement);\n\n    Object.assign(beaconEventReceiver.style, {\n        width: `${width}px`,\n        height: `${height}px`,\n    });\n\n    Object.assign(beaconElement.style, {\n        top: `${(top / 100) * targetHeight}px`,\n        left: `${(left / 100) * targetWidth}px`\n    });\n}\n\nexport const createBeaconElement = ({ beaconData, beaconID, toggleTooltip }) => {\n\n    const beaconContainer = div();\n    beaconContainer.classList.add(BEACON_CONTAINER_CLASS);\n    Object.assign(beaconContainer.style, {\n        position: \"absolute\",\n    });\n\n    let { size, color, type } = beaconData;\n    const animation = true;\n\n    beaconContainer.innerHTML = `\n    <style>\n      #${beaconID} {\n        background-color: ${color || \"#b9f\"};\n        border-radius: 50%;\n        position: absolute;\n        pointer-events: auto;\n        width: ${size * 13}px;\n        height: ${size * 13}px;\n\n        ${\n            animation\n                ? `\n        -webkit-animation: shine 2s ease-in-out infinite;\n        animation: shine 2s ease-in-out infinite;\n          `\n                : \"\"\n        }\n        cursor: pointer;\n        -webkit-animation-delay: 1s;\n        animation-delay: 1s;\n      }\n\n\n      @-webkit-keyframes shine {\n        0%, 20% {\n          box-shadow: 0px 0px 0px 0px rgba(187, 153, 255, 0.49);\n        }\n        100% {\n          box-shadow: 0px 0px 0px ${20 * size}px rgba(0, 0, 0, 0);\n        }\n      }\n\n      @keyframes shine {\n        0%, 20% {\n          box-shadow: 0px 0px 0px 0px rgba(187, 153, 255, 0.49);\n        }\n        100% {\n          box-shadow: 0px 0px 0px ${20 * size}px rgba(0, 0, 0, 0);\n        }\n      }\n    }\n    </style>\n    <div class=\"lusift-beacon\" id=\"${beaconID}\"></div>\n  `;\n\n\n    appendTo().appendChild(beaconContainer);\n    const beaconElement = <HTMLElement>beaconContainer.querySelector(`#${beaconID}`)!;\n\n    const beaconEventReceiver = div();\n    beaconEventReceiver.id = `${beaconID}-er`;\n\n    Object.assign(beaconEventReceiver.style, {\n        ...beaconElement!.style,\n        background: \"transparent\",\n        zIndex: \"394490\",\n    });\n\n    beaconElement.appendChild(beaconEventReceiver);\n\n    beaconEventReceiver.addEventListener(\"click\", toggleTooltip);\n    return beaconEventReceiver;\n}\n","import { document, window } from \"global\";\nimport createHotspotTooltip from \"./createHotspotTooltip\";\nimport { createBeaconElement, positionBeacon } from \"./beacon-element\";\nimport { autoUpdate } from '@floating-ui/dom';\nimport {\n    getElementPosition,\n    getStepUID,\n    changeAsyncStepStatus,\n    debounce\n} from \"../common/utils\";\nimport { Hotspot as HotspotData } from \"../common/types\";\nimport { log, warn, error } from \"../common/logger\";\n\n// TODO_: In case of customizing hotspot's beacon, we can just have a beaconElement property\n// TODO: Should the beacon animation stop when tip is open?\n\nclass Hotspot {\n    private tipID: string;\n    private fuitInstance: any;\n    private targetElement: HTMLElement;\n    readonly data: HotspotData;\n    private beaconID: string;\n    private beaconAutoUpdateCleanup!: Function;\n\n    constructor({ data, guideID }) {\n        log(data);\n        this.data = data;\n        const { index, type, target } = data;\n        this.tipID = getStepUID({ guideID, type, index });\n        this.beaconID = getStepUID({\n            guideID,\n            type: \"beacon\",\n            index,\n        });\n        this.targetElement = document.querySelector(target.elementSelector);\n        this.addBeacon();\n        this.createTip();\n    }\n\n    private updateBeaconPosition() : void {\n        let {\n            top: targetTop,\n            left: targetLeft,\n            width: targetWidth,\n            height: targetHeight,\n        } = getElementPosition(this.targetElement);\n        const targetPosition = {\n            targetTop,\n            targetLeft,\n            targetWidth,\n            targetHeight,\n        };\n        const beaconData = this.data.beacon;\n\n        const beaconElement = document.getElementById(this.beaconID);\n        positionBeacon(beaconElement, targetPosition, beaconData.placement);\n    }\n\n    private addBeacon(): void {\n        log(\"adding beacon\");\n\n        const beaconData = this.data.beacon;\n\n        createBeaconElement({\n            beaconData,\n            beaconID: this.beaconID,\n            toggleTooltip: this.toggleTooltip.bind(this),\n        });\n        this.updateBeaconPosition();\n    }\n\n    private async createTip() {\n        const Lusift = window[\"Lusift\"];\n        const target = document.getElementById(`${this.beaconID}`);\n        const { data, styleProps } = this.data.tip;\n        const isDevMode = !Boolean(Lusift.activeGuide);\n\n        // do not allow async step to close in dev mode\n        const removeMethod = isDevMode ? Lusift.close : this.removeAndCloseAsync.bind(this);\n\n        this.fuitInstance = await createHotspotTooltip({\n            remove: removeMethod,\n            uid: this.tipID,\n            index: this.data.index,\n            target: target,\n            styleProps,\n            showOnCreate: false,\n            data,\n            onClickOutside: (instance, event) => {\n                removeMethod();\n            }\n        });\n\n        // reposition beacon on body and targetElement resize\n\n        const updateBeaconPosition = this.updateBeaconPosition.bind(this);\n\n        const debouncedUpdateBeaconPosition = debounce((_x?) => {\n            updateBeaconPosition();\n        }, 100);\n\n        this.beaconAutoUpdateCleanup = autoUpdate(\n            this.targetElement,\n            this.fuitInstance.tooltipElement,\n            () => {\n                debouncedUpdateBeaconPosition(undefined);\n            },\n            {\n                ancestorScroll: false,\n                ancestorResize: true,\n                elementResize: true\n            });\n    }\n\n    private async toggleTooltip() {\n        // log('toggle tooltip');\n\n        const activeHotspot = window.Lusift.activeHotspot;\n        const Lusift = window[\"Lusift\"];\n\n        if (activeHotspot && this.data.index !== activeHotspot.data.index) {\n            // hide any other potentially active hotspot tip\n            Lusift.activeHotspot.hideTooltip();\n        }\n\n        if (this.fuitInstance.getState().isRemoved) {\n            error(\"Uh... but it doesn't exist. unexpected\");\n            // if it's removed\n        } else if (this.fuitInstance.getState().isShown) {\n            await this.hideTooltip();\n        } else if (this.fuitInstance) {\n            // if it's hidden\n            await this.fuitInstance.show();\n            Lusift.activeHotspot = this;\n        }\n    }\n\n    // TODO: refactor names, here it could be hideTip()\n    public async hideTooltip() {\n        await this.fuitInstance.hide();\n        window.Lusift.activeHotspot = null;\n    }\n\n    private changeAsyncStepStatus(toOpen: boolean): void {\n        if (!this.data.async) return;\n        changeAsyncStepStatus(this.data.index, toOpen);\n    }\n\n    private async remove() {\n        log(`Removing id: ${this.data.index} hotspot`);\n\n        if (this.fuitInstance) {\n            if (this.fuitInstance.getState().isShown) {\n                await this.hideTooltip();\n            }\n            if (this.fuitInstance.getState().isRemoved) {\n                log(\"Hotspot's tooltip is already destroyed\");\n            } else {\n                this.fuitInstance.remove();\n            }\n        } else {\n            log(\"Hotspot closed without ever opening\");\n        }\n        const beaconElement = document.getElementById(this.beaconID);\n        if (beaconElement) {\n            beaconElement.parentElement.remove();\n        }\n    }\n\n    private removeResizeObservers(): void {\n        this.beaconAutoUpdateCleanup();\n    }\n\n    private removeAndCloseAsync(): void {\n        this.remove();\n        this.changeAsyncStepStatus(false);\n        this.removeResizeObservers();\n    }\n}\n\nexport default Hotspot;\n","import Tooltip from \"../../tooltip\";\nimport Modal from \"../../modal\";\nimport Hotspot from \"../../hotspot\";\n\nconst startStepInstance = (stepData: any, guideID: string): void => {\n    const { index, target, type, data, closeButton } = stepData;\n    let activeStepInstance: any;\n\n    if (type === \"tooltip\") {\n        const { actions, styleProps } = stepData;\n\n        activeStepInstance = new Tooltip({\n            target,\n            data,\n            index,\n            guideID,\n            actions,\n            styleProps,\n        });\n    } else if (type === \"modal\") {\n        activeStepInstance = new Modal({\n            index,\n            guideID,\n            data,\n            closeButton,\n        });\n    } else if (type === \"hotspot\") {\n        activeStepInstance = new Hotspot({\n            data: stepData,\n            guideID,\n        });\n    }\n    return activeStepInstance;\n};\n\nexport default startStepInstance;\n","/*!\n* tabbable 5.2.1\n* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE\n*/\nvar candidateSelectors = ['input', 'select', 'textarea', 'a[href]', 'button', '[tabindex]', 'audio[controls]', 'video[controls]', '[contenteditable]:not([contenteditable=\"false\"])', 'details>summary:first-of-type', 'details'];\nvar candidateSelector = /* #__PURE__ */candidateSelectors.join(',');\nvar matches = typeof Element === 'undefined' ? function () {} : Element.prototype.matches || Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;\n\nvar getCandidates = function getCandidates(el, includeContainer, filter) {\n  var candidates = Array.prototype.slice.apply(el.querySelectorAll(candidateSelector));\n\n  if (includeContainer && matches.call(el, candidateSelector)) {\n    candidates.unshift(el);\n  }\n\n  candidates = candidates.filter(filter);\n  return candidates;\n};\n\nvar isContentEditable = function isContentEditable(node) {\n  return node.contentEditable === 'true';\n};\n\nvar getTabindex = function getTabindex(node) {\n  var tabindexAttr = parseInt(node.getAttribute('tabindex'), 10);\n\n  if (!isNaN(tabindexAttr)) {\n    return tabindexAttr;\n  } // Browsers do not return `tabIndex` correctly for contentEditable nodes;\n  // so if they don't have a tabindex attribute specifically set, assume it's 0.\n\n\n  if (isContentEditable(node)) {\n    return 0;\n  } // in Chrome, <details/>, <audio controls/> and <video controls/> elements get a default\n  //  `tabIndex` of -1 when the 'tabindex' attribute isn't specified in the DOM,\n  //  yet they are still part of the regular tab order; in FF, they get a default\n  //  `tabIndex` of 0; since Chrome still puts those elements in the regular tab\n  //  order, consider their tab index to be 0.\n\n\n  if ((node.nodeName === 'AUDIO' || node.nodeName === 'VIDEO' || node.nodeName === 'DETAILS') && node.getAttribute('tabindex') === null) {\n    return 0;\n  }\n\n  return node.tabIndex;\n};\n\nvar sortOrderedTabbables = function sortOrderedTabbables(a, b) {\n  return a.tabIndex === b.tabIndex ? a.documentOrder - b.documentOrder : a.tabIndex - b.tabIndex;\n};\n\nvar isInput = function isInput(node) {\n  return node.tagName === 'INPUT';\n};\n\nvar isHiddenInput = function isHiddenInput(node) {\n  return isInput(node) && node.type === 'hidden';\n};\n\nvar isDetailsWithSummary = function isDetailsWithSummary(node) {\n  var r = node.tagName === 'DETAILS' && Array.prototype.slice.apply(node.children).some(function (child) {\n    return child.tagName === 'SUMMARY';\n  });\n  return r;\n};\n\nvar getCheckedRadio = function getCheckedRadio(nodes, form) {\n  for (var i = 0; i < nodes.length; i++) {\n    if (nodes[i].checked && nodes[i].form === form) {\n      return nodes[i];\n    }\n  }\n};\n\nvar isTabbableRadio = function isTabbableRadio(node) {\n  if (!node.name) {\n    return true;\n  }\n\n  var radioScope = node.form || node.ownerDocument;\n\n  var queryRadios = function queryRadios(name) {\n    return radioScope.querySelectorAll('input[type=\"radio\"][name=\"' + name + '\"]');\n  };\n\n  var radioSet;\n\n  if (typeof window !== 'undefined' && typeof window.CSS !== 'undefined' && typeof window.CSS.escape === 'function') {\n    radioSet = queryRadios(window.CSS.escape(node.name));\n  } else {\n    try {\n      radioSet = queryRadios(node.name);\n    } catch (err) {\n      // eslint-disable-next-line no-console\n      console.error('Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s', err.message);\n      return false;\n    }\n  }\n\n  var checked = getCheckedRadio(radioSet, node.form);\n  return !checked || checked === node;\n};\n\nvar isRadio = function isRadio(node) {\n  return isInput(node) && node.type === 'radio';\n};\n\nvar isNonTabbableRadio = function isNonTabbableRadio(node) {\n  return isRadio(node) && !isTabbableRadio(node);\n};\n\nvar isHidden = function isHidden(node, displayCheck) {\n  if (getComputedStyle(node).visibility === 'hidden') {\n    return true;\n  }\n\n  var isDirectSummary = matches.call(node, 'details>summary:first-of-type');\n  var nodeUnderDetails = isDirectSummary ? node.parentElement : node;\n\n  if (matches.call(nodeUnderDetails, 'details:not([open]) *')) {\n    return true;\n  }\n\n  if (!displayCheck || displayCheck === 'full') {\n    while (node) {\n      if (getComputedStyle(node).display === 'none') {\n        return true;\n      }\n\n      node = node.parentElement;\n    }\n  } else if (displayCheck === 'non-zero-area') {\n    var _node$getBoundingClie = node.getBoundingClientRect(),\n        width = _node$getBoundingClie.width,\n        height = _node$getBoundingClie.height;\n\n    return width === 0 && height === 0;\n  }\n\n  return false;\n}; // form fields (nested) inside a disabled fieldset are not focusable/tabbable\n//  unless they are in the _first_ <legend> element of the top-most disabled\n//  fieldset\n\n\nvar isDisabledFromFieldset = function isDisabledFromFieldset(node) {\n  if (isInput(node) || node.tagName === 'SELECT' || node.tagName === 'TEXTAREA' || node.tagName === 'BUTTON') {\n    var parentNode = node.parentElement;\n\n    while (parentNode) {\n      if (parentNode.tagName === 'FIELDSET' && parentNode.disabled) {\n        // look for the first <legend> as an immediate child of the disabled\n        //  <fieldset>: if the node is in that legend, it'll be enabled even\n        //  though the fieldset is disabled; otherwise, the node is in a\n        //  secondary/subsequent legend, or somewhere else within the fieldset\n        //  (however deep nested) and it'll be disabled\n        for (var i = 0; i < parentNode.children.length; i++) {\n          var child = parentNode.children.item(i);\n\n          if (child.tagName === 'LEGEND') {\n            if (child.contains(node)) {\n              return false;\n            } // the node isn't in the first legend (in doc order), so no matter\n            //  where it is now, it'll be disabled\n\n\n            return true;\n          }\n        } // the node isn't in a legend, so no matter where it is now, it'll be disabled\n\n\n        return true;\n      }\n\n      parentNode = parentNode.parentElement;\n    }\n  } // else, node's tabbable/focusable state should not be affected by a fieldset's\n  //  enabled/disabled state\n\n\n  return false;\n};\n\nvar isNodeMatchingSelectorFocusable = function isNodeMatchingSelectorFocusable(options, node) {\n  if (node.disabled || isHiddenInput(node) || isHidden(node, options.displayCheck) || // For a details element with a summary, the summary element gets the focus\n  isDetailsWithSummary(node) || isDisabledFromFieldset(node)) {\n    return false;\n  }\n\n  return true;\n};\n\nvar isNodeMatchingSelectorTabbable = function isNodeMatchingSelectorTabbable(options, node) {\n  if (!isNodeMatchingSelectorFocusable(options, node) || isNonTabbableRadio(node) || getTabindex(node) < 0) {\n    return false;\n  }\n\n  return true;\n};\n\nvar tabbable = function tabbable(el, options) {\n  options = options || {};\n  var regularTabbables = [];\n  var orderedTabbables = [];\n  var candidates = getCandidates(el, options.includeContainer, isNodeMatchingSelectorTabbable.bind(null, options));\n  candidates.forEach(function (candidate, i) {\n    var candidateTabindex = getTabindex(candidate);\n\n    if (candidateTabindex === 0) {\n      regularTabbables.push(candidate);\n    } else {\n      orderedTabbables.push({\n        documentOrder: i,\n        tabIndex: candidateTabindex,\n        node: candidate\n      });\n    }\n  });\n  var tabbableNodes = orderedTabbables.sort(sortOrderedTabbables).map(function (a) {\n    return a.node;\n  }).concat(regularTabbables);\n  return tabbableNodes;\n};\n\nvar focusable = function focusable(el, options) {\n  options = options || {};\n  var candidates = getCandidates(el, options.includeContainer, isNodeMatchingSelectorFocusable.bind(null, options));\n  return candidates;\n};\n\nvar isTabbable = function isTabbable(node, options) {\n  options = options || {};\n\n  if (!node) {\n    throw new Error('No node provided');\n  }\n\n  if (matches.call(node, candidateSelector) === false) {\n    return false;\n  }\n\n  return isNodeMatchingSelectorTabbable(options, node);\n};\n\nvar focusableCandidateSelector = /* #__PURE__ */candidateSelectors.concat('iframe').join(',');\n\nvar isFocusable = function isFocusable(node, options) {\n  options = options || {};\n\n  if (!node) {\n    throw new Error('No node provided');\n  }\n\n  if (matches.call(node, focusableCandidateSelector) === false) {\n    return false;\n  }\n\n  return isNodeMatchingSelectorFocusable(options, node);\n};\n\nexport { focusable, isFocusable, isTabbable, tabbable };\n//# sourceMappingURL=index.esm.js.map\n","/*!\n* focus-trap 6.7.1\n* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE\n*/\nimport { tabbable, isFocusable } from 'tabbable';\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar activeFocusTraps = function () {\n  var trapQueue = [];\n  return {\n    activateTrap: function activateTrap(trap) {\n      if (trapQueue.length > 0) {\n        var activeTrap = trapQueue[trapQueue.length - 1];\n\n        if (activeTrap !== trap) {\n          activeTrap.pause();\n        }\n      }\n\n      var trapIndex = trapQueue.indexOf(trap);\n\n      if (trapIndex === -1) {\n        trapQueue.push(trap);\n      } else {\n        // move this existing trap to the front of the queue\n        trapQueue.splice(trapIndex, 1);\n        trapQueue.push(trap);\n      }\n    },\n    deactivateTrap: function deactivateTrap(trap) {\n      var trapIndex = trapQueue.indexOf(trap);\n\n      if (trapIndex !== -1) {\n        trapQueue.splice(trapIndex, 1);\n      }\n\n      if (trapQueue.length > 0) {\n        trapQueue[trapQueue.length - 1].unpause();\n      }\n    }\n  };\n}();\n\nvar isSelectableInput = function isSelectableInput(node) {\n  return node.tagName && node.tagName.toLowerCase() === 'input' && typeof node.select === 'function';\n};\n\nvar isEscapeEvent = function isEscapeEvent(e) {\n  return e.key === 'Escape' || e.key === 'Esc' || e.keyCode === 27;\n};\n\nvar isTabEvent = function isTabEvent(e) {\n  return e.key === 'Tab' || e.keyCode === 9;\n};\n\nvar delay = function delay(fn) {\n  return setTimeout(fn, 0);\n}; // Array.find/findIndex() are not supported on IE; this replicates enough\n//  of Array.findIndex() for our needs\n\n\nvar findIndex = function findIndex(arr, fn) {\n  var idx = -1;\n  arr.every(function (value, i) {\n    if (fn(value)) {\n      idx = i;\n      return false; // break\n    }\n\n    return true; // next\n  });\n  return idx;\n};\n/**\n * Get an option's value when it could be a plain value, or a handler that provides\n *  the value.\n * @param {*} value Option's value to check.\n * @param {...*} [params] Any parameters to pass to the handler, if `value` is a function.\n * @returns {*} The `value`, or the handler's returned value.\n */\n\n\nvar valueOrHandler = function valueOrHandler(value) {\n  for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    params[_key - 1] = arguments[_key];\n  }\n\n  return typeof value === 'function' ? value.apply(void 0, params) : value;\n};\n\nvar getActualTarget = function getActualTarget(event) {\n  // NOTE: If the trap is _inside_ a shadow DOM, event.target will always be the\n  //  shadow host. However, event.target.composedPath() will be an array of\n  //  nodes \"clicked\" from inner-most (the actual element inside the shadow) to\n  //  outer-most (the host HTML document). If we have access to composedPath(),\n  //  then use its first element; otherwise, fall back to event.target (and\n  //  this only works for an _open_ shadow DOM; otherwise,\n  //  composedPath()[0] === event.target always).\n  return event.target.shadowRoot && typeof event.composedPath === 'function' ? event.composedPath()[0] : event.target;\n};\n\nvar createFocusTrap = function createFocusTrap(elements, userOptions) {\n  var doc = (userOptions === null || userOptions === void 0 ? void 0 : userOptions.document) || document;\n\n  var config = _objectSpread2({\n    returnFocusOnDeactivate: true,\n    escapeDeactivates: true,\n    delayInitialFocus: true\n  }, userOptions);\n\n  var state = {\n    // @type {Array<HTMLElement>}\n    containers: [],\n    // list of objects identifying the first and last tabbable nodes in all containers/groups in\n    //  the trap\n    // NOTE: it's possible that a group has no tabbable nodes if nodes get removed while the trap\n    //  is active, but the trap should never get to a state where there isn't at least one group\n    //  with at least one tabbable node in it (that would lead to an error condition that would\n    //  result in an error being thrown)\n    // @type {Array<{ container: HTMLElement, firstTabbableNode: HTMLElement|null, lastTabbableNode: HTMLElement|null }>}\n    tabbableGroups: [],\n    nodeFocusedBeforeActivation: null,\n    mostRecentlyFocusedNode: null,\n    active: false,\n    paused: false,\n    // timer ID for when delayInitialFocus is true and initial focus in this trap\n    //  has been delayed during activation\n    delayInitialFocusTimer: undefined\n  };\n  var trap; // eslint-disable-line prefer-const -- some private functions reference it, and its methods reference private functions, so we must declare here and define later\n\n  var getOption = function getOption(configOverrideOptions, optionName, configOptionName) {\n    return configOverrideOptions && configOverrideOptions[optionName] !== undefined ? configOverrideOptions[optionName] : config[configOptionName || optionName];\n  };\n\n  var containersContain = function containersContain(element) {\n    return !!(element && state.containers.some(function (container) {\n      return container.contains(element);\n    }));\n  };\n  /**\n   * Gets the node for the given option, which is expected to be an option that\n   *  can be either a DOM node, a string that is a selector to get a node, `false`\n   *  (if a node is explicitly NOT given), or a function that returns any of these\n   *  values.\n   * @param {string} optionName\n   * @returns {undefined | false | HTMLElement | SVGElement} Returns\n   *  `undefined` if the option is not specified; `false` if the option\n   *  resolved to `false` (node explicitly not given); otherwise, the resolved\n   *  DOM node.\n   * @throws {Error} If the option is set, not `false`, and is not, or does not\n   *  resolve to a node.\n   */\n\n\n  var getNodeForOption = function getNodeForOption(optionName) {\n    var optionValue = config[optionName];\n\n    if (typeof optionValue === 'function') {\n      for (var _len2 = arguments.length, params = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        params[_key2 - 1] = arguments[_key2];\n      }\n\n      optionValue = optionValue.apply(void 0, params);\n    }\n\n    if (!optionValue) {\n      if (optionValue === undefined || optionValue === false) {\n        return optionValue;\n      } // else, empty string (invalid), null (invalid), 0 (invalid)\n\n\n      throw new Error(\"`\".concat(optionName, \"` was specified but was not a node, or did not return a node\"));\n    }\n\n    var node = optionValue; // could be HTMLElement, SVGElement, or non-empty string at this point\n\n    if (typeof optionValue === 'string') {\n      node = doc.querySelector(optionValue); // resolve to node, or null if fails\n\n      if (!node) {\n        throw new Error(\"`\".concat(optionName, \"` as selector refers to no known node\"));\n      }\n    }\n\n    return node;\n  };\n\n  var getInitialFocusNode = function getInitialFocusNode() {\n    var node = getNodeForOption('initialFocus'); // false explicitly indicates we want no initialFocus at all\n\n    if (node === false) {\n      return false;\n    }\n\n    if (node === undefined) {\n      // option not specified: use fallback options\n      if (containersContain(doc.activeElement)) {\n        node = doc.activeElement;\n      } else {\n        var firstTabbableGroup = state.tabbableGroups[0];\n        var firstTabbableNode = firstTabbableGroup && firstTabbableGroup.firstTabbableNode; // NOTE: `fallbackFocus` option function cannot return `false` (not supported)\n\n        node = firstTabbableNode || getNodeForOption('fallbackFocus');\n      }\n    }\n\n    if (!node) {\n      throw new Error('Your focus-trap needs to have at least one focusable element');\n    }\n\n    return node;\n  };\n\n  var updateTabbableNodes = function updateTabbableNodes() {\n    state.tabbableGroups = state.containers.map(function (container) {\n      var tabbableNodes = tabbable(container);\n\n      if (tabbableNodes.length > 0) {\n        return {\n          container: container,\n          firstTabbableNode: tabbableNodes[0],\n          lastTabbableNode: tabbableNodes[tabbableNodes.length - 1]\n        };\n      }\n\n      return undefined;\n    }).filter(function (group) {\n      return !!group;\n    }); // remove groups with no tabbable nodes\n    // throw if no groups have tabbable nodes and we don't have a fallback focus node either\n\n    if (state.tabbableGroups.length <= 0 && !getNodeForOption('fallbackFocus') // returning false not supported for this option\n    ) {\n      throw new Error('Your focus-trap must have at least one container with at least one tabbable node in it at all times');\n    }\n  };\n\n  var tryFocus = function tryFocus(node) {\n    if (node === false) {\n      return;\n    }\n\n    if (node === doc.activeElement) {\n      return;\n    }\n\n    if (!node || !node.focus) {\n      tryFocus(getInitialFocusNode());\n      return;\n    }\n\n    node.focus({\n      preventScroll: !!config.preventScroll\n    });\n    state.mostRecentlyFocusedNode = node;\n\n    if (isSelectableInput(node)) {\n      node.select();\n    }\n  };\n\n  var getReturnFocusNode = function getReturnFocusNode(previousActiveElement) {\n    var node = getNodeForOption('setReturnFocus', previousActiveElement);\n    return node ? node : node === false ? false : previousActiveElement;\n  }; // This needs to be done on mousedown and touchstart instead of click\n  // so that it precedes the focus event.\n\n\n  var checkPointerDown = function checkPointerDown(e) {\n    var target = getActualTarget(e);\n\n    if (containersContain(target)) {\n      // allow the click since it ocurred inside the trap\n      return;\n    }\n\n    if (valueOrHandler(config.clickOutsideDeactivates, e)) {\n      // immediately deactivate the trap\n      trap.deactivate({\n        // if, on deactivation, we should return focus to the node originally-focused\n        //  when the trap was activated (or the configured `setReturnFocus` node),\n        //  then assume it's also OK to return focus to the outside node that was\n        //  just clicked, causing deactivation, as long as that node is focusable;\n        //  if it isn't focusable, then return focus to the original node focused\n        //  on activation (or the configured `setReturnFocus` node)\n        // NOTE: by setting `returnFocus: false`, deactivate() will do nothing,\n        //  which will result in the outside click setting focus to the node\n        //  that was clicked, whether it's focusable or not; by setting\n        //  `returnFocus: true`, we'll attempt to re-focus the node originally-focused\n        //  on activation (or the configured `setReturnFocus` node)\n        returnFocus: config.returnFocusOnDeactivate && !isFocusable(target)\n      });\n      return;\n    } // This is needed for mobile devices.\n    // (If we'll only let `click` events through,\n    // then on mobile they will be blocked anyways if `touchstart` is blocked.)\n\n\n    if (valueOrHandler(config.allowOutsideClick, e)) {\n      // allow the click outside the trap to take place\n      return;\n    } // otherwise, prevent the click\n\n\n    e.preventDefault();\n  }; // In case focus escapes the trap for some strange reason, pull it back in.\n\n\n  var checkFocusIn = function checkFocusIn(e) {\n    var target = getActualTarget(e);\n    var targetContained = containersContain(target); // In Firefox when you Tab out of an iframe the Document is briefly focused.\n\n    if (targetContained || target instanceof Document) {\n      if (targetContained) {\n        state.mostRecentlyFocusedNode = target;\n      }\n    } else {\n      // escaped! pull it back in to where it just left\n      e.stopImmediatePropagation();\n      tryFocus(state.mostRecentlyFocusedNode || getInitialFocusNode());\n    }\n  }; // Hijack Tab events on the first and last focusable nodes of the trap,\n  // in order to prevent focus from escaping. If it escapes for even a\n  // moment it can end up scrolling the page and causing confusion so we\n  // kind of need to capture the action at the keydown phase.\n\n\n  var checkTab = function checkTab(e) {\n    var target = getActualTarget(e);\n    updateTabbableNodes();\n    var destinationNode = null;\n\n    if (state.tabbableGroups.length > 0) {\n      // make sure the target is actually contained in a group\n      // NOTE: the target may also be the container itself if it's tabbable\n      //  with tabIndex='-1' and was given initial focus\n      var containerIndex = findIndex(state.tabbableGroups, function (_ref) {\n        var container = _ref.container;\n        return container.contains(target);\n      });\n\n      if (containerIndex < 0) {\n        // target not found in any group: quite possible focus has escaped the trap,\n        //  so bring it back in to...\n        if (e.shiftKey) {\n          // ...the last node in the last group\n          destinationNode = state.tabbableGroups[state.tabbableGroups.length - 1].lastTabbableNode;\n        } else {\n          // ...the first node in the first group\n          destinationNode = state.tabbableGroups[0].firstTabbableNode;\n        }\n      } else if (e.shiftKey) {\n        // REVERSE\n        // is the target the first tabbable node in a group?\n        var startOfGroupIndex = findIndex(state.tabbableGroups, function (_ref2) {\n          var firstTabbableNode = _ref2.firstTabbableNode;\n          return target === firstTabbableNode;\n        });\n\n        if (startOfGroupIndex < 0 && state.tabbableGroups[containerIndex].container === target) {\n          // an exception case where the target is the container itself, in which\n          //  case, we should handle shift+tab as if focus were on the container's\n          //  first tabbable node, and go to the last tabbable node of the LAST group\n          startOfGroupIndex = containerIndex;\n        }\n\n        if (startOfGroupIndex >= 0) {\n          // YES: then shift+tab should go to the last tabbable node in the\n          //  previous group (and wrap around to the last tabbable node of\n          //  the LAST group if it's the first tabbable node of the FIRST group)\n          var destinationGroupIndex = startOfGroupIndex === 0 ? state.tabbableGroups.length - 1 : startOfGroupIndex - 1;\n          var destinationGroup = state.tabbableGroups[destinationGroupIndex];\n          destinationNode = destinationGroup.lastTabbableNode;\n        }\n      } else {\n        // FORWARD\n        // is the target the last tabbable node in a group?\n        var lastOfGroupIndex = findIndex(state.tabbableGroups, function (_ref3) {\n          var lastTabbableNode = _ref3.lastTabbableNode;\n          return target === lastTabbableNode;\n        });\n\n        if (lastOfGroupIndex < 0 && state.tabbableGroups[containerIndex].container === target) {\n          // an exception case where the target is the container itself, in which\n          //  case, we should handle tab as if focus were on the container's\n          //  last tabbable node, and go to the first tabbable node of the FIRST group\n          lastOfGroupIndex = containerIndex;\n        }\n\n        if (lastOfGroupIndex >= 0) {\n          // YES: then tab should go to the first tabbable node in the next\n          //  group (and wrap around to the first tabbable node of the FIRST\n          //  group if it's the last tabbable node of the LAST group)\n          var _destinationGroupIndex = lastOfGroupIndex === state.tabbableGroups.length - 1 ? 0 : lastOfGroupIndex + 1;\n\n          var _destinationGroup = state.tabbableGroups[_destinationGroupIndex];\n          destinationNode = _destinationGroup.firstTabbableNode;\n        }\n      }\n    } else {\n      // NOTE: the fallbackFocus option does not support returning false to opt-out\n      destinationNode = getNodeForOption('fallbackFocus');\n    }\n\n    if (destinationNode) {\n      e.preventDefault();\n      tryFocus(destinationNode);\n    } // else, let the browser take care of [shift+]tab and move the focus\n\n  };\n\n  var checkKey = function checkKey(e) {\n    if (isEscapeEvent(e) && valueOrHandler(config.escapeDeactivates, e) !== false) {\n      e.preventDefault();\n      trap.deactivate();\n      return;\n    }\n\n    if (isTabEvent(e)) {\n      checkTab(e);\n      return;\n    }\n  };\n\n  var checkClick = function checkClick(e) {\n    if (valueOrHandler(config.clickOutsideDeactivates, e)) {\n      return;\n    }\n\n    var target = getActualTarget(e);\n\n    if (containersContain(target)) {\n      return;\n    }\n\n    if (valueOrHandler(config.allowOutsideClick, e)) {\n      return;\n    }\n\n    e.preventDefault();\n    e.stopImmediatePropagation();\n  }; //\n  // EVENT LISTENERS\n  //\n\n\n  var addListeners = function addListeners() {\n    if (!state.active) {\n      return;\n    } // There can be only one listening focus trap at a time\n\n\n    activeFocusTraps.activateTrap(trap); // Delay ensures that the focused element doesn't capture the event\n    // that caused the focus trap activation.\n\n    state.delayInitialFocusTimer = config.delayInitialFocus ? delay(function () {\n      tryFocus(getInitialFocusNode());\n    }) : tryFocus(getInitialFocusNode());\n    doc.addEventListener('focusin', checkFocusIn, true);\n    doc.addEventListener('mousedown', checkPointerDown, {\n      capture: true,\n      passive: false\n    });\n    doc.addEventListener('touchstart', checkPointerDown, {\n      capture: true,\n      passive: false\n    });\n    doc.addEventListener('click', checkClick, {\n      capture: true,\n      passive: false\n    });\n    doc.addEventListener('keydown', checkKey, {\n      capture: true,\n      passive: false\n    });\n    return trap;\n  };\n\n  var removeListeners = function removeListeners() {\n    if (!state.active) {\n      return;\n    }\n\n    doc.removeEventListener('focusin', checkFocusIn, true);\n    doc.removeEventListener('mousedown', checkPointerDown, true);\n    doc.removeEventListener('touchstart', checkPointerDown, true);\n    doc.removeEventListener('click', checkClick, true);\n    doc.removeEventListener('keydown', checkKey, true);\n    return trap;\n  }; //\n  // TRAP DEFINITION\n  //\n\n\n  trap = {\n    activate: function activate(activateOptions) {\n      if (state.active) {\n        return this;\n      }\n\n      var onActivate = getOption(activateOptions, 'onActivate');\n      var onPostActivate = getOption(activateOptions, 'onPostActivate');\n      var checkCanFocusTrap = getOption(activateOptions, 'checkCanFocusTrap');\n\n      if (!checkCanFocusTrap) {\n        updateTabbableNodes();\n      }\n\n      state.active = true;\n      state.paused = false;\n      state.nodeFocusedBeforeActivation = doc.activeElement;\n\n      if (onActivate) {\n        onActivate();\n      }\n\n      var finishActivation = function finishActivation() {\n        if (checkCanFocusTrap) {\n          updateTabbableNodes();\n        }\n\n        addListeners();\n\n        if (onPostActivate) {\n          onPostActivate();\n        }\n      };\n\n      if (checkCanFocusTrap) {\n        checkCanFocusTrap(state.containers.concat()).then(finishActivation, finishActivation);\n        return this;\n      }\n\n      finishActivation();\n      return this;\n    },\n    deactivate: function deactivate(deactivateOptions) {\n      if (!state.active) {\n        return this;\n      }\n\n      clearTimeout(state.delayInitialFocusTimer); // noop if undefined\n\n      state.delayInitialFocusTimer = undefined;\n      removeListeners();\n      state.active = false;\n      state.paused = false;\n      activeFocusTraps.deactivateTrap(trap);\n      var onDeactivate = getOption(deactivateOptions, 'onDeactivate');\n      var onPostDeactivate = getOption(deactivateOptions, 'onPostDeactivate');\n      var checkCanReturnFocus = getOption(deactivateOptions, 'checkCanReturnFocus');\n\n      if (onDeactivate) {\n        onDeactivate();\n      }\n\n      var returnFocus = getOption(deactivateOptions, 'returnFocus', 'returnFocusOnDeactivate');\n\n      var finishDeactivation = function finishDeactivation() {\n        delay(function () {\n          if (returnFocus) {\n            tryFocus(getReturnFocusNode(state.nodeFocusedBeforeActivation));\n          }\n\n          if (onPostDeactivate) {\n            onPostDeactivate();\n          }\n        });\n      };\n\n      if (returnFocus && checkCanReturnFocus) {\n        checkCanReturnFocus(getReturnFocusNode(state.nodeFocusedBeforeActivation)).then(finishDeactivation, finishDeactivation);\n        return this;\n      }\n\n      finishDeactivation();\n      return this;\n    },\n    pause: function pause() {\n      if (state.paused || !state.active) {\n        return this;\n      }\n\n      state.paused = true;\n      removeListeners();\n      return this;\n    },\n    unpause: function unpause() {\n      if (!state.paused || !state.active) {\n        return this;\n      }\n\n      state.paused = false;\n      updateTabbableNodes();\n      addListeners();\n      return this;\n    },\n    updateContainerElements: function updateContainerElements(containerElements) {\n      var elementsAsArray = [].concat(containerElements).filter(Boolean);\n      state.containers = elementsAsArray.map(function (element) {\n        return typeof element === 'string' ? doc.querySelector(element) : element;\n      });\n\n      if (state.active) {\n        updateTabbableNodes();\n      }\n\n      return this;\n    }\n  }; // initialize container elements\n\n  trap.updateContainerElements(elements);\n  return trap;\n};\n\nexport { createFocusTrap };\n//# sourceMappingURL=focus-trap.esm.js.map\n","import * as focusTrap from \"focus-trap\";\nimport { window } from \"global\";\n\n\nconst addFocusTrap = ({ target, escToClose, clickOutsideToClose }): any => {\n    const isDevMode = !window.Lusift.activeGuideID;\n\n    const ft = focusTrap.createFocusTrap(target, {\n        // initialFocus: false,\n        delayInitialFocus: false,\n        escapeDeactivates: !isDevMode && escToClose,\n        clickOutsideDeactivates: !isDevMode && clickOutsideToClose,\n    });\n    ft.activate();\n    return ft;\n};\n\nexport default addFocusTrap;\n","function debounce<T>(\n  fn: (arg: T) => void,\n  ms: number\n): (arg: T) => void {\n  // Avoid wrapping in `setTimeout` if ms is 0 anyway\n  if (ms === 0) {\n    return fn;\n  }\n\n  let timeout: any;\n\n  return (arg): void => {\n    clearTimeout(timeout);\n    timeout = setTimeout(() => {\n      fn(arg);\n    }, ms);\n  };\n}\n\nexport default debounce;\n","import { window } from \"global\";\nimport { saveState, loadState } from \"../common/store\";\nimport { log, warn, error } from \"../common/logger\";\nimport {\n    changeAsyncStepStatus,\n    startStepInstance,\n    doesStepMatchDisplayCriteria,\n} from \"../common/utils\";\n\nimport { GuideType, TrackingState, StepTargetType } from \"../common/types\";\n\nexport default class Guide {\n    readonly guideData: GuideType;\n    private activeSteps: {\n        index: number;\n        instance: any;\n        target: StepTargetType;\n        type: string;\n        async: boolean;\n    }[] = [];\n    // ^For limited use only, doesn't update after a step is closed\n    // TODO: make this update after a step is closed\n\n    constructor(guideID: string) {\n        // localGuideState consists of trackingState and guideData\n        log(\"guide constructor\");\n        log(loadState());\n        const localGuideState = loadState()[guideID];\n        const guideData = Object.assign({}, localGuideState);\n        delete guideData.trackingState;\n\n        this.guideData = guideData;\n        log(\n            `%c Welcome to guide: ${this.guideData.name || this.guideData.id}`,\n            \"background: #222; color: #bada55\",\n        );\n\n        if (!localGuideState.trackingState) {\n            const newTrackingState = this.generateNewTrackingState();\n            this.setTrackingState(newTrackingState);\n        }\n    }\n\n    private generateNewTrackingState(): TrackingState {\n        let newTrackingState = {\n            currentStepIndex: 0,\n            finished: false,\n            prematurelyClosed: false,\n            asyncSteps: {},\n            enabled: false,\n        };\n\n        //for async steps\n        this.guideData.steps.forEach(step => {\n            if (\"async\" in step) {\n                if (step.async && step.type === \"hotspot\") {\n                    newTrackingState.asyncSteps[step.index] = {\n                        toOpen: false,\n                    };\n                }\n            }\n        });\n        return newTrackingState;\n    }\n\n    public start(): void {\n        const { finished, prematurelyClosed } = this.getTrackingState();\n        this.removeIllegalSteps();\n        this.attemptToStartAsyncSteps();\n\n        if (finished || prematurelyClosed) {\n            error(\"Guide is already finished or closed\");\n        } else {\n            this.attemptToShowActiveStep();\n        }\n    }\n\n    private removeAllActiveSteps(): void {\n        this.activeSteps.forEach(stepInstance => {\n            // instance.reRenderPageElements();\n            const { type, target, instance, async } = stepInstance;\n            if (async && type === \"hotspot\") {\n                instance.removeResizeObservers();\n            }\n            instance.remove();\n        });\n        this.activeSteps = [];\n    }\n\n    public reRenderStepElements(): void {\n        log(\"re-render step elements\");\n        this.removeAllActiveSteps();\n        this.start();\n    }\n\n    private attemptToShowActiveStep(): void {\n        // we start with some currentStep from this.trackingState\n        // if the step is async, set toOpen to true\n        //-- if display criteria matches and step isn't already displayed, then startStep\n        // if the step is async, loop back with stepIndex++\n        const { currentStepIndex } = this.getTrackingState();\n        let stepIndex = currentStepIndex;\n        const steps = this.guideData.steps;\n        let isAsyncStep: boolean;\n\n        stepIndex--;\n        do {\n            stepIndex++;\n            const step = steps[stepIndex];\n            const { target, type } = steps[stepIndex];\n            let async = false;\n            if (\"async\" in step) {\n                async = step.async!;\n            }\n            const displayCriteriaMatches = doesStepMatchDisplayCriteria({\n                target,\n                type,\n            });\n            isAsyncStep = async && type === \"hotspot\";\n\n            if (isAsyncStep) {\n                changeAsyncStepStatus(stepIndex, true);\n            }\n            if (displayCriteriaMatches && !this.isStepAlreadyActive(stepIndex)) {\n                this.activeSteps.push({\n                    index: stepIndex,\n                    instance: startStepInstance(steps[stepIndex], this.guideData.id),\n                    target,\n                    type,\n                    async,\n                });\n            }\n        } while (isAsyncStep);\n\n        let newTrackingState = this.getTrackingState();\n        newTrackingState.currentStepIndex = stepIndex;\n        this.setTrackingState(newTrackingState);\n    }\n\n    private isStepAlreadyActive(stepIndex: number): boolean {\n        return this.activeSteps.some(({ index }) => index === stepIndex);\n    }\n\n    private attemptToStartAsyncSteps(): void {\n        // start all the async hotpots with toOpen true\n        const steps = this.guideData.steps;\n        steps.forEach(step => {\n            const { type, index, target } = step;\n            let async = false;\n            if (\"async\" in step) {\n                async = step.async!;\n            }\n            if (async && type === \"hotspot\") {\n                if (\n                    doesStepMatchDisplayCriteria({ target, type }) &&\n                    this.getTrackingState().asyncSteps[index].toOpen\n                ) {\n                    log(`Step ${index}: target path and element matched. toOpen is true`);\n                    // if step is already active warn that the step is already active\n                    if (this.isStepAlreadyActive(index)) {\n                        return warn(`Step ${index} is already active`);\n                    }\n                    this.activeSteps.push({\n                        index,\n                        instance: startStepInstance(steps[index], this.guideData.id),\n                        target,\n                        type,\n                        async,\n                    });\n                }\n            }\n        });\n    }\n\n    private removeIllegalSteps(): void {\n        this.activeSteps = this.activeSteps.filter(stepInstance => {\n            // if step display criteria doesn't match, then run remove() and remove from this.activeSteps\n            const { type, target, instance, async } = stepInstance;\n            if (!doesStepMatchDisplayCriteria({ target, type })) {\n                if (async && type === \"hotspot\") {\n                    instance.removeResizeObservers();\n                }\n                instance.remove();\n                return false;\n            } else {\n                return true;\n            }\n        });\n    }\n\n    private setTrackingState(trackingState: TrackingState | undefined): void {\n        const existingState = loadState();\n        saveState({\n            ...existingState,\n            [this.guideData.id]: {\n                ...existingState[this.guideData.id],\n                trackingState,\n            },\n        });\n    }\n\n    public getTrackingState(): TrackingState {\n        return loadState()[this.guideData.id].trackingState;\n    }\n\n    private clearTrackingState(): void {\n        this.setTrackingState(undefined);\n    }\n\n    public setStep(newStepNum: number): void {\n        // change step and see which steps need to be unmounted or mounted\n        let newTrackingState = this.getTrackingState();\n        if (newStepNum < 0) {\n            return warn(\"Step index can't be less than 0\");\n        } else if (newStepNum + 1 > this.guideData.steps.length) {\n            newTrackingState.finished = true;\n            this.setTrackingState(newTrackingState);\n            log(\"guide finished\");\n        } else {\n            newTrackingState.currentStepIndex = newStepNum;\n            this.setTrackingState(newTrackingState);\n            this.start();\n        }\n    }\n\n    private close(): void {\n        // close guide\n        // if current step is last step then finished=true, else prematurelyClosed=true\n        let newTrackingState = this.getTrackingState();\n        if (newTrackingState.currentStepIndex + 1 === this.guideData.steps.length) {\n            newTrackingState.finished = true;\n        } else {\n            newTrackingState.prematurelyClosed = true;\n        }\n        this.setTrackingState(newTrackingState);\n        this.removeAllActiveSteps();\n        window.Lusift.activeGuide = null;\n        log(\"guide closed\");\n        typeof window.Lusift.onClose === \"function\" && window.Lusift.onClose();\n        window.Lusift.disable(this.guideData.id);\n    }\n\n    private closeCurrentStep(): void {\n        // if this.trackingState.activeStep is equal to any index of item from this.activeSteps, then log('hello')\n        const { currentStepIndex } = this.getTrackingState();\n        const currentStep = this.activeSteps.find(({ index }) => index === currentStepIndex);\n\n        if (currentStep) {\n            currentStep.instance.remove();\n            this.activeSteps = this.activeSteps.filter(\n                instance => instance.index !== currentStepIndex,\n            );\n        } else {\n            warn(\"There's no active step to close\");\n        }\n    }\n\n    private nextStep(): void {\n        const newStep = this.getTrackingState().currentStepIndex + 1;\n        if (newStep + 1 > this.guideData.steps.length) {\n            return error(\"No new steps\");\n        }\n        this.closeCurrentStep();\n        this.setStep(newStep);\n        typeof window.Lusift.onNext === \"function\" && window.Lusift.onNext();\n    }\n\n    private prevStep(): void {\n        // make newStep the index of the closest previus step with !step.async\n        let newStep = this.getTrackingState().currentStepIndex;\n\n        while (newStep > -2) {\n            newStep--;\n            const step = this.guideData.steps[newStep];\n            if (!step) {\n                break;\n            }\n            let async = false;\n            if (\"async\" in step) {\n                async = step.async!;\n            }\n            let stepIsAsync = step.type === \"hotspot\" && async;\n            if (!stepIsAsync) {\n                break;\n            }\n        }\n        if (newStep < 0) return error(\"No previous steps\");\n        this.closeCurrentStep();\n        this.setStep(newStep);\n        const Lusift = window[\"Lusift\"];\n        typeof Lusift.onPrev === \"function\" && Lusift.onPrev();\n    }\n}\n","/**\n * Lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright JS Foundation and other contributors <https://js.foundation/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    asyncTag = '[object AsyncFunction]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    nullTag = '[object Null]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    proxyTag = '[object Proxy]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]',\n    undefinedTag = '[object Undefined]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\n/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\n/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\n/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\n/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\n/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\n/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\n/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype,\n    funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined,\n    Symbol = root.Symbol,\n    Uint8Array = root.Uint8Array,\n    propertyIsEnumerable = objectProto.propertyIsEnumerable,\n    splice = arrayProto.splice,\n    symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols,\n    nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined,\n    nativeKeys = overArg(Object.keys, Object);\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView'),\n    Map = getNative(root, 'Map'),\n    Promise = getNative(root, 'Promise'),\n    Set = getNative(root, 'Set'),\n    WeakMap = getNative(root, 'WeakMap'),\n    nativeCreate = getNative(Object, 'create');\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\n/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\n/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\n/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\n/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\n/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(array);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(object);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  length = length == null ? MAX_SAFE_INTEGER : length;\n  return !!length &&\n    (typeof value == 'number' || reIsUint.test(value)) &&\n    (value > -1 && value % 1 == 0 && value < length);\n}\n\n/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\n/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\n/**\n * Performs a deep comparison between two values to determine if they are\n * equivalent.\n *\n * **Note:** This method supports comparing arrays, array buffers, booleans,\n * date objects, error objects, maps, numbers, `Object` objects, regexes,\n * sets, strings, symbols, and typed arrays. `Object` objects are compared\n * by their own, not inherited, enumerable properties. Functions and DOM\n * nodes are compared by strict equality, i.e. `===`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.isEqual(object, other);\n * // => true\n *\n * object === other;\n * // => false\n */\nfunction isEqual(value, other) {\n  return baseIsEqual(value, other);\n}\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\n/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\n/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = isEqual;\n","import Guide from \"./Guide\";\nimport { saveState, loadState } from \"../common/store\";\nimport { log, error, warn } from \"../common/logger\";\nimport isEqual from \"lodash.isequal\";\nimport { doesStepMatchDisplayCriteria, startStepInstance } from \"../common/utils\";\n\nimport { window, document } from \"global\";\n\nimport { GuideType, Content, TrackingState } from \"../common/types\";\n\nimport { isOfTypeContent, isObject } from \"../common/utils/isOfType\";\n\nimport addDefaultCSS from \"./addDefaultCSS\";\n\n// TODO: Write documentation\n\n// TODO: decide on making configuring easier, with inheritence, global levels, etc.\n// -- Maybe don't have setContent take everything, seperate concerns. makes documenting easier too\n// NOTE_: Support for different typescript versions\n// TODO_: add support for angul*r\n// TODO: Buggy when the target for tooltip is sidebar link\n// TODO: Add option to be able to set where the progress bar should be relative to the 2 axis or the arrow\n// TODO: Tooltip positioning for different screen sizes\n// -- how do the comercial saas handle it? automatically or end-user config?\n// -- have the options for orientation be `auto` and `fixed` with positions being the different axis relative to\n// the target. With auto, the position is only picked when there is space for the tooltip, else it moves to different position\n// NOTE: Handling versioning\n// TODO: rename filenames\n// TODO: lodash.isequal is 9.4kb! Replace it with something lighter\n// TODO: Performance concerns of the host app in rendering all this stuff?\n// -- https://web.archive.org/web/20210827084020/https://atfzl.com/don-t-attach-tooltips-to-document-body\n// TODO: Can we just export element classes (Tooltip, Modal, Hotspot, Backdrop) and have them be optionally loadable by the client?\n// -- something like how modifiers work in popperjs\n\nconst noOp = () => {}; // no-op function\n\nclass Lusift {\n    private content: Content | undefined;\n    public render: Function = noOp;\n    public activeGuide: {\n        instance: any;\n        id: string;\n    } | null = null;\n    public progress: number = 0;\n\n    private next: Function = noOp;\n    private prev: Function = noOp;\n    private close: Function = noOp;\n    private goto: Function = noOp;\n    private onNext: Function | undefined;\n    private onPrev: Function | undefined;\n    private onClose: Function | undefined;\n\n    constructor() {\n        log(\"%c Lusift constructor! \", \"background: #222; color: #bada55\");\n\n        const localData = loadState();\n        // if loadState() type is not object,\n        if (!isObject(localData)) {\n            saveState({});\n        }\n        addDefaultCSS();\n        /* if (typeof document !== \"undefined\") {\n            window['updateTooltip'] = updateTooltip;\n            createTooltip();\n        } */\n    }\n\n    private showEnabledContent(): void {\n        const localData = loadState();\n        const enabledGuideID = Object.keys(localData).find(key => {\n            const { trackingState } = localData[key];\n            if(trackingState){\n                return trackingState.enabled\n            }\n            return false;\n        });\n        if (enabledGuideID) {\n            this.showContent(enabledGuideID);\n        }\n    }\n\n    public enable(guideID: string): void {\n        let localData = loadState();\n        if(!Object.keys(localData).some(key => key === guideID)) {\n            return error(`Content of id '${guideID}' doesn't exist`);\n        }\n\n        Object.keys(localData).forEach(key => {\n            const { trackingState } = localData[key];\n            if(trackingState){\n                localData[key].trackingState.enabled = key === guideID;\n            }\n        });\n        saveState(localData);\n        this.showContent(guideID);\n    }\n\n    public disable(guideID: string): void {\n        let localData = loadState();\n        if(!Object.keys(localData).some(key => key === guideID)) {\n            return error(`Content of id '${guideID}' doesn't exist`);\n        }\n        localData[guideID].trackingState.enabled = false;\n        saveState(localData);\n    }\n\n    private hasGuideDataChanged(guideData: GuideType): boolean {\n        const localData = loadState();\n        if (!localData[guideData.id]) return true;\n        const localGuideData = localData[guideData.id];\n        delete localGuideData.trackingState;\n        const guideDataWithoutHooks = { ...guideData };\n        delete guideDataWithoutHooks.onNext;\n        delete guideDataWithoutHooks.onClose;\n        delete guideDataWithoutHooks.onPrev;\n        return !isEqual(localGuideData, guideDataWithoutHooks);\n    }\n\n    private reconcileContentWithLocalState(): void {\n        // Look through each content item,\n        // --clear tracking data if item data has changed, and if doNotResetTrackerOnContentChange is false\n        // --conserve otherwise\n        let stateToSave = {};\n        let contentWithoutBodyContent = JSON.parse(JSON.stringify(this.content));\n\n        Object.keys(this.content!).forEach(key => {\n            const {\n                id,\n                name = \"\",\n                description = \"\",\n                steps,\n                onNext,\n                onPrev,\n                onClose,\n                doNotResetTrackerOnContentChange = false,\n            } = contentWithoutBodyContent[key].data;\n\n            // remove bodyContent from steps\n            let stepsWithoutBodyContent = steps.map(step => {\n                if (step.type === \"tooltip\" || step.type === \"modal\") {\n                    delete step.data.bodyContent;\n                } else if (step.type === \"hotspot\") {\n                    delete step.tip.data.bodyContent;\n                }\n                return step;\n            });\n\n            contentWithoutBodyContent[key].data = {\n                id,\n                name,\n                description,\n                steps: stepsWithoutBodyContent,\n                onNext,\n                onPrev,\n                onClose,\n                doNotResetTrackerOnContentChange,\n            };\n        });\n\n        Object.keys(contentWithoutBodyContent).forEach(key => {\n            if (contentWithoutBodyContent[key].type === \"guide\") {\n                const guideData = contentWithoutBodyContent[key].data; //prolly a guide\n                if (\n                    this.hasGuideDataChanged(guideData) &&\n                    !guideData.doNotResetTrackerOnContentChange\n                ) {\n                    log(`guide with id '${key}' changed, tracking state reset.`);\n                    // clear tracking data\n                    stateToSave[guideData.id] = guideData;\n                } else {\n                    const localGuideData = loadState()[guideData.id];\n                    stateToSave[guideData.id] = localGuideData;\n                }\n            }\n        });\n        saveState(stateToSave);\n    }\n\n    public setContent(content: Content): void {\n        // filter and validate content\n        if (!isOfTypeContent(content)) {\n            return error(\"Content data type is invalid\");\n        }\n\n        // retrieve approriate properties from received content\n        this.content = content;\n        Object.keys(content).forEach(key => {\n            const {\n                id,\n                name = \"\",\n                description = \"\",\n                steps,\n                onNext,\n                onPrev,\n                onClose,\n                doNotResetTrackerOnContentChange = false,\n            } = content[key].data;\n\n            this.content![key].data = {\n                id,\n                name,\n                description,\n                steps,\n                onNext,\n                onPrev,\n                onClose,\n                doNotResetTrackerOnContentChange,\n            };\n        });\n\n        let dataOfActiveGuideChanged: boolean;\n        let contentIDExists: boolean;\n\n        if (this.activeGuide) {\n            dataOfActiveGuideChanged = this.hasGuideDataChanged(\n                this.content[this.activeGuide.id].data,\n            );\n            contentIDExists = Object.keys(this.content).includes(this.activeGuide.id);\n        }\n\n        // iterate through each content item to note changes and conditionally preserve trackingState\n        // and then save to localStorage\n        this.reconcileContentWithLocalState();\n        //content has been set to local\n\n        // for any already active guide\n        if (this.activeGuide) {\n            // if the contentID doesn't exist at all in the new content received, or\n            // if contentID exists but data has changed\n            if (!contentIDExists! || (contentIDExists && dataOfActiveGuideChanged!)) {\n                this.activeGuide.instance.removeAllActiveSteps();\n                this.activeGuide = null;\n            }\n        }\n    }\n\n    public clearContent(): void {\n        saveState({});\n        this.content = {};\n    }\n\n    public refresh(): void {\n        // run page elements through step display conditionals again\n        if (this.activeGuide) {\n            window.setTimeout(() => {\n                this.activeGuide!.instance.start();\n                log(\"Lusift refreshed\");\n                // log('%c page refresh ', 'background: #222; color: #bada55');\n            }, 0);\n        } else {\n            warn(\"No active guide instance to refresh\");\n            // Assuming this method is called every time on page load.\n            // Better than running in constructor which runs on import of Lusift\n            this.showEnabledContent();\n        }\n    }\n\n    public showContent<T extends string>(contentID: T extends \"\" ? never : T): void {\n        // Forces specific Lusift content to appear for the current user by passing in the ID.\n        if (!this.content) {\n            return error(`Content not set, pass valid content data to setContent()`);\n        }\n        // see if content exists for contentID\n        if (!this.content[contentID]) {\n            return error(`Content with id of ${contentID} doesn't exist`);\n        }\n        // when there's an active guide\n        if (this.activeGuide) {\n            const { instance, id } = this.activeGuide;\n\n            if (id === contentID) {\n                this.activeGuide.instance.reRenderStepElements();\n                return error(`${contentID} is already active`);\n            } else {\n                instance.close();\n            }\n        }\n\n        window.setTimeout(() => {\n            // HACK:\n            // There's a noticeable delay in react component appearing as bodyContent properties\n            // on page load, so we arbitrarily wait 500ms before running this section\n            const newGuideInstance = new Guide(contentID);\n            this.activeGuide = {\n                id: contentID,\n                instance: newGuideInstance,\n            };\n            newGuideInstance.start();\n            this.prepareHooks();\n        }, 500);\n    }\n\n    private prepareHooks(): void {\n        // attach active content's navigation methods to Lusift instance\n        const { instance: activeGuideInstance, id: activeGuideID } = this.activeGuide!;\n        this.next = activeGuideInstance.nextStep.bind(activeGuideInstance);\n        this.prev = activeGuideInstance.prevStep.bind(activeGuideInstance);\n        this.close = activeGuideInstance.close.bind(activeGuideInstance);\n        this.goto = activeGuideInstance.setStep.bind(activeGuideInstance);\n\n        const { onNext, onPrev, onClose } = this.content![activeGuideID].data;\n        this.onNext = onNext;\n        this.onPrev = onPrev;\n        this.onClose = onClose;\n    }\n\n    public setGlobalStyle(styleText: string): void {\n        if (typeof styleText !== \"string\") {\n            return error(\"Invalid style passed to setGlobalStyle()\");\n        }\n        let customStyle = document.querySelector(\"style[lusift-custom-css]\");\n        if (!customStyle) {\n            return error(`Style tag for custom-css not found. Report to Lusift\\'s github.`);\n        }\n        customStyle.textContent = styleText;\n    }\n\n    public getTrackingState(): TrackingState | null {\n        if (this.activeGuide) {\n            return loadState()[this.activeGuide.id].trackingState;\n        } else {\n            warn(\"No active guide\");\n            return null;\n        }\n    }\n\n    public devShowStep(guideID: string, stepNumber: number): void {\n        // dev mode: to be used to develop/style step elements\n        // if there is some other content active already, refuse to show dev mode\n        if (this.activeGuide) {\n            return warn(\n                `Can\\'t enable dev mode because a ` + `guide is active using showContent()`,\n            );\n        }\n        if (!this.content) {\n            return warn(\n                `Content not set, pass valid content object ` +\n                    `to setContent() before running devShowStep()`,\n            );\n        }\n        this.next =\n            this.prev =\n            this.close =\n            this.showContent =\n                function () {\n                    error(`Can't run this method in dev mode`);\n                };\n\n        if (this.content[guideID]) {\n            const { steps } = this.content[guideID].data;\n            const { target, type } = steps[stepNumber];\n\n            if (!doesStepMatchDisplayCriteria({ target, type })) {\n                return warn(\n                    `Display criteria for step do not match. Navigate to ` +\n                        `the right target page and make sure that the target ` +\n                        `element is in the visible screen, then reload page.`,\n                );\n            }\n\n            if (steps[stepNumber]) {\n                startStepInstance(steps[stepNumber], guideID);\n                log(\n                    `%c Showing step ${stepNumber} of ${guideID} in dev mode`,\n                    \"background: #222; color: #bada55\",\n                );\n            } else {\n                error(`Guide '${guideID}' doesn't have a step ${stepNumber}`);\n            }\n        } else {\n            error(`Guide with id '${guideID}' doesn't exist`);\n        }\n    }\n}\n\nexport default new Lusift();\n","import { window, document } from \"global\";\nimport lusiftDefaultCSS from \"./style/lusift.css\";\nimport {\n    PRIMARY_COLOR,\n    DEFAULT_MODAL_BORDER_RADIUS,\n    DEFAULT_TOOLTIP_BORDER_RADIUS,\n    DEFAULT_PROGRESS_BAR_HEIGHT,\n} from \"../common/constants\";\n\n// Inject default lusift global styles\n\nconst getDynamicDefaultCSS = () => {\n    // TODO: Have these properties be in lusift.css too\n    return `\\n\n    /* from dynamic javascript variables*/\n\n    .lusift-progress {\n      height: ${DEFAULT_PROGRESS_BAR_HEIGHT};\n    }\n    .lusift-progress::-webkit-progress-bar {\n      border-radius: ${DEFAULT_TOOLTIP_BORDER_RADIUS}; /*border-radius of tooltip*/\n    }\n    .modal .lusift-progress::-webkit-progress-bar {\n      border-radius: ${DEFAULT_MODAL_BORDER_RADIUS}; /*border-radius of modal*/\n    }\n    .lusift-progress::-webkit-progress-value {\n      background-color: ${PRIMARY_COLOR}; /*color of progress bar*/\n    }\n  `;\n};\n\nexport default () => {\n    if (typeof document === \"undefined\") return;\n\n    const lusiftDefault = document.createElement(\"style\");\n    lusiftDefault.type = \"text/css\";\n    lusiftDefault.setAttribute(\"lusift-default\", \"\");\n    lusiftDefault.textContent = lusiftDefaultCSS;\n    lusiftDefault.textContent += getDynamicDefaultCSS();\n\n    const lusiftCustom = document.createElement(\"style\");\n    lusiftCustom.type = \"text/css\";\n    lusiftCustom.setAttribute(\"lusift-custom\", \"\");\n\n    const customStyle = document.createElement(\"style\");\n    customStyle.type = \"text/css\";\n    customStyle.setAttribute(\"lusift-custom-css\", \"\");\n\n    const docFrag = document.createDocumentFragment();\n    // append all style elements to the document fragment\n    docFrag.appendChild(lusiftDefault);\n    docFrag.appendChild(lusiftCustom);\n    docFrag.appendChild(customStyle);\n    // append the document fragment to the document\n    document.head.appendChild(docFrag);\n};\n","import React from \"react\";\nimport Lusift from \"../../lusift\";\nimport { window, document } from \"global\";\nimport ReactDOM from \"react-dom\";\nimport { Content } from \"../../common/types\";\nimport { vanillaRender } from \"../../common/utils\";\nimport { isReactComponent, isReactClassComponent } from \"../../common/utils/isOfType\";\n\nconst reactRender = (BodyComponent: any, targetPath: string, callback?: Function) => {\n    const target = document.querySelector(targetPath);\n    ReactDOM.render(<BodyComponent />, target);\n    if (callback) callback();\n};\n\nconst renderBodyContent = (body: any, targetPath: string, callback?: Function): void => {\n    if (isReactComponent(body)) {\n        reactRender(body, targetPath, callback);\n    } else {\n        vanillaRender(body, targetPath, callback);\n    }\n};\n\nif (typeof window !== \"undefined\") {\n    window.addEventListener(\"error\", e => console.log(e), true);\n    Lusift.render = renderBodyContent;\n    window[\"Lusift\"] = Lusift;\n}\n\nexport { Lusift as default, Content as LusiftContent };\n","const vanillaRender = (elementToRender: string, targetPath: string, callback?: Function) => {\n    const target = document.querySelector(targetPath);\n    target!.innerHTML = elementToRender;\n    if (callback) callback();\n};\n\nexport default vanillaRender;\n"],"names":["window_1","window","global","self","log","console","warn","message","_i","args","messagePrefix","error","loadState","serialisedState","localStorage","getItem","JSON","parse","err","saveState","state","stringify","setItem","isObject","item","Object","constructor","isObjectOrUndefined","object","isOfTypeTooltipData","placements","forEach","p","push","arrow","offset","length","actions","includes","placement","contentBody","progressOn","backdrop","isOfTypeStep","index","type","elementSelectorExists","elementSelector","path","comparator","value","isOfTypeTarget","target","data","styleProps","isOfTypeTooltip","isOfTypeHotspot","closeButton","isOfTypeModal","isOfTypeContent","itemTypes","values","every","id","name","description","steps","hasOwnProperty","isOfTypeGuide","mergeObjects","obj1","obj2","assign","keys","key","e","styleObjectToString","stylesString","replace","m","toLowerCase","getStepUID","_a","guideID","getElementPosition","element","documentElement","document","body","scrollTop","pageYOffset","scrollLeft","pageXOffset","elementRect","getBoundingClientRect","top","left","right","width","bottom","height","changeAsyncStepStatus","stepIndex","toOpen","exisitingState","activeGuideID","Lusift","activeGuide","trackingState","asyncSteps","roundNum","decimalPlaces","Math","round","Number","EPSILON","pow","doesStepPathMatch","targetPath","str","location","currentPath","endsWith","startsWith","RegExp","test","doesStepMatchesDisplayCriteria","criteriaMatch","Boolean","querySelector","MODAL_OVERLAY_CLASS","DEFAULT_TOOLTIP_BORDER_RADIUS","DEFAULT_MODAL_BORDER_RADIUS","PRIMARY_COLOR","renderProgressBar","currentGuide","currentStep","currentStepIndex","progressBarData","progressBar","_b","color","borderRadius","syncSteps","filter","step","async","progress","findIndex","renderCloseXButton","stepType","disabled","module","t","i","o","setAttribute","n","style","visibility","r","createElement","s","box","content","a","_instance","getAttribute","props","onHide","transitionDuration","setState","isShown","onShow","l","d","__awaiter","c","u","h","f","g","b","v","w","x","y","_","E","S","O","k","C","T","H","D","L","A","z","j","P","R","U","q","M","N","I","W","V","F","X","B","G","__generator","this","J","label","toFlip","toShift","hideOnReferenceHidden","hideOnTooltipEscape","arrowSizeScale","resetPlacementOnUpdate","showOnCreate","middleware","__spreadArray","mainAxis","crossAxis","autoPlacement","shift","padding","flip","fallbackPlacements","fallbackStrategy","size","apply","reference","floating","hide","computePosition","sent","middlewareData","referenceHidden","escaped","scrollIntoView","behavior","block","inline","centerOffset","split","fui","allowHTML","hideOnClick","onClickOutside","onStateChange","onRemove","maxWidth","updateDebounce","zIndex","updateOnEvents","isRemoved","updateListenerCleanup","toHideTooltip","clickHandler","tooltipElement","contains","textContent","head","appendChild","prototype","hookEventListeners","debouncedUpdate","update","bind","clearTimeout","setTimeout","autoUpdate","addEventListener","removeEventListener","updateTransitionDuration","create","className","innerHTML","innerText","getState","__assign","show","remove","require$$0","require$$1","createTooltip","floatingTooltip","renderTooltip","uid","navSection","nextButton","prevButton","dismissLink","renderNavButtons","tooltipInstance","bodyContent","render","text","areNumbersEqual","num1","num2","num1Precision","toString","substring","indexOf","num2Precision","min","arr","map","targetSelector","stageGap","opacity","obj","stagedTargetClass","entries","undefined","createOverlay","focusTrap","addFocusTrap","escToClose","clickOutsideToClose","Backdrop","toStopOverlay","removeOverlay","targetElement","clientHeight","clientWidth","documentWidth","max","documentHeight","scrollHeight","offsetHeight","getDocumentDimensions","targetPosition","hTop","hBottom","vLeft","vRight","overlayStyle","background","transition","position","border","cssText","el","classList","add","_this","overlaySelectorClass","hTopHeight","hTopWidth","hBottomHeight","overlaySumWidth","overlaySumHeight","resetBackdrop","querySelectorAll","deactivate","defaultBackdropData","nextOnOverlayClick","defaultOffset","tooltipArrowSizeScale","defaultToolipActions","eventType","consolidateActions","Tooltip","fuitInstance","removeAllEventListeners","backdropInstance","isTooltipShown","Array","from","getElementsByClassName","addEventListenerToTarget","_c","_d","instance","addBackdrop","_e","debouncedBackdropReset_1","debounce","_x","backdropAutoUpdateCleanup","ancestorScroll","ancestorResize","elementResize","method","next","prev","getListenerFromMethod","targetsAndEventListeners","addModal","escEventListener","overlayClickEventListener","Modal","keyCode","nodeName","close","modalOverlay","modal","display","justifyContent","alignItems","lusiftWrapper","createModal","overlayElement","getElementById","tip","div","createBeaconElement","beaconData","beaconID","toggleTooltip","beaconContainer","beaconElement","beaconEventReceiver","tipID","addBeacon","createTip","Hotspot","targetTop","targetLeft","targetWidth","targetHeight","beacon","beaconPlacement","parentElement","positionBeacon","updateBeaconPosition","isDevMode","removeMethod","removeAndCloseAsync","createHotspotTooltip","event","debouncedUpdateBeaconPosition","beaconAutoUpdateCleanup","activeHotspot","hideTooltip","removeResizeObservers","startStepInstance","stepData","activeStepInstance","candidateSelectors","candidateSelector","join","matches","Element","msMatchesSelector","webkitMatchesSelector","getTabindex","node","tabindexAttr","parseInt","isNaN","contentEditable","isContentEditable","tabIndex","sortOrderedTabbables","documentOrder","isInput","tagName","isNonTabbableRadio","isRadio","radioSet","radioScope","form","ownerDocument","queryRadios","CSS","escape","checked","nodes","getCheckedRadio","isTabbableRadio","isNodeMatchingSelectorFocusable","options","isHiddenInput","displayCheck","getComputedStyle","nodeUnderDetails","call","_node$getBoundingClie","isHidden","slice","children","some","child","isDetailsWithSummary","parentNode","isDisabledFromFieldset","isNodeMatchingSelectorTabbable","tabbable","regularTabbables","orderedTabbables","candidates","includeContainer","unshift","getCandidates","candidate","candidateTabindex","sort","concat","focusableCandidateSelector","isFocusable","Error","ownKeys","enumerableOnly","getOwnPropertySymbols","symbols","sym","getOwnPropertyDescriptor","enumerable","_defineProperty","defineProperty","configurable","writable","trapQueue","activeFocusTraps","activateTrap","trap","activeTrap","pause","trapIndex","splice","deactivateTrap","unpause","delay","fn","idx","valueOrHandler","_len","arguments","params","_key","getActualTarget","shadowRoot","composedPath","createFocusTrap","elements","userOptions","doc","config","source","getOwnPropertyDescriptors","defineProperties","_objectSpread2","returnFocusOnDeactivate","escapeDeactivates","delayInitialFocus","containers","tabbableGroups","nodeFocusedBeforeActivation","mostRecentlyFocusedNode","active","paused","delayInitialFocusTimer","getOption","configOverrideOptions","optionName","configOptionName","containersContain","container","getNodeForOption","optionValue","_len2","_key2","getInitialFocusNode","activeElement","firstTabbableGroup","firstTabbableNode","updateTabbableNodes","tabbableNodes","lastTabbableNode","group","tryFocus","focus","preventScroll","select","isSelectableInput","getReturnFocusNode","previousActiveElement","checkPointerDown","clickOutsideDeactivates","returnFocus","allowOutsideClick","preventDefault","checkFocusIn","targetContained","Document","stopImmediatePropagation","checkKey","isEscapeEvent","isTabEvent","destinationNode","containerIndex","_ref","shiftKey","startOfGroupIndex","_ref2","destinationGroupIndex","lastOfGroupIndex","_ref3","_destinationGroupIndex","checkTab","checkClick","addListeners","capture","passive","removeListeners","activate","activateOptions","onActivate","onPostActivate","checkCanFocusTrap","finishActivation","then","deactivateOptions","onDeactivate","onPostDeactivate","checkCanReturnFocus","finishDeactivation","updateContainerElements","containerElements","elementsAsArray","ft","focusTrap.createFocusTrap","ms","arg","timeout","localGuideState","guideData","newTrackingState","generateNewTrackingState","setTrackingState","Guide","finished","prematurelyClosed","enabled","getTrackingState","removeIllegalSteps","attemptToStartAsyncSteps","attemptToShowActiveStep","activeSteps","stepInstance","removeAllActiveSteps","start","isAsyncStep","displayCriteriaMatches","doesStepMatchDisplayCriteria","isStepAlreadyActive","existingState","newStepNum","onClose","disable","find","newStep","closeCurrentStep","setStep","onNext","onPrev","HASH_UNDEFINED","MAX_SAFE_INTEGER","argsTag","arrayTag","boolTag","dateTag","errorTag","funcTag","mapTag","numberTag","objectTag","promiseTag","regexpTag","setTag","stringTag","symbolTag","weakMapTag","arrayBufferTag","dataViewTag","reIsHostCtor","reIsUint","typedArrayTags","freeGlobal","freeSelf","root","Function","freeExports","exports","nodeType","freeModule","moduleExports","freeProcess","process","nodeUtil","binding","nodeIsTypedArray","isTypedArray","arraySome","array","predicate","mapToArray","result","setToArray","set","func","transform","arrayProto","funcProto","objectProto","coreJsData","funcToString","maskSrcKey","exec","IE_PROTO","nativeObjectToString","reIsNative","Buffer","Symbol","Uint8Array","propertyIsEnumerable","symToStringTag","toStringTag","nativeGetSymbols","nativeIsBuffer","isBuffer","nativeKeys","DataView","getNative","Map","Promise","Set","WeakMap","nativeCreate","dataViewCtorString","toSource","mapCtorString","promiseCtorString","setCtorString","weakMapCtorString","symbolProto","symbolValueOf","valueOf","Hash","clear","entry","ListCache","MapCache","SetCache","__data__","Stack","arrayLikeKeys","inherited","isArr","isArray","isArg","isArguments","isBuff","isType","skipIndexes","iteratee","baseTimes","String","isIndex","assocIndexOf","eq","baseGetTag","isOwn","tag","unmasked","getRawTag","objectToString","baseIsArguments","isObjectLike","baseIsEqual","other","bitmask","customizer","stack","equalFunc","objIsArr","othIsArr","objTag","getTag","othTag","objIsObj","othIsObj","isSameTag","equalArrays","byteLength","byteOffset","buffer","convert","isPartial","stacked","get","equalByTag","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","objProps","getAllKeys","objLength","othLength","skipCtor","objValue","othValue","compared","objCtor","othCtor","equalObjects","baseIsEqualDeep","baseIsNative","isMasked","isFunction","baseKeys","Ctor","proto","arrLength","seen","arrValue","othIndex","has","keysFunc","symbolsFunc","arrayPush","baseGetAllKeys","getSymbols","getMapData","getValue","pop","hash","string","pairs","LARGE_ARRAY_SIZE","resIndex","arrayFilter","symbol","ArrayBuffer","resolve","ctorString","isLength","baseUnary","noOp","lusiftDefault","lusiftCustom","customStyle","docFrag","createDocumentFragment","addDefaultCSS","localData","enabledGuideID","showContent","localGuideData","guideDataWithoutHooks","isEqual","stateToSave","contentWithoutBodyContent","doNotResetTrackerOnContentChange","stepsWithoutBodyContent","hasGuideDataChanged","dataOfActiveGuideChanged","contentIDExists","reconcileContentWithLocalState","showEnabledContent","contentID","reRenderStepElements","newGuideInstance","prepareHooks","activeGuideInstance","nextStep","prevStep","goto","styleText","stepNumber","callback","BodyComponent","ReactDOM","React","reactRender","elementToRender","vanillaRender"],"mappings":"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"}