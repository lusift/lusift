{"version":3,"file":"index.js","sources":["../../../node_modules/global/window.js","../../../src/common/logger.ts","../../../src/common/store/localStorage.ts","../../../src/common/utils/isOfType/index.ts","../../../src/common/utils/mergeObjects.ts","../../../src/common/utils/styleObjectToString.ts","../../../src/common/utils/getStepUID.ts","../../../src/common/utils/getElementPosition.ts","../../../src/common/utils/changeAsyncStepStatus.ts","../../../src/common/utils/roundNum.ts","../../../src/common/utils/doesStepMatchDisplayCriteria.ts","../../../src/common/utils/doesStringMatchRegex.ts","../../../node_modules/tabbable/dist/index.esm.js","../../../node_modules/focus-trap/dist/focus-trap.esm.js","../../../src/common/utils/addFocusTrap.ts","../../../src/common/utils/debounce.ts","../../../src/common/constants/index.ts","../../../src/common/progressBar/renderProgressBar.ts","../../../src/common/closeXButton/renderCloseXButton.ts","../../../../floating-ui-tooltip/dist/index.js","../../../src/common/createTooltip.ts","../../../src/tooltip/createTooltip.ts","../../../src/tooltip/defaultTooltipActions.ts","../../../src/backdrop/Backdrop.ts","../../../src/common/utils/dimensions.ts","../../../src/tooltip/Tooltip.ts","../../../src/modal/createModal.ts","../../../src/modal/Modal.ts","../../../src/hotspot/createHotspotTooltip.ts","../../../src/hotspot/beacon-element.ts","../../../src/hotspot/Hotspot.ts","../../../src/lusift/startStepInstance.ts","../../../src/lusift/Guide.ts","../../../src/lusift/Lusift.ts","../../../src/lusift/addDefaultCSS.ts","../../../src/lusift/index.ts","../../../src/react/src/index.tsx","../../../src/common/utils/vanillaRender.ts"],"sourcesContent":["var win;\n\nif (typeof window !== \"undefined\") {\n    win = window;\n} else if (typeof global !== \"undefined\") {\n    win = global;\n} else if (typeof self !== \"undefined\"){\n    win = self;\n} else {\n    win = {};\n}\n\nmodule.exports = win;\n","const messagePrefix = \"Lusift:\";\n\n/* export function log(message: string, ...args: any[]) {\n    console.log(`${messagePrefix} ${message}`, ...args);\n} */\nexport const log = console.log;\n\nexport function warn(message: string, ...args: any[]) {\n    console.warn(`${messagePrefix} ${message}`, ...args);\n}\n\nexport function error(message: string, ...args: any[]) {\n    console.error(`${messagePrefix} ${message}`, ...args);\n}\n","import { window, document } from \"global\";\nimport { error } from \"../logger\";\n\nif (!window) {\n    error(\"window is undefined\");\n}\n\nconst STATE_ITEM_NAME = \"lusift_state\";\n\n/**\n * This function checks if the lusift_state is saved in localStorage\n */\nexport const loadState = () => {\n    try {\n        // Load the data saved in localStorage, against the key 'lusift_state'\n        const serialisedState = window.localStorage.getItem(STATE_ITEM_NAME);\n\n        // Passing undefined to createStore will result in our app getting the default state\n        // If no data is saved, return undefined\n        if (!serialisedState) return undefined;\n\n        // De-serialise the saved state, and return it.\n        return JSON.parse(serialisedState);\n    } catch (err) {\n        // Return undefined if localStorage is not available,\n        // or data could not be de-serialised,\n        // or there was some other error\n        return undefined;\n    }\n};\n\n\n/**\n * This function accepts the app state, and saves it to localStorage\n * @param state\n */\n\nexport const saveState = state => {\n    try {\n        // Convert the state to a JSON string\n        const serialisedState = JSON.stringify(state);\n\n        // Save the serialised state to localStorage against the key 'lusift_state'\n        window.localStorage.setItem(STATE_ITEM_NAME, serialisedState);\n    } catch (err) {\n        // Log errors here, or ignore\n    }\n};\n\n\nexport const setDefaultState = (): void => {\n    saveState({});\n}\n","import { GuideType, Content } from \"../../types\";\nimport { log } from \"../../logger\";\n\nexport function isObject(item: any): boolean {\n    return item instanceof Object && item.constructor === Object;\n}\n\nexport function isObjectOrUndefined(object: any): boolean {\n    return isObject(object) || typeof object === \"undefined\";\n}\n\nexport function isOfTypeTooltipData(object: any): boolean {\n    const placements = [\"bottom\", \"top\", \"right\", \"left\", \"auto\"];\n    placements.forEach(p => {\n        placements.push(`${p}-start`);\n        placements.push(`${p}-end`);\n    });\n\n    return (\n        isObject(object) &&\n        typeof object.arrow === \"boolean\" &&\n        (!object.offset || (object.offset instanceof Object && object.offset.length === 2)) &&\n        (!object.actions || isObject(object.actions)) &&\n        placements.includes(object.placement) &&\n        (typeof object.contentBody === \"string\" ||\n            (!object.contentBody && typeof object.contentBody !== \"boolean\")) &&\n        // (typeof object.contentBody === 'string' && !!object.contentBody) &&\n        isObjectOrUndefined(object.progressOn) &&\n        isObjectOrUndefined(object.backdrop)\n    );\n}\n\nexport function isOfTypeTarget(object: any, type: string): boolean {\n    const comparators = [\"is\", \"contains\", \"endsWith\", \"startsWith\"];\n    const elementSelectorExists =\n        typeof object.elementSelector === \"string\" && !!object.elementSelector;\n\n    return (\n        isObject(object) &&\n        (elementSelectorExists || type === \"modal\") && //validate element selector\n        isObject(object.path) &&\n        typeof object.path.comparator === \"string\" &&\n        comparators.includes(object.path.comparator) &&\n        typeof object.path.value === \"string\"\n    ); //validate path\n}\n\nexport function isOfTypeTooltipActions(object: any): boolean {\n    return (\n        isObject(object) &&\n        Object.entries(object).every(prop => isObject(prop)) &&\n        isObjectOrUndefined(object.closeButton.styleProps) &&\n        isObjectOrUndefined(object.navSection.styleProps) &&\n        isObjectOrUndefined(object.navSection.nextButton) &&\n        isObjectOrUndefined(object.navSection.nextButton.styleProps) &&\n        isObjectOrUndefined(object.navSection.prevButton) &&\n        isObjectOrUndefined(object.navSection.dissmissLink) &&\n        isObjectOrUndefined(object.navSection.dissmissLink.styleProps)\n    );\n}\n\nexport function isOfTypeTooltip(object: any): boolean {\n    return (\n        isOfTypeTooltipData(object.data) &&\n        isObjectOrUndefined(object.styleProps) &&\n        object.type === \"tooltip\" &&\n        isOfTypeTooltipData(object.data)\n    );\n}\n\nexport function isOfTypeModal(object: any): boolean {\n    return (\n        object.type === \"modal\" && isObject(object.data) && isObjectOrUndefined(object.closeButton)\n    );\n}\n\nexport function isOfTypeHotspot(object: any): boolean {\n    return object.type === \"hotspot\";\n}\n\nexport function isOfTypeStep(object: any): boolean {\n    const stepTypes = [\"tooltip\", \"hotspot\", \"modal\"];\n\n    return (\n        isObject(object) &&\n        typeof object.index === \"number\" &&\n        stepTypes.includes(object.type) &&\n        // target\n        isOfTypeTarget(object.target, object.type) &&\n        (isOfTypeTooltip(object) || isOfTypeHotspot(object) || isOfTypeModal(object))\n    );\n}\n\nexport function isOfTypeGuide(object: any): boolean {\n    return (\n        isObject(object) &&\n        typeof object.id === \"string\" &&\n        !!object.id &&\n        typeof object.name === \"string\" &&\n        typeof object.description === \"string\" &&\n        object.steps instanceof Object &&\n        object.steps.hasOwnProperty(\"length\") &&\n        object.steps.every(isOfTypeStep)\n    );\n}\n\nexport function isOfTypeContent(object: Content): boolean {\n    const itemTypes = [\"guide\"];\n    return (\n        isObject(object) &&\n        Object.values(object).every((item: any) => {\n            return typeof itemTypes.includes(item.type) && isOfTypeGuide(item.data);\n        })\n    );\n}\n\nexport function isOfTypeHtmlElement(element): boolean {\n    log(\"bodyContent\");\n    if (typeof element !== \"object\") return false;\n    return (\n        element.constructor.name.startsWith(\"HTML\") && element.constructor.name.endsWith(\"Element\")\n    );\n}\n\nexport const isReactComponent = (component: any): boolean => {\n    return typeof component === \"function\";\n};\n\nexport const isReactClassComponent = (component: any): boolean => {\n    // there's component.prototype.isReactComponent too\n    return isReactComponent(component) && typeof component.prototype.render === \"function\";\n};\n","import { isObject } from \"./isOfType\";\n/*\n * Deep merge properties of two objects\n * replace with lodash.merge if insufficient\n * or check this thread:\n * https://stackoverflow.com/questions/27936772/how-to-deep-merge-instead-of-shallow-merge\n */\nfunction mergeObjects(obj1: Object, obj2: Object): any {\n    obj1 = Object.assign({}, obj1);\n    obj2 = Object.assign({}, obj2);\n\n    Object.keys(obj2).forEach(key => {\n        try {\n            // Property in destination object set; update its value.\n            if (isObject(obj2[key])) {\n                obj1[key] = mergeObjects(obj1[key], obj2[key]);\n            } else {\n                obj1[key] = obj2[key];\n            }\n        } catch (e) {\n            // Property in destination object not set; create it and set its value.\n            obj1[key] = obj2[key];\n        }\n    });\n    return obj1;\n}\n\nexport default mergeObjects;\n","const camelCaseToHyphenCase = (camelCaseString: string) => {\n    return camelCaseString.replace(/[A-Z]/g, m => \"-\" + m.toLowerCase());\n};\n\nconst styleObjectToString = (styleProps: Object) => {\n    // convert and layout styleProps into string literal\n    let stylesString = \"\";\n    Object.keys(styleProps).forEach(key => {\n        stylesString += `${camelCaseToHyphenCase(key)}: ${styleProps[key]} !important;\\n`;\n    });\n    return stylesString;\n};\n\nexport default styleObjectToString;\n","const getStepUID = ({ guideID, index, type }): string => {\n    return `lusift--g-${guideID}--${type}-${index}`;\n};\nexport default getStepUID;\n","import { window, document } from \"global\";\nimport { ElementPosition } from \"../types\";\n\nconst getElementPosition = (element: HTMLElement): ElementPosition => {\n    const { documentElement, body } = document;\n\n    const scrollTop = window.pageYOffset || documentElement.scrollTop || body.scrollTop;\n    const scrollLeft = window.pageXOffset || documentElement.scrollLeft || body.scrollLeft;\n    const elementRect = element.getBoundingClientRect();\n\n    const position: ElementPosition = {\n        top: elementRect.top + scrollTop,\n        left: elementRect.left + scrollLeft,\n        right: elementRect.left + scrollLeft + elementRect.width,\n        bottom: elementRect.top + scrollTop + elementRect.height,\n        height: elementRect.height,\n        width: elementRect.width,\n    };\n    return position;\n};\n\nexport default getElementPosition;\n","import { window } from \"global\";\nimport { loadState, saveState } from \"../store\";\n\nconst changeAsyncStepStatus = (stepIndex: number, toOpen: boolean): void => {\n    const exisitingState = loadState();\n    const { id: activeGuideID } = window.Lusift.getActiveGuide();\n    saveState({\n        ...exisitingState,\n        [activeGuideID]: {\n            ...exisitingState[activeGuideID],\n            trackingState: {\n                ...exisitingState[activeGuideID].trackingState,\n                asyncSteps: {\n                    ...exisitingState[activeGuideID].trackingState.asyncSteps,\n                    [stepIndex]: {\n                        toOpen,\n                    },\n                },\n            },\n        },\n    });\n};\n\nexport default changeAsyncStepStatus;\n","const roundNum = (value: number, decimalPlaces: number = 2): number => {\n    return (\n        Math.round((value + Number.EPSILON) * Math.pow(10, decimalPlaces)) /\n        Math.pow(10, decimalPlaces)\n    );\n};\nexport default roundNum;\n","import { window, document } from \"global\";\nimport doesStringMatchRegex from \"./doesStringMatchRegex\";\n\nconst doesStepPathMatch = (targetPath): boolean => {\n    // is, endsWith, startsWith, contains, regex\n    const { value, comparator } = targetPath;\n    const { pathname, hash } = window.location;\n    const currentPath = pathname + hash;\n\n    switch (comparator) {\n        case \"is\":\n            return currentPath === value;\n        case \"contains\":\n            return currentPath.includes(value);\n        case \"endsWith\":\n            return currentPath.endsWith(value);\n        case \"startWith\":\n            return currentPath.startsWith(value);\n        case \"regex\":\n            return doesStringMatchRegex(currentPath, value);\n        default:\n            return false;\n    }\n};\n\nconst isStepElementFound = (elementSelector: string): boolean => {\n    /* log(this.guideData);\n     log('checking if element exists') */\n    return Boolean(document.querySelector(elementSelector));\n};\n\nconst doesStepMatchesDisplayCriteria = ({ target, type }): boolean => {\n    let criteriaMatch = doesStepPathMatch(target.path);\n    if (type !== \"modal\") {\n        criteriaMatch = criteriaMatch && isStepElementFound(target.elementSelector);\n    }\n    return criteriaMatch;\n};\n\nexport default doesStepMatchesDisplayCriteria;\n","const doesStringMatchRegex = (str: string, regex: string): boolean => {\n    // see if regex pattern matches url string (case insensitive)\n    // e.g. '/.+/dashboard' matches '/lusift/dashboard'\n    const regexPattern = new RegExp(regex, \"i\");\n    return regexPattern.test(str);\n};\nexport default doesStringMatchRegex;\n","/*!\n* tabbable 5.2.1\n* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE\n*/\nvar candidateSelectors = ['input', 'select', 'textarea', 'a[href]', 'button', '[tabindex]', 'audio[controls]', 'video[controls]', '[contenteditable]:not([contenteditable=\"false\"])', 'details>summary:first-of-type', 'details'];\nvar candidateSelector = /* #__PURE__ */candidateSelectors.join(',');\nvar matches = typeof Element === 'undefined' ? function () {} : Element.prototype.matches || Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;\n\nvar getCandidates = function getCandidates(el, includeContainer, filter) {\n  var candidates = Array.prototype.slice.apply(el.querySelectorAll(candidateSelector));\n\n  if (includeContainer && matches.call(el, candidateSelector)) {\n    candidates.unshift(el);\n  }\n\n  candidates = candidates.filter(filter);\n  return candidates;\n};\n\nvar isContentEditable = function isContentEditable(node) {\n  return node.contentEditable === 'true';\n};\n\nvar getTabindex = function getTabindex(node) {\n  var tabindexAttr = parseInt(node.getAttribute('tabindex'), 10);\n\n  if (!isNaN(tabindexAttr)) {\n    return tabindexAttr;\n  } // Browsers do not return `tabIndex` correctly for contentEditable nodes;\n  // so if they don't have a tabindex attribute specifically set, assume it's 0.\n\n\n  if (isContentEditable(node)) {\n    return 0;\n  } // in Chrome, <details/>, <audio controls/> and <video controls/> elements get a default\n  //  `tabIndex` of -1 when the 'tabindex' attribute isn't specified in the DOM,\n  //  yet they are still part of the regular tab order; in FF, they get a default\n  //  `tabIndex` of 0; since Chrome still puts those elements in the regular tab\n  //  order, consider their tab index to be 0.\n\n\n  if ((node.nodeName === 'AUDIO' || node.nodeName === 'VIDEO' || node.nodeName === 'DETAILS') && node.getAttribute('tabindex') === null) {\n    return 0;\n  }\n\n  return node.tabIndex;\n};\n\nvar sortOrderedTabbables = function sortOrderedTabbables(a, b) {\n  return a.tabIndex === b.tabIndex ? a.documentOrder - b.documentOrder : a.tabIndex - b.tabIndex;\n};\n\nvar isInput = function isInput(node) {\n  return node.tagName === 'INPUT';\n};\n\nvar isHiddenInput = function isHiddenInput(node) {\n  return isInput(node) && node.type === 'hidden';\n};\n\nvar isDetailsWithSummary = function isDetailsWithSummary(node) {\n  var r = node.tagName === 'DETAILS' && Array.prototype.slice.apply(node.children).some(function (child) {\n    return child.tagName === 'SUMMARY';\n  });\n  return r;\n};\n\nvar getCheckedRadio = function getCheckedRadio(nodes, form) {\n  for (var i = 0; i < nodes.length; i++) {\n    if (nodes[i].checked && nodes[i].form === form) {\n      return nodes[i];\n    }\n  }\n};\n\nvar isTabbableRadio = function isTabbableRadio(node) {\n  if (!node.name) {\n    return true;\n  }\n\n  var radioScope = node.form || node.ownerDocument;\n\n  var queryRadios = function queryRadios(name) {\n    return radioScope.querySelectorAll('input[type=\"radio\"][name=\"' + name + '\"]');\n  };\n\n  var radioSet;\n\n  if (typeof window !== 'undefined' && typeof window.CSS !== 'undefined' && typeof window.CSS.escape === 'function') {\n    radioSet = queryRadios(window.CSS.escape(node.name));\n  } else {\n    try {\n      radioSet = queryRadios(node.name);\n    } catch (err) {\n      // eslint-disable-next-line no-console\n      console.error('Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s', err.message);\n      return false;\n    }\n  }\n\n  var checked = getCheckedRadio(radioSet, node.form);\n  return !checked || checked === node;\n};\n\nvar isRadio = function isRadio(node) {\n  return isInput(node) && node.type === 'radio';\n};\n\nvar isNonTabbableRadio = function isNonTabbableRadio(node) {\n  return isRadio(node) && !isTabbableRadio(node);\n};\n\nvar isHidden = function isHidden(node, displayCheck) {\n  if (getComputedStyle(node).visibility === 'hidden') {\n    return true;\n  }\n\n  var isDirectSummary = matches.call(node, 'details>summary:first-of-type');\n  var nodeUnderDetails = isDirectSummary ? node.parentElement : node;\n\n  if (matches.call(nodeUnderDetails, 'details:not([open]) *')) {\n    return true;\n  }\n\n  if (!displayCheck || displayCheck === 'full') {\n    while (node) {\n      if (getComputedStyle(node).display === 'none') {\n        return true;\n      }\n\n      node = node.parentElement;\n    }\n  } else if (displayCheck === 'non-zero-area') {\n    var _node$getBoundingClie = node.getBoundingClientRect(),\n        width = _node$getBoundingClie.width,\n        height = _node$getBoundingClie.height;\n\n    return width === 0 && height === 0;\n  }\n\n  return false;\n}; // form fields (nested) inside a disabled fieldset are not focusable/tabbable\n//  unless they are in the _first_ <legend> element of the top-most disabled\n//  fieldset\n\n\nvar isDisabledFromFieldset = function isDisabledFromFieldset(node) {\n  if (isInput(node) || node.tagName === 'SELECT' || node.tagName === 'TEXTAREA' || node.tagName === 'BUTTON') {\n    var parentNode = node.parentElement;\n\n    while (parentNode) {\n      if (parentNode.tagName === 'FIELDSET' && parentNode.disabled) {\n        // look for the first <legend> as an immediate child of the disabled\n        //  <fieldset>: if the node is in that legend, it'll be enabled even\n        //  though the fieldset is disabled; otherwise, the node is in a\n        //  secondary/subsequent legend, or somewhere else within the fieldset\n        //  (however deep nested) and it'll be disabled\n        for (var i = 0; i < parentNode.children.length; i++) {\n          var child = parentNode.children.item(i);\n\n          if (child.tagName === 'LEGEND') {\n            if (child.contains(node)) {\n              return false;\n            } // the node isn't in the first legend (in doc order), so no matter\n            //  where it is now, it'll be disabled\n\n\n            return true;\n          }\n        } // the node isn't in a legend, so no matter where it is now, it'll be disabled\n\n\n        return true;\n      }\n\n      parentNode = parentNode.parentElement;\n    }\n  } // else, node's tabbable/focusable state should not be affected by a fieldset's\n  //  enabled/disabled state\n\n\n  return false;\n};\n\nvar isNodeMatchingSelectorFocusable = function isNodeMatchingSelectorFocusable(options, node) {\n  if (node.disabled || isHiddenInput(node) || isHidden(node, options.displayCheck) || // For a details element with a summary, the summary element gets the focus\n  isDetailsWithSummary(node) || isDisabledFromFieldset(node)) {\n    return false;\n  }\n\n  return true;\n};\n\nvar isNodeMatchingSelectorTabbable = function isNodeMatchingSelectorTabbable(options, node) {\n  if (!isNodeMatchingSelectorFocusable(options, node) || isNonTabbableRadio(node) || getTabindex(node) < 0) {\n    return false;\n  }\n\n  return true;\n};\n\nvar tabbable = function tabbable(el, options) {\n  options = options || {};\n  var regularTabbables = [];\n  var orderedTabbables = [];\n  var candidates = getCandidates(el, options.includeContainer, isNodeMatchingSelectorTabbable.bind(null, options));\n  candidates.forEach(function (candidate, i) {\n    var candidateTabindex = getTabindex(candidate);\n\n    if (candidateTabindex === 0) {\n      regularTabbables.push(candidate);\n    } else {\n      orderedTabbables.push({\n        documentOrder: i,\n        tabIndex: candidateTabindex,\n        node: candidate\n      });\n    }\n  });\n  var tabbableNodes = orderedTabbables.sort(sortOrderedTabbables).map(function (a) {\n    return a.node;\n  }).concat(regularTabbables);\n  return tabbableNodes;\n};\n\nvar focusable = function focusable(el, options) {\n  options = options || {};\n  var candidates = getCandidates(el, options.includeContainer, isNodeMatchingSelectorFocusable.bind(null, options));\n  return candidates;\n};\n\nvar isTabbable = function isTabbable(node, options) {\n  options = options || {};\n\n  if (!node) {\n    throw new Error('No node provided');\n  }\n\n  if (matches.call(node, candidateSelector) === false) {\n    return false;\n  }\n\n  return isNodeMatchingSelectorTabbable(options, node);\n};\n\nvar focusableCandidateSelector = /* #__PURE__ */candidateSelectors.concat('iframe').join(',');\n\nvar isFocusable = function isFocusable(node, options) {\n  options = options || {};\n\n  if (!node) {\n    throw new Error('No node provided');\n  }\n\n  if (matches.call(node, focusableCandidateSelector) === false) {\n    return false;\n  }\n\n  return isNodeMatchingSelectorFocusable(options, node);\n};\n\nexport { focusable, isFocusable, isTabbable, tabbable };\n//# sourceMappingURL=index.esm.js.map\n","/*!\n* focus-trap 6.7.1\n* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE\n*/\nimport { tabbable, isFocusable } from 'tabbable';\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar activeFocusTraps = function () {\n  var trapQueue = [];\n  return {\n    activateTrap: function activateTrap(trap) {\n      if (trapQueue.length > 0) {\n        var activeTrap = trapQueue[trapQueue.length - 1];\n\n        if (activeTrap !== trap) {\n          activeTrap.pause();\n        }\n      }\n\n      var trapIndex = trapQueue.indexOf(trap);\n\n      if (trapIndex === -1) {\n        trapQueue.push(trap);\n      } else {\n        // move this existing trap to the front of the queue\n        trapQueue.splice(trapIndex, 1);\n        trapQueue.push(trap);\n      }\n    },\n    deactivateTrap: function deactivateTrap(trap) {\n      var trapIndex = trapQueue.indexOf(trap);\n\n      if (trapIndex !== -1) {\n        trapQueue.splice(trapIndex, 1);\n      }\n\n      if (trapQueue.length > 0) {\n        trapQueue[trapQueue.length - 1].unpause();\n      }\n    }\n  };\n}();\n\nvar isSelectableInput = function isSelectableInput(node) {\n  return node.tagName && node.tagName.toLowerCase() === 'input' && typeof node.select === 'function';\n};\n\nvar isEscapeEvent = function isEscapeEvent(e) {\n  return e.key === 'Escape' || e.key === 'Esc' || e.keyCode === 27;\n};\n\nvar isTabEvent = function isTabEvent(e) {\n  return e.key === 'Tab' || e.keyCode === 9;\n};\n\nvar delay = function delay(fn) {\n  return setTimeout(fn, 0);\n}; // Array.find/findIndex() are not supported on IE; this replicates enough\n//  of Array.findIndex() for our needs\n\n\nvar findIndex = function findIndex(arr, fn) {\n  var idx = -1;\n  arr.every(function (value, i) {\n    if (fn(value)) {\n      idx = i;\n      return false; // break\n    }\n\n    return true; // next\n  });\n  return idx;\n};\n/**\n * Get an option's value when it could be a plain value, or a handler that provides\n *  the value.\n * @param {*} value Option's value to check.\n * @param {...*} [params] Any parameters to pass to the handler, if `value` is a function.\n * @returns {*} The `value`, or the handler's returned value.\n */\n\n\nvar valueOrHandler = function valueOrHandler(value) {\n  for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    params[_key - 1] = arguments[_key];\n  }\n\n  return typeof value === 'function' ? value.apply(void 0, params) : value;\n};\n\nvar getActualTarget = function getActualTarget(event) {\n  // NOTE: If the trap is _inside_ a shadow DOM, event.target will always be the\n  //  shadow host. However, event.target.composedPath() will be an array of\n  //  nodes \"clicked\" from inner-most (the actual element inside the shadow) to\n  //  outer-most (the host HTML document). If we have access to composedPath(),\n  //  then use its first element; otherwise, fall back to event.target (and\n  //  this only works for an _open_ shadow DOM; otherwise,\n  //  composedPath()[0] === event.target always).\n  return event.target.shadowRoot && typeof event.composedPath === 'function' ? event.composedPath()[0] : event.target;\n};\n\nvar createFocusTrap = function createFocusTrap(elements, userOptions) {\n  var doc = (userOptions === null || userOptions === void 0 ? void 0 : userOptions.document) || document;\n\n  var config = _objectSpread2({\n    returnFocusOnDeactivate: true,\n    escapeDeactivates: true,\n    delayInitialFocus: true\n  }, userOptions);\n\n  var state = {\n    // @type {Array<HTMLElement>}\n    containers: [],\n    // list of objects identifying the first and last tabbable nodes in all containers/groups in\n    //  the trap\n    // NOTE: it's possible that a group has no tabbable nodes if nodes get removed while the trap\n    //  is active, but the trap should never get to a state where there isn't at least one group\n    //  with at least one tabbable node in it (that would lead to an error condition that would\n    //  result in an error being thrown)\n    // @type {Array<{ container: HTMLElement, firstTabbableNode: HTMLElement|null, lastTabbableNode: HTMLElement|null }>}\n    tabbableGroups: [],\n    nodeFocusedBeforeActivation: null,\n    mostRecentlyFocusedNode: null,\n    active: false,\n    paused: false,\n    // timer ID for when delayInitialFocus is true and initial focus in this trap\n    //  has been delayed during activation\n    delayInitialFocusTimer: undefined\n  };\n  var trap; // eslint-disable-line prefer-const -- some private functions reference it, and its methods reference private functions, so we must declare here and define later\n\n  var getOption = function getOption(configOverrideOptions, optionName, configOptionName) {\n    return configOverrideOptions && configOverrideOptions[optionName] !== undefined ? configOverrideOptions[optionName] : config[configOptionName || optionName];\n  };\n\n  var containersContain = function containersContain(element) {\n    return !!(element && state.containers.some(function (container) {\n      return container.contains(element);\n    }));\n  };\n  /**\n   * Gets the node for the given option, which is expected to be an option that\n   *  can be either a DOM node, a string that is a selector to get a node, `false`\n   *  (if a node is explicitly NOT given), or a function that returns any of these\n   *  values.\n   * @param {string} optionName\n   * @returns {undefined | false | HTMLElement | SVGElement} Returns\n   *  `undefined` if the option is not specified; `false` if the option\n   *  resolved to `false` (node explicitly not given); otherwise, the resolved\n   *  DOM node.\n   * @throws {Error} If the option is set, not `false`, and is not, or does not\n   *  resolve to a node.\n   */\n\n\n  var getNodeForOption = function getNodeForOption(optionName) {\n    var optionValue = config[optionName];\n\n    if (typeof optionValue === 'function') {\n      for (var _len2 = arguments.length, params = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        params[_key2 - 1] = arguments[_key2];\n      }\n\n      optionValue = optionValue.apply(void 0, params);\n    }\n\n    if (!optionValue) {\n      if (optionValue === undefined || optionValue === false) {\n        return optionValue;\n      } // else, empty string (invalid), null (invalid), 0 (invalid)\n\n\n      throw new Error(\"`\".concat(optionName, \"` was specified but was not a node, or did not return a node\"));\n    }\n\n    var node = optionValue; // could be HTMLElement, SVGElement, or non-empty string at this point\n\n    if (typeof optionValue === 'string') {\n      node = doc.querySelector(optionValue); // resolve to node, or null if fails\n\n      if (!node) {\n        throw new Error(\"`\".concat(optionName, \"` as selector refers to no known node\"));\n      }\n    }\n\n    return node;\n  };\n\n  var getInitialFocusNode = function getInitialFocusNode() {\n    var node = getNodeForOption('initialFocus'); // false explicitly indicates we want no initialFocus at all\n\n    if (node === false) {\n      return false;\n    }\n\n    if (node === undefined) {\n      // option not specified: use fallback options\n      if (containersContain(doc.activeElement)) {\n        node = doc.activeElement;\n      } else {\n        var firstTabbableGroup = state.tabbableGroups[0];\n        var firstTabbableNode = firstTabbableGroup && firstTabbableGroup.firstTabbableNode; // NOTE: `fallbackFocus` option function cannot return `false` (not supported)\n\n        node = firstTabbableNode || getNodeForOption('fallbackFocus');\n      }\n    }\n\n    if (!node) {\n      throw new Error('Your focus-trap needs to have at least one focusable element');\n    }\n\n    return node;\n  };\n\n  var updateTabbableNodes = function updateTabbableNodes() {\n    state.tabbableGroups = state.containers.map(function (container) {\n      var tabbableNodes = tabbable(container);\n\n      if (tabbableNodes.length > 0) {\n        return {\n          container: container,\n          firstTabbableNode: tabbableNodes[0],\n          lastTabbableNode: tabbableNodes[tabbableNodes.length - 1]\n        };\n      }\n\n      return undefined;\n    }).filter(function (group) {\n      return !!group;\n    }); // remove groups with no tabbable nodes\n    // throw if no groups have tabbable nodes and we don't have a fallback focus node either\n\n    if (state.tabbableGroups.length <= 0 && !getNodeForOption('fallbackFocus') // returning false not supported for this option\n    ) {\n      throw new Error('Your focus-trap must have at least one container with at least one tabbable node in it at all times');\n    }\n  };\n\n  var tryFocus = function tryFocus(node) {\n    if (node === false) {\n      return;\n    }\n\n    if (node === doc.activeElement) {\n      return;\n    }\n\n    if (!node || !node.focus) {\n      tryFocus(getInitialFocusNode());\n      return;\n    }\n\n    node.focus({\n      preventScroll: !!config.preventScroll\n    });\n    state.mostRecentlyFocusedNode = node;\n\n    if (isSelectableInput(node)) {\n      node.select();\n    }\n  };\n\n  var getReturnFocusNode = function getReturnFocusNode(previousActiveElement) {\n    var node = getNodeForOption('setReturnFocus', previousActiveElement);\n    return node ? node : node === false ? false : previousActiveElement;\n  }; // This needs to be done on mousedown and touchstart instead of click\n  // so that it precedes the focus event.\n\n\n  var checkPointerDown = function checkPointerDown(e) {\n    var target = getActualTarget(e);\n\n    if (containersContain(target)) {\n      // allow the click since it ocurred inside the trap\n      return;\n    }\n\n    if (valueOrHandler(config.clickOutsideDeactivates, e)) {\n      // immediately deactivate the trap\n      trap.deactivate({\n        // if, on deactivation, we should return focus to the node originally-focused\n        //  when the trap was activated (or the configured `setReturnFocus` node),\n        //  then assume it's also OK to return focus to the outside node that was\n        //  just clicked, causing deactivation, as long as that node is focusable;\n        //  if it isn't focusable, then return focus to the original node focused\n        //  on activation (or the configured `setReturnFocus` node)\n        // NOTE: by setting `returnFocus: false`, deactivate() will do nothing,\n        //  which will result in the outside click setting focus to the node\n        //  that was clicked, whether it's focusable or not; by setting\n        //  `returnFocus: true`, we'll attempt to re-focus the node originally-focused\n        //  on activation (or the configured `setReturnFocus` node)\n        returnFocus: config.returnFocusOnDeactivate && !isFocusable(target)\n      });\n      return;\n    } // This is needed for mobile devices.\n    // (If we'll only let `click` events through,\n    // then on mobile they will be blocked anyways if `touchstart` is blocked.)\n\n\n    if (valueOrHandler(config.allowOutsideClick, e)) {\n      // allow the click outside the trap to take place\n      return;\n    } // otherwise, prevent the click\n\n\n    e.preventDefault();\n  }; // In case focus escapes the trap for some strange reason, pull it back in.\n\n\n  var checkFocusIn = function checkFocusIn(e) {\n    var target = getActualTarget(e);\n    var targetContained = containersContain(target); // In Firefox when you Tab out of an iframe the Document is briefly focused.\n\n    if (targetContained || target instanceof Document) {\n      if (targetContained) {\n        state.mostRecentlyFocusedNode = target;\n      }\n    } else {\n      // escaped! pull it back in to where it just left\n      e.stopImmediatePropagation();\n      tryFocus(state.mostRecentlyFocusedNode || getInitialFocusNode());\n    }\n  }; // Hijack Tab events on the first and last focusable nodes of the trap,\n  // in order to prevent focus from escaping. If it escapes for even a\n  // moment it can end up scrolling the page and causing confusion so we\n  // kind of need to capture the action at the keydown phase.\n\n\n  var checkTab = function checkTab(e) {\n    var target = getActualTarget(e);\n    updateTabbableNodes();\n    var destinationNode = null;\n\n    if (state.tabbableGroups.length > 0) {\n      // make sure the target is actually contained in a group\n      // NOTE: the target may also be the container itself if it's tabbable\n      //  with tabIndex='-1' and was given initial focus\n      var containerIndex = findIndex(state.tabbableGroups, function (_ref) {\n        var container = _ref.container;\n        return container.contains(target);\n      });\n\n      if (containerIndex < 0) {\n        // target not found in any group: quite possible focus has escaped the trap,\n        //  so bring it back in to...\n        if (e.shiftKey) {\n          // ...the last node in the last group\n          destinationNode = state.tabbableGroups[state.tabbableGroups.length - 1].lastTabbableNode;\n        } else {\n          // ...the first node in the first group\n          destinationNode = state.tabbableGroups[0].firstTabbableNode;\n        }\n      } else if (e.shiftKey) {\n        // REVERSE\n        // is the target the first tabbable node in a group?\n        var startOfGroupIndex = findIndex(state.tabbableGroups, function (_ref2) {\n          var firstTabbableNode = _ref2.firstTabbableNode;\n          return target === firstTabbableNode;\n        });\n\n        if (startOfGroupIndex < 0 && state.tabbableGroups[containerIndex].container === target) {\n          // an exception case where the target is the container itself, in which\n          //  case, we should handle shift+tab as if focus were on the container's\n          //  first tabbable node, and go to the last tabbable node of the LAST group\n          startOfGroupIndex = containerIndex;\n        }\n\n        if (startOfGroupIndex >= 0) {\n          // YES: then shift+tab should go to the last tabbable node in the\n          //  previous group (and wrap around to the last tabbable node of\n          //  the LAST group if it's the first tabbable node of the FIRST group)\n          var destinationGroupIndex = startOfGroupIndex === 0 ? state.tabbableGroups.length - 1 : startOfGroupIndex - 1;\n          var destinationGroup = state.tabbableGroups[destinationGroupIndex];\n          destinationNode = destinationGroup.lastTabbableNode;\n        }\n      } else {\n        // FORWARD\n        // is the target the last tabbable node in a group?\n        var lastOfGroupIndex = findIndex(state.tabbableGroups, function (_ref3) {\n          var lastTabbableNode = _ref3.lastTabbableNode;\n          return target === lastTabbableNode;\n        });\n\n        if (lastOfGroupIndex < 0 && state.tabbableGroups[containerIndex].container === target) {\n          // an exception case where the target is the container itself, in which\n          //  case, we should handle tab as if focus were on the container's\n          //  last tabbable node, and go to the first tabbable node of the FIRST group\n          lastOfGroupIndex = containerIndex;\n        }\n\n        if (lastOfGroupIndex >= 0) {\n          // YES: then tab should go to the first tabbable node in the next\n          //  group (and wrap around to the first tabbable node of the FIRST\n          //  group if it's the last tabbable node of the LAST group)\n          var _destinationGroupIndex = lastOfGroupIndex === state.tabbableGroups.length - 1 ? 0 : lastOfGroupIndex + 1;\n\n          var _destinationGroup = state.tabbableGroups[_destinationGroupIndex];\n          destinationNode = _destinationGroup.firstTabbableNode;\n        }\n      }\n    } else {\n      // NOTE: the fallbackFocus option does not support returning false to opt-out\n      destinationNode = getNodeForOption('fallbackFocus');\n    }\n\n    if (destinationNode) {\n      e.preventDefault();\n      tryFocus(destinationNode);\n    } // else, let the browser take care of [shift+]tab and move the focus\n\n  };\n\n  var checkKey = function checkKey(e) {\n    if (isEscapeEvent(e) && valueOrHandler(config.escapeDeactivates, e) !== false) {\n      e.preventDefault();\n      trap.deactivate();\n      return;\n    }\n\n    if (isTabEvent(e)) {\n      checkTab(e);\n      return;\n    }\n  };\n\n  var checkClick = function checkClick(e) {\n    if (valueOrHandler(config.clickOutsideDeactivates, e)) {\n      return;\n    }\n\n    var target = getActualTarget(e);\n\n    if (containersContain(target)) {\n      return;\n    }\n\n    if (valueOrHandler(config.allowOutsideClick, e)) {\n      return;\n    }\n\n    e.preventDefault();\n    e.stopImmediatePropagation();\n  }; //\n  // EVENT LISTENERS\n  //\n\n\n  var addListeners = function addListeners() {\n    if (!state.active) {\n      return;\n    } // There can be only one listening focus trap at a time\n\n\n    activeFocusTraps.activateTrap(trap); // Delay ensures that the focused element doesn't capture the event\n    // that caused the focus trap activation.\n\n    state.delayInitialFocusTimer = config.delayInitialFocus ? delay(function () {\n      tryFocus(getInitialFocusNode());\n    }) : tryFocus(getInitialFocusNode());\n    doc.addEventListener('focusin', checkFocusIn, true);\n    doc.addEventListener('mousedown', checkPointerDown, {\n      capture: true,\n      passive: false\n    });\n    doc.addEventListener('touchstart', checkPointerDown, {\n      capture: true,\n      passive: false\n    });\n    doc.addEventListener('click', checkClick, {\n      capture: true,\n      passive: false\n    });\n    doc.addEventListener('keydown', checkKey, {\n      capture: true,\n      passive: false\n    });\n    return trap;\n  };\n\n  var removeListeners = function removeListeners() {\n    if (!state.active) {\n      return;\n    }\n\n    doc.removeEventListener('focusin', checkFocusIn, true);\n    doc.removeEventListener('mousedown', checkPointerDown, true);\n    doc.removeEventListener('touchstart', checkPointerDown, true);\n    doc.removeEventListener('click', checkClick, true);\n    doc.removeEventListener('keydown', checkKey, true);\n    return trap;\n  }; //\n  // TRAP DEFINITION\n  //\n\n\n  trap = {\n    activate: function activate(activateOptions) {\n      if (state.active) {\n        return this;\n      }\n\n      var onActivate = getOption(activateOptions, 'onActivate');\n      var onPostActivate = getOption(activateOptions, 'onPostActivate');\n      var checkCanFocusTrap = getOption(activateOptions, 'checkCanFocusTrap');\n\n      if (!checkCanFocusTrap) {\n        updateTabbableNodes();\n      }\n\n      state.active = true;\n      state.paused = false;\n      state.nodeFocusedBeforeActivation = doc.activeElement;\n\n      if (onActivate) {\n        onActivate();\n      }\n\n      var finishActivation = function finishActivation() {\n        if (checkCanFocusTrap) {\n          updateTabbableNodes();\n        }\n\n        addListeners();\n\n        if (onPostActivate) {\n          onPostActivate();\n        }\n      };\n\n      if (checkCanFocusTrap) {\n        checkCanFocusTrap(state.containers.concat()).then(finishActivation, finishActivation);\n        return this;\n      }\n\n      finishActivation();\n      return this;\n    },\n    deactivate: function deactivate(deactivateOptions) {\n      if (!state.active) {\n        return this;\n      }\n\n      clearTimeout(state.delayInitialFocusTimer); // noop if undefined\n\n      state.delayInitialFocusTimer = undefined;\n      removeListeners();\n      state.active = false;\n      state.paused = false;\n      activeFocusTraps.deactivateTrap(trap);\n      var onDeactivate = getOption(deactivateOptions, 'onDeactivate');\n      var onPostDeactivate = getOption(deactivateOptions, 'onPostDeactivate');\n      var checkCanReturnFocus = getOption(deactivateOptions, 'checkCanReturnFocus');\n\n      if (onDeactivate) {\n        onDeactivate();\n      }\n\n      var returnFocus = getOption(deactivateOptions, 'returnFocus', 'returnFocusOnDeactivate');\n\n      var finishDeactivation = function finishDeactivation() {\n        delay(function () {\n          if (returnFocus) {\n            tryFocus(getReturnFocusNode(state.nodeFocusedBeforeActivation));\n          }\n\n          if (onPostDeactivate) {\n            onPostDeactivate();\n          }\n        });\n      };\n\n      if (returnFocus && checkCanReturnFocus) {\n        checkCanReturnFocus(getReturnFocusNode(state.nodeFocusedBeforeActivation)).then(finishDeactivation, finishDeactivation);\n        return this;\n      }\n\n      finishDeactivation();\n      return this;\n    },\n    pause: function pause() {\n      if (state.paused || !state.active) {\n        return this;\n      }\n\n      state.paused = true;\n      removeListeners();\n      return this;\n    },\n    unpause: function unpause() {\n      if (!state.paused || !state.active) {\n        return this;\n      }\n\n      state.paused = false;\n      updateTabbableNodes();\n      addListeners();\n      return this;\n    },\n    updateContainerElements: function updateContainerElements(containerElements) {\n      var elementsAsArray = [].concat(containerElements).filter(Boolean);\n      state.containers = elementsAsArray.map(function (element) {\n        return typeof element === 'string' ? doc.querySelector(element) : element;\n      });\n\n      if (state.active) {\n        updateTabbableNodes();\n      }\n\n      return this;\n    }\n  }; // initialize container elements\n\n  trap.updateContainerElements(elements);\n  return trap;\n};\n\nexport { createFocusTrap };\n//# sourceMappingURL=focus-trap.esm.js.map\n","import * as focusTrap from \"focus-trap\";\n\nconst addFocusTrap = (arg): any => {\n    const {\n        target,\n        escapeDeactivates = (e) => false,\n        clickOutsideDeactivates = (e) => false,\n    } = arg;\n\n    const ft = focusTrap.createFocusTrap(target, {\n        // initialFocus: false,\n        delayInitialFocus: false,\n        escapeDeactivates,\n        clickOutsideDeactivates,\n    });\n    ft.activate();\n    return ft;\n};\n\nexport default addFocusTrap;\n","function debounce<T>(\n  fn: (arg: T) => void,\n  ms: number\n): (arg: T) => void {\n  // Avoid wrapping in `setTimeout` if ms is 0 anyway\n  if (ms === 0) {\n    return fn;\n  }\n\n  let timeout: any;\n\n  return (arg): void => {\n    clearTimeout(timeout);\n    timeout = setTimeout(() => {\n      fn(arg);\n    }, ms);\n  };\n}\n\nexport default debounce;\n","export const MODAL_OVERLAY_CLASS = \"lusift-modal-overlay\";\nexport const MODAL_CLASS = \"modal\";\nexport const BEACON_CONTAINER_CLASS = \"lusift-beacon-container\";\nexport const DEFAULT_TOOLTIP_BORDER_RADIUS = \"4px\";\nexport const DEFAULT_MODAL_BORDER_RADIUS = \"4px\";\nexport const PRIMARY_COLOR = \"#17a3a8\";\nexport const DEFAULT_PROGRESS_BAR_HEIGHT = \"3px\";\nexport const LUSIFT_CONTAINER_ID = \"lusift\";\nexport const LUSIFT_SHADOW_ROOT_ID = \"lusift-root\";\nexport const MODAL_OVERLAY_Z_INDEX = 99999;\nexport const BACKDROP_Z_INDEX = 99998;\nexport const TOOLTIP_Z_INDEX = 99999;\nexport const BEACON_Z_INDEX = 99999;\n","import { window } from \"global\";\nimport { loadState } from \"../store\";\nimport {\n    DEFAULT_TOOLTIP_BORDER_RADIUS,\n    DEFAULT_MODAL_BORDER_RADIUS,\n    PRIMARY_COLOR,\n    DEFAULT_PROGRESS_BAR_HEIGHT,\n} from \"../constants\";\n\nconst renderProgressBar = () => {\n    const currentGuide = loadState()[window.Lusift.getActiveGuide()?.id];\n\n    if (!currentGuide) return \"\";\n    if (!currentGuide) {\n        // Assuming that this is dev mode\n        let progress = \"66.66\";\n        let max = 100;\n        return `\n      <progress class=\"lusift-progress\" aria-label=\"progressbar\" max=\"${max}\" value=\"${progress}\">\n        ${progress}%\n      </progress>\n    `;\n    }\n\n    const Lusift = window['Lusift'];\n    const guideData = Lusift.getContent()[Lusift.getActiveGuide().id].data;\n    const currentStep = guideData.steps[currentGuide.trackingState.currentStepIndex];\n    const progressBarData = currentGuide.progressBar || {};\n\n    // find out borderRadius based on step type (their default border radii), or via styleProps\n    let {\n        height = DEFAULT_PROGRESS_BAR_HEIGHT,\n        color = PRIMARY_COLOR,\n        borderRadius,\n    } = progressBarData;\n\n    if (!borderRadius) {\n        if (currentStep.type === \"modal\") {\n            if (currentStep.styleProps) {\n                borderRadius = currentStep.styleProps.borderRadius || DEFAULT_MODAL_BORDER_RADIUS;\n            } else {\n                borderRadius = DEFAULT_MODAL_BORDER_RADIUS;\n            }\n        } else {\n            if (currentStep.styleProps) {\n                borderRadius = currentStep.styleProps.borderRadius || DEFAULT_TOOLTIP_BORDER_RADIUS;\n            } else {\n                borderRadius = DEFAULT_TOOLTIP_BORDER_RADIUS;\n            }\n        }\n    }\n\n    const progress = Lusift.getActiveGuide().instance.getProgress();\n\n    const max = 100;\n\n    return `\n        <style>\n          .lusift-progress {\n            height: ${height};\n          }\n          .lusift-progress::-webkit-progress-bar {\n            border-radius: ${borderRadius}; /*border-radius of tooltip*/\n          }\n          .lusift-progress::-webkit-progress-value {\n            background-color: ${color}; /*color of progress bar*/\n          }\n        </style>\n\n        <progress class=\"lusift-progress\" aria-label=\"progressbar\" max=\"${max}\" value=\"${progress}\">\n          ${progress}%\n        </progress>\n    `;\n};\n\nexport default renderProgressBar;\n","import { styleObjectToString } from \"../utils\";\n\nconst renderCloseXButton = (closeButton: any, stepType: string): string => {\n    if (closeButton.disabled) return `<div style=\"margin-top: 0.7rem\"></div>`;\n    return `\n    <style>\n      .lusift .${stepType.toLowerCase()} .closeX{\n        ${styleObjectToString(closeButton.styleProps)}\n      }\n    </style>\n\n    <section class=\"close-btn\">\n      <button onclick=\"Lusift.close()\" class=\"closeX close\">&times;</button>\n    </section>\n  `;\n};\n\nexport default renderCloseXButton;\n","!function(t,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=e(require(\"tslib\"),require(\"@floating-ui/dom\")):\"function\"==typeof define&&define.amd?define([\"tslib\",\"@floating-ui/dom\"],e):(t=\"undefined\"!=typeof globalThis?globalThis:t||self)[\"floating-ui-tooltip\"]=e(t.tslib,t.dom)}(this,(function(t,e){\"use strict\";function i(t,e,i){var o=e+\"EventListener\";[\"transitionend\",\"webkitTransitionEnd\",\"oTransitionEnd\"].forEach((function(e){t[o](e,i)}))}function o(t,e){t.setAttribute(\"data-transition-state\",e),console.log(\">> new transition state: \"+e)}function n(t,e){t.setAttribute(\"data-state\",e),Object.assign(t.style,{visibility:e})}function r(){return document.createElement(\"div\")}function s(t){return{box:t.querySelector(\".floating-ui-tooltip-box\"),content:t.querySelector(\".floating-ui-tooltip-content\"),arrow:t.querySelector(\".floating-ui-tooltip-arrow\")||void 0}}function a(t,e){var r=t._instance,s=t.getAttribute(\"data-transition-state\");if(console.log(\"``````````\"),console.log(\"\\n\"),console.log(e,s),\"visible\"===e){if(\"shown\"===s||\"showing\"===s)return void console.log(\"already \"+s);if(\"hidden\"===s)console.log(\"showing\"),o(t,\"showing\");else if(\"hiding\"===s)return void console.log(\"cancelling \"+s)}else{if(\"hidden\"===s||\"hiding\"===s)return void console.log(\"already \"+s);if(\"shown\"===s)o(t,\"hiding\"),r.props.onHide(r);else if(\"showing\"===s)return void console.log(\"cancelling \"+s)}var a=\"visible\"===e?\"shown\":\"hidden\";0!==r.transitionDuration?(!function(t,e){function o(n){if(n.target===t){i(t,\"remove\",o);try{e()}catch(e){console.error(e),t._instance.props.onHide()}}}i(t,\"remove\",o),i(t,\"add\",o)}(t,(function(){!function(t,e){t._instance.setState({isShown:\"visible\"===e})}(t,e),o(t,a),\"visible\"===e&&r.props.onShow(r)})),n(t,e)):(n(t,e),o(t,a),\"visible\"===e&&r.props.onShow(r))}var l={top:\"bottom\",right:\"left\",bottom:\"top\",left:\"right\"},d=function(i,o,n,r,d,p){return t.__awaiter(void 0,void 0,void 0,(function(){var c,u,h,f,g,b,v,w,m,x,y,_,E,S,O,k,C,T,H,D,L,z,A,j,P,R,U,q,I,M,N,W,V,F,X,B,G;return t.__generator(this,(function(J){switch(J.label){case 0:return h=void 0!==(u=(c={}).toFlip)&&u,g=void 0===(f=c.toShift)||f,b=i.placement,v=i.hideOnReferenceHidden,w=i.offset,m=i.hideOnTooltipEscape,x=i.arrowSizeScale,y=i.resetPlacementOnUpdate,_=i.arrow,E=i.showOnCreate,S=s(o),O=S.arrow,k=12*x,n?(C=\"auto\"===b&&(d||y),T=\"auto\"!==b&&h,H=g&&d,D={middleware:t.__spreadArray(t.__spreadArray(t.__spreadArray(t.__spreadArray(t.__spreadArray([e.offset({mainAxis:w[0],crossAxis:w[1]})],C?[e.autoPlacement()]:[],!0),H?[e.shift({padding:16})]:[],!0),T?[e.flip({fallbackPlacements:[\"right\",\"left\"],fallbackStrategy:\"initialPlacement\"})]:[],!0),_?[e.arrow({element:O,padding:2})]:[],!0),[e.size({apply:function(t){t.width,t.height,t.reference,t.floating}}),e.hide()],!1)},\"auto\"!==b&&(D.placement=b),[4,e.computePosition(n,o,D)]):[2];case 1:switch(L=J.sent(),z=L.x,A=L.y,j=L.placement,P=L.middlewareData,R=P.hide,U=R.referenceHidden,q=R.escaped,U&&d&&n.scrollIntoView({behavior:\"smooth\",block:\"center\",inline:\"center\"}),P.arrow&&(I=P.arrow.x,M=P.arrow.y),N=0!==P.arrow.centerOffset,\"visible\"===(W=v&&U||m&&q||r?\"hidden\":\"visible\")&&d&&!E&&(W=\"hidden\"),a(o,W),Object.assign(o.style,{left:z+\"px\",top:A+\"px\"}),V=l[j.split(\"-\")[0]],F=0,X=0,B=0,B=null!==I?I+k+\"px\":\"\",V){case\"top\":F=1/1.7,B=null!==I?I+k*F+\"px\":\"\";break;case\"bottom\":F=.5,B=null!==I?I+k*F+\"px\":\"\";break;case\"left\":F=.005,B=null!==I?I+\"px\":\"\",X=null!==M?M-k*F/2+\"px\":\"\";break;case\"right\":F=1.2,B=null!==I?I+\"px\":\"\",X=null!==M?M-k*F/2+\"px\":\"\"}return X=null!==M?M-k*F/2+\"px\":\"\",X=null!==M?M+\"px\":\"\",Object.assign(O.style,((G={visibility:N?\"hidden\":\"visible\",left:B,top:X,right:\"\",bottom:\"\"})[V]=\"-\"+k*F+\"px\",G)),p({fui:L}),[2,L]}}))}))},p={allowHTML:!0,content:\"\",arrow:!0,scrollIntoView:!1,transitionDuration:[300,250],offset:[10,0],hideOnClick:!0,onClickOutside:function(t,e){},onShow:function(t){},onHide:function(t){},onStateChange:function(t,e){},onRemove:function(){},placement:\"top\",resetPlacementOnUpdate:!1,hideOnTooltipEscape:!0,hideOnReferenceHidden:!0,showOnCreate:!0,maxWidth:350,updateDebounce:100,zIndex:99999,arrowSizeScale:1,updateOnEvents:\"resize scroll\"};var c=function(){function i(t,e){var i,o=this;this.state={isShown:!1,isRemoved:!1,fui:void 0},this.updateListenerCleanup=function(){},this.toHideTooltip=!1,this.transitionDuration=0,this.clickHandler=function(t){o.state.isShown&&(o.tooltipElement.contains(t.target)||o.reference.contains(t.target)||o.props.onClickOutside&&o.props.onClickOutside(o,t),\"target\"===o.props.hideOnClick?t.target===o.reference&&o.hide():o.props.hideOnClick&&o.hide())},this.props=t,this.reference=e,(i=document.createElement(\"style\")).type=\"text/css\",i.setAttribute(\"floating-ui-tooltip-default\",\"\"),i.textContent=\".floating-ui-tooltip-root{--color:#fff;--border-color:#fefefe;--border-color:red;backface-visibility:hidden;background:var(--color);border-radius:6px;box-shadow:0 0 0 1px rgba(6,44,82,.1),0 2px 16px rgba(33,43,54,.08);box-shadow:0 0 20px 4px rgba(154,161,177,.15),0 4px 80px -8px rgba(36,40,47,.25),0 4px 4px -2px rgba(91,94,105,.15);display:flex;font-size:90%;line-height:0px;margin:0;max-width:calc(100vw - 10px);padding:0;position:absolute;transition-duration:.2s;transition-property:transform,visibility,opacity;transition-timing-function:cubic-bezier(.54,1.5,.38,1.11);z-index:9999}.floating-ui-tooltip-arrow{box-shadow:0 0 0 1px rgba(6,44,82,.1),0 2px 16px rgba(33,43,54,.08);height:14px;position:absolute;transform:translateX(-50%) rotate(45deg);width:14px;z-index:-1}.floating-ui-tooltip-box{border-radius:inherit;line-height:normal;margin:0;outline:0;position:relative}.floating-ui-tooltip-root[data-state=hidden]{opacity:0}.floating-ui-tooltip-root[data-state=visible]{opacity:1}.floating-ui-tooltip-content{background-color:#fff;border-radius:inherit;color:#111;padding:0;position:relative;z-index:2}.floating-ui-tooltip-arrow,.floating-ui-tooltip-root{background:var(--color)}\",document.head.appendChild(i),this.toHideTooltip=!this.props.showOnCreate}return i.prototype.hookEventListeners=function(){var t,i,o,n=this;this.debouncedUpdate=(t=this.update.bind(this),0===(i=this.props.updateDebounce)?t:function(e){clearTimeout(o),o=setTimeout((function(){t(e)}),i)});var r=e.autoUpdate(this.reference,this.tooltipElement,(function(){return n.debouncedUpdate(void 0)})),s=function(){return n.debouncedUpdate(void 0)};this.props.updateOnEvents.split(\" \").forEach((function(t){window.addEventListener(t,s)})),window.addEventListener(\"click\",this.clickHandler.bind(this)),this.updateListenerCleanup=function(){r(),window.removeEventListener(\"click\",n.clickHandler.bind(n)),n.props.updateOnEvents.split(\" \").forEach((function(t){window.removeEventListener(t,s)}))}},i.prototype.updateTransitionDuration=function(t){this.transitionDuration=t,this.tooltipElement.style.transitionDuration=t+\"ms\"},i.prototype.create=function(){return t.__awaiter(this,void 0,void 0,(function(){var e,i,a,l,p;return t.__generator(this,(function(t){switch(t.label){case 0:return e=!this.props.showOnCreate,this.tooltipElement=(c=this,u=r(),h=r(),f=r(),g=r(),u.className=\"floating-ui-tooltip-root\",h.className=\"floating-ui-tooltip-box\",f.className=\"floating-ui-tooltip-content\",g.className=\"floating-ui-tooltip-arrow\",h.appendChild(f),h.appendChild(g),u.appendChild(h),Object.assign(f.style,{maxWidth:c.props.maxWidth+\"px\"}),f.innerHTML='\\n    <div id=\"tooltip-container\">\\n    <h3>Default tooltip</h3>\\n    </div>\\n  ',h.setAttribute(\"role\",\"tooltip\"),n(u,\"hidden\"),o(u,\"hidden\"),Object.assign(u.style,{zIndex:c.props.zIndex,visibility:\"hidden\",left:\"0px\",top:\"0px\"}),u._instance=c,u),this.updateTransitionDuration(this.props.transitionDuration[e?0:1]),i=s(this.tooltipElement).content,a=this.props,l=a.allowHTML,p=a.content,l?i.innerHTML=p:i.innerText=\"\"+p,document.body.appendChild(this.tooltipElement),[4,d(this.props,this.tooltipElement,this.reference,e,!0,this.setState.bind(this))];case 1:return t.sent(),this.hookEventListeners(),[2]}var c,u,h,f,g}))}))},i.prototype.getState=function(){return this.state},i.prototype.setState=function(e){void 0!==e.isShown&&e.isShown!==this.state.isShown&&this.updateTransitionDuration(this.props.transitionDuration[e.isShown?1:0]),this.props.onStateChange(this.state,e),this.state=t.__assign(t.__assign({},this.state),e)},i.prototype.update=function(e){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return e=e||this.toHideTooltip||!1,[4,d(this.props,this.tooltipElement,this.reference,e,!1,this.setState.bind(this))];case 1:return t.sent(),[2]}}))}))},i.prototype.hide=function(){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return this.toHideTooltip=!0,[4,this.update(!0)];case 1:return t.sent(),[2]}}))}))},i.prototype.show=function(){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return this.toHideTooltip=!1,[4,this.update(!1)];case 1:return t.sent(),[2]}}))}))},i.prototype.remove=function(){this.tooltipElement.remove(),this.state={isShown:!1,isRemoved:!0,fui:void 0},this.updateListenerCleanup(),console.log(\"removed all event listeners and observers\"),this.props.onRemove()},i}();return function(e,i){return t.__awaiter(this,void 0,void 0,(function(){var o,n,r,s,a;return t.__generator(this,(function(l){switch(l.label){case 0:return o=i.placement||p.placement,n=i.transitionDuration||p.transitionDuration,r=i.offset||p.offset,Object.keys(i).forEach((function(t){return void 0===i[t]&&delete i[t]})),s=t.__assign(t.__assign(t.__assign({},p),i),{placement:o,transitionDuration:n,offset:r}),[4,(a=new c(s,e)).create()];case 1:return l.sent(),[2,{props:a.props,reference:a.reference,tooltipElement:a.tooltipElement,getState:a.getState.bind(a),show:a.show.bind(a),hide:a.hide.bind(a),remove:a.remove.bind(a),update:a.update.bind(a)}]}}))}))}}));\n//# sourceMappingURL=index.js.map\n","/* import floatingTooltip from 'floating-ui-tooltip/dev/index';\nimport { Instance } from 'floating-ui-tooltip/dev/types'; */\nimport floatingTooltip from 'floating-ui-tooltip';\nimport { Instance, Props } from 'floating-ui-tooltip/dist/types';\nimport { TOOLTIP_Z_INDEX } from '../common/constants';\n\nconst createTooltip = async (props): Promise<Instance> => {\n\n    let {\n        target,\n        remove,\n        content,\n        arrow,\n        offset,\n        placement,\n        onShow,\n        onHide,\n        showOnCreate,\n        onClickOutside,\n        hideOnReferenceHidden,\n        hideOnTooltipEscape,\n        scrollIntoView\n    } = props;\n\n    if (!remove) {\n        remove = () => {};\n    }\n\n    return floatingTooltip(target, {\n        allowHTML: true,\n        zIndex: TOOLTIP_Z_INDEX,\n        hideOnClick: false,\n        onClickOutside,\n        onShow,\n        onHide,\n        content,\n        hideOnReferenceHidden,\n        hideOnTooltipEscape,\n        arrow,\n        offset,\n        placement,\n        showOnCreate,\n        scrollIntoView\n    });\n};\n\nexport default createTooltip;\n","import { styleObjectToString } from \"../common/utils\";\nimport renderProgressBar from \"../common/progressBar\";\nimport renderCloseXButton from \"../common/closeXButton\";\nimport createTooltip from \"../common/createTooltip\";\nimport { DEFAULT_TOOLTIP_BORDER_RADIUS } from \"../common/constants\";\nimport { log } from \"../common/logger\";\n\nconst defaultBodyContent = `\n  <h3 style=\"font-weight: bold;\">Default title</h3>\n  <p style=\"font-weight: normal;\">Default tooltip content</p>\n`;\n\nconst renderNavButtons = (navSection: any): string => {\n    const { nextButton, prevButton, dismissLink } = navSection;\n\n    return `\n    <style>\n    .lusift .tooltip section.nav-buttons{\n      ${styleObjectToString(navSection.styleProps)}\n    }\n    .lusift .tooltip .nav-buttons .next{\n      ${styleObjectToString(nextButton.styleProps)}\n    }\n    .lusift .tooltip .nav-buttons .prev{\n      ${styleObjectToString(prevButton.styleProps)}\n    }\n    </style>\n\n    <section class=\"nav-buttons\">\n      ${\n          dismissLink.disabled\n              ? \"\"\n              : `\n        <button onclick=\"Lusift.close()\" class=\"close dismiss-link\">\n          skip this\n        </button>\n        `\n      }\n      ${\n          prevButton.disabled\n              ? \"\"\n              : `<button onclick=\"Lusift.prev()\" class=\"prev lusift-button\">Prev</button>`\n      }\n      ${\n          nextButton.disabled\n              ? \"\"\n              : `<button onclick=\"Lusift.next()\" class=\"next lusift-button\">Next</button>`\n      }\n    </section>\n  `;\n};\n\nconst renderTooltip = async ({ data, target, styleProps, actions, uid, index, onShow, onHide, scrollIntoView }) => {\n    const { closeButton, navSection } = actions;\n    const {\n        arrow,\n        // bodyContent = defaultBodyContent,\n        placement,\n        offset,\n    } = data;\n\n    const content = `\n    <style>\n      .tippy-box{\n        border-radius: ${DEFAULT_TOOLTIP_BORDER_RADIUS};\n        ${styleObjectToString(styleProps)}\n      }\n    </style>\n\n    <div class=\"lusift\">\n      ${renderProgressBar()}\n      <div class=\"tooltip\" id=\"tooltip-${uid}\">\n        ${renderCloseXButton(closeButton, \"tooltip\")}\n        <section class=\"body-content\">\n        </section>\n        ${renderNavButtons(navSection)}\n      </div>\n    <div>\n  `;\n\n    const tooltipInstance = await createTooltip({\n        target,\n        content,\n        arrow,\n        offset,\n        placement,\n        remove: () => {},\n        onShow,\n        onHide,\n        scrollIntoView\n    });\n\n    // tooltipInstance.show();\n\n    const Lusift = window[\"Lusift\"];\n\n    let bodyContent = defaultBodyContent;\n    const activeGuide = Lusift.getActiveGuide();\n\n    if (activeGuide) {\n      bodyContent = Lusift.getContent()[activeGuide.id].data.steps[index].data.bodyContent;\n    }\n\n    Lusift.render(bodyContent, \".lusift > .tooltip > .body-content\", () => {\n        tooltipInstance.update();\n    });\n\n    return tooltipInstance;\n};\n\nexport default renderTooltip;\n","export default {\n    styleProps: {},\n    closeButton: {\n        styleProps: {},\n        disabled: false,\n    },\n    navSection: {\n        styleProps: {},\n        nextButton: {\n            text: \"next\",\n            styleProps: {},\n            disabled: false,\n        },\n        prevButton: {\n            text: \"prev\",\n            styleProps: {},\n            disabled: true,\n        },\n        dismissLink: {\n            text: \"skip this\",\n            styleProps: {},\n            disabled: true,\n        },\n    },\n};\n","import { document, window } from \"global\";\nimport {\n    styleObjectToString,\n    getStepUID,\n    getElementPosition,\n    roundNum,\n    addFocusTrap,\n    getScrollBarWidth,\n    getDocumentDimensions,\n} from \"../common/utils/\";\nimport { log, warn, error } from \"../common/logger\";\nimport { BackdropData } from \"../common/types\";\nimport { BACKDROP_Z_INDEX } from '../common/constants';\n\nconst areNumbersEqual = (num1: number, num2: number): boolean => {\n    let num1Precision = num1.toString().substring(num1.toString().indexOf(\".\")).length - 1;\n    if (num1.toString().indexOf(\".\") == -1) num1Precision = 0;\n\n    let num2Precision = num2.toString().substring(num2.toString().indexOf(\".\")).length - 1;\n    if (num2.toString().indexOf(\".\") == -1) num2Precision = 0;\n    let decimalPlaces = Math.min(num1Precision, num2Precision);\n    if (decimalPlaces > 2) {\n        decimalPlaces = 1; //most reliable precision\n    }\n    /* log(num1, num2)\n  log(num1Precision, num2Precision, decimalPlaces);\n\n  log(roundNum(num1, decimalPlaces), roundNum(num2, decimalPlaces)); */\n\n    return roundNum(num1, decimalPlaces) === roundNum(num2, decimalPlaces);\n};\n\nObject[\"fromEntries\"] = arr => Object.assign({}, ...arr.map(([k, v]) => ({ [k]: v })));\nconst getDefinedProps = obj =>\n    Object[\"fromEntries\"](Object.entries(obj).filter(([k, v]) => v !== undefined));\n\nclass Backdrop {\n    private targetSelector: string;\n    readonly stagedTargetClass: string;\n    readonly overlaySelectorClass: string = \"lusift-backdrop-overlay\";\n    private data: BackdropData = {\n        stageGap: 5,\n        opacity: \"0.5\",\n        color: \"#444\",\n    };\n    private toStopOverlay: boolean = false;\n    private focusTrap: any;\n\n    constructor({\n        targetSelector,\n        guideID,\n        index,\n        data,\n    }: {\n        targetSelector: string;\n        index: number;\n        guideID: string;\n        data: any;\n    }) {\n        const uid = getStepUID({ guideID, index, type: \"backdrop\" });\n        this.stagedTargetClass = `${uid}__target`;\n\n        this.data = Object.assign({}, this.data, getDefinedProps(data));\n        this.targetSelector = targetSelector;\n\n        this.createOverlay();\n\n        // trap focus inside tooltip\n        this.focusTrap = addFocusTrap({\n            target: [\".lusift > .tooltip\", this.targetSelector],\n        });\n    }\n\n    public resetBackdrop(): void {\n        // HACK: intervene in the event backdrop has already been closed and there's a rogue timeout: rare\n        if (this.toStopOverlay) return error(`Lusift: This overlay instance should be removed`);\n        this.removeOverlay();\n        this.createOverlay();\n    }\n\n    private createOverlay(): void {\n        /* document.documentElement.style.overflow = 'hidden';\n           document.body.scroll = \"no\"; */\n        const targetElement = document.querySelector(this.targetSelector);\n        const padding = this.data.stageGap;\n\n        const { documentHeight, documentWidth } = getDocumentDimensions();\n\n        const targetPosition = getElementPosition(targetElement);\n\n        const hTop = document.createElement(\"div\");\n        hTop.id = \"hTop\";\n        const hBottom = document.createElement(\"div\");\n        hBottom.id = \"hBottom\";\n\n        const vLeft = document.createElement(\"div\");\n        vLeft.id = \"vLeft\";\n        const vRight = document.createElement(\"div\");\n        vRight.id = \"vRight\";\n\n        const overlayStyle = {\n            opacity: \"0.5\",\n            background: \"#444\",\n            transition: \"visibility 0.3s ease-in-out\",\n            position: \"absolute\",\n            top: \"0\",\n            bottom: \"0\",\n            left: \"0\",\n            right: \"0\",\n            zIndex: BACKDROP_Z_INDEX,\n            border: \"1px solid transparent\",\n        };\n\n        hTop.style.cssText = styleObjectToString({\n            ...overlayStyle,\n            height: `${targetPosition.bottom - targetPosition.height - padding}px`,\n            width: `${targetPosition.right - targetPosition.left + 2 * padding}px`,\n            left: `${targetPosition.left - padding}px`,\n            bottom: `${targetPosition.top - padding}px`,\n        });\n\n        hBottom.style.cssText = styleObjectToString({\n            ...overlayStyle,\n            height: `${documentHeight - (targetPosition.top + targetPosition.height + padding)}px`,\n            width: `${targetPosition.right - targetPosition.left + 2 * padding}px`,\n            left: `${targetPosition.left - padding}px`,\n            top: `${targetPosition.bottom + padding}px`,\n        });\n\n        vLeft.style.cssText = styleObjectToString({\n            ...overlayStyle,\n            width: `${targetPosition.left - padding}px`,\n            height: `${documentHeight}px`,\n            right: `${targetPosition.left - padding}px`,\n        });\n\n        vRight.style.cssText = styleObjectToString({\n            ...overlayStyle,\n            width: `${documentWidth - (targetPosition.left + targetPosition.width) - padding}px`,\n            height: `${documentHeight}px`,\n            left: `${targetPosition.right + padding}px`,\n        });\n\n        [hTop, hBottom, vLeft, vRight].forEach(el => {\n            el.classList.add(this.overlaySelectorClass);\n            document.body.appendChild(el);\n        });\n        targetElement.classList.add(this.stagedTargetClass);\n\n        // See that the overlay isn't glitchy, reset if it is\n        const { height: hTopHeight, width: hTopWidth } = getElementPosition(hTop);\n        const { height: hBottomHeight } = getElementPosition(hBottom);\n        const vLeftWidth = getElementPosition(vLeft).width;\n        const vRightWidth = getElementPosition(vRight).width;\n\n        const overlaySumWidth = hTopWidth + vLeftWidth + vRightWidth;\n        const overlaySumHeight = hTopHeight + hBottomHeight + targetPosition.height + 2 * padding;\n\n        /* log(screenWidth, overlaySumWidth);\n           log(screenHeight, overlaySumHeight); */\n\n        if (\n            !areNumbersEqual(documentWidth, overlaySumWidth) ||\n            !areNumbersEqual(documentHeight, overlaySumHeight)\n        ) {\n            this.resetBackdrop();\n        }\n    }\n\n    private removeOverlay(): void {\n        document.querySelectorAll(`.${this.overlaySelectorClass}`).forEach((el: HTMLElement) => {\n            if (el) el.remove();\n        });\n\n        const targetElement = document.querySelector(this.targetSelector);\n        if (targetElement) targetElement.classList.remove(this.stagedTargetClass);\n    }\n\n    public remove(): void {\n        // log('removing Backdrop');\n        // remove event listeners\n        this.toStopOverlay = true;\n        if (this.focusTrap) {\n            this.focusTrap.deactivate();\n        }\n        this.removeOverlay();\n    }\n}\n\nexport default Backdrop;\n","import getElementPosition from './getElementPosition';\nimport { document, window } from 'global';\n\nexport default function getDocumentDimensions(): { documentWidth: number; documentHeight: number } {\n    const { height: clientHeight, width: clientWidth } = getElementPosition(\n        document.documentElement,\n    );\n\n    const documentWidth = Math.max(\n        clientWidth,\n        document.body[\"scrollWidth\"],\n        document.documentElement[\"scrollWidth\"],\n        document.body[\"offsetWidth\"],\n        document.documentElement[\"offsetWidth\"],\n    );\n    const documentHeight = Math.max(\n        clientHeight,\n        document.body.scrollHeight,\n        document.documentElement.scrollHeight,\n        document.body.offsetHeight,\n        document.documentElement.offsetHeight,\n    );\n\n    return {\n        documentWidth,\n        documentHeight,\n    };\n}\n","import { document, window } from \"global\";\nimport createTooltip from \"./createTooltip\";\nimport { mergeObjects, getStepUID, debounce } from \"../common/utils\";\nimport { log, warn, error } from \"../common/logger\";\nimport { TooltipData, HotspotAndTooltipTarget as Target, StepActions } from \"../common/types\";\nimport defaultToolipActions from \"./defaultTooltipActions\";\nimport Backdrop from \"../backdrop\";\nimport { autoUpdate } from '@floating-ui/dom';\n\nconst defaultBackdropData = {\n    disabled: false,\n    color: \"#444\",\n    opacity: \"0.5\",\n    stageGap: 5,\n    nextOnOverlayClick: false,\n};\n\nconst tooltipArrowDefaultSize = 12;\nconst tooltipArrowSizeScale = 1;\nconst defaultOffset = [tooltipArrowSizeScale*tooltipArrowDefaultSize, 0]; // x needs to be size of arrow + backdrop gap\n\n// TODO: should we have transition effects for backdrop? it's kind of jerky\n\nexport default class Tooltip {\n    private targetElement: HTMLElement;\n    readonly target: Target;\n    private fuitInstance: any;\n    readonly uid: string;\n    readonly data: Partial<TooltipData>;\n    private actions: StepActions = defaultToolipActions;\n    readonly styleProps: Object = {};\n    private targetsAndEventListeners: {\n        method: string;\n        target: HTMLElement;\n        eventType: string;\n    }[] = [];\n    private backdropInstance: any;\n    private index: number;\n    private guideID: string;\n    private isTooltipShown: boolean = false;\n    private backdropAutoUpdateCleanup!: Function;\n    private onRemove: Function;\n\n    constructor({\n        target,\n        guideID,\n        index,\n        data,\n        actions,\n        styleProps,\n        onRemove\n    }: {\n        target: Target;\n        guideID: string;\n        data: Partial<TooltipData>;\n        index: number;\n        actions: StepActions;\n        styleProps: Object;\n        onRemove: Function\n    }) {\n        log(\"%c Tooltip constructor! \", \"background: #222; color: #bada55\");\n\n        this.target = target;\n        const { elementSelector } = target;\n        this.styleProps = styleProps || {};\n        this.data = data;\n        this.index = index;\n        this.onRemove = onRemove;\n\n\n        const progressOn = data.progressOn || {};\n        this.data.progressOn = {\n            eventType: \"click\",\n            elementSelector,\n            ...progressOn,\n        };\n\n        const backdrop = data.backdrop || {};\n        this.data.backdrop = {\n            ...defaultBackdropData,\n            ...backdrop,\n        };\n        this.data.offset = this.data.offset || defaultOffset;\n        if (!this.data.backdrop.disabled) {\n            // factor in backdrop stage gap in tooltip offset\n            this.data.offset[0] = this.data.offset[0] + this.data.backdrop.stageGap!;\n        }\n\n        this.consolidateActions(actions);\n        this.uid = getStepUID({ guideID, index, type: \"tooltip\" });\n        this.guideID = guideID;\n        this.targetElement = document.querySelector(elementSelector);\n        this.show();\n        log(\"tooltip started\");\n    }\n\n    private hide(): void {\n        // log('tooltip hide');\n        this.fuitInstance.hide();\n        this.removeAllEventListeners();\n        this.backdropInstance && this.backdropInstance.remove();\n        this.backdropInstance = null;\n        this.isTooltipShown = false;\n    }\n\n    private consolidateActions(actions: StepActions) {\n        // merge default actions with incoming actions provided by the developer(user)\n        this.actions = mergeObjects(this.actions, actions);\n    }\n\n    private addBackdrop(): void {\n        const { stageGap, opacity, color } = this.data.backdrop!;\n        const data = {\n            stageGap,\n            opacity,\n            color,\n        };\n        this.backdropInstance = new Backdrop({\n            targetSelector: this.target.elementSelector,\n            guideID: this.guideID,\n            index: this.index,\n            data,\n        });\n        if (this.data.backdrop!.nextOnOverlayClick) {\n            Array.from<HTMLElement>(\n                document.getElementsByClassName(this.backdropInstance.overlaySelectorClass),\n            ).forEach((target: HTMLElement) => {\n                this.addEventListenerToTarget(target, \"next\");\n            });\n        }\n    }\n\n    public async show() {\n        if (!this.targetElement) return error(\"Error: target element not found\");\n        if (this.isTooltipShown) return error(\"Tooltip is already displayed\");\n\n        const { progressOn, backdrop } = this.data;\n\n        const { eventType, disabled } = progressOn!;\n        disabled || this.addEventListenerToTarget(this.targetElement, \"next\", eventType);\n\n        if (!this.fuitInstance) {\n            // fuit was never initiated\n            const { uid, actions, styleProps, data, index } = this;\n            this.fuitInstance = await createTooltip({\n                uid,\n                target: this.targetElement,\n                actions,\n                styleProps,\n                data,\n                scrollIntoView: true,\n                index,\n                onShow: (instance) => {\n                    if(instance.state.isShown) {\n                        backdrop!.disabled || this.addBackdrop.bind(this)();\n                        this.isTooltipShown = true;\n                    } else {\n                        console.log('onShow: WOWWWW')\n                    }\n                },\n                onHide: (instance) => {\n                    if(!backdrop!.disabled) {\n                        this.backdropInstance && this.backdropInstance.remove();\n                        this.backdropInstance = null;\n                        this.isTooltipShown = false;\n                    }\n                },\n            });\n            if (!backdrop!.disabled) {\n\n                const debouncedBackdropReset = debounce((_x?) => {\n                    if (this.backdropInstance) {\n                        this.backdropInstance.resetBackdrop();\n                    }\n                }, 100);\n\n                this.backdropAutoUpdateCleanup = autoUpdate(\n                    this.targetElement,\n                    this.fuitInstance.tooltipElement,\n                    () => {\n                        debouncedBackdropReset(undefined);\n                    },\n                    {\n                        ancestorScroll: false,\n                        ancestorResize: true,\n                        elementResize: true\n                    });\n            }\n        } else {\n            // fuit was hidden\n            this.fuitInstance.show();\n        }\n    }\n\n    public remove(): void {\n        if (!this.isTooltipShown) return error(`Attempted to remove but tooltip is not shown`);\n        log(`removing tooltip ${this.uid}`);\n        this.removeAllEventListeners();\n        this.backdropInstance && this.backdropInstance.remove();\n        this.fuitInstance.remove();\n        this.fuitInstance = null;\n        this.isTooltipShown = false;\n        this.onRemove();\n    }\n\n    private getListenerFromMethod(method: string): EventListenerOrEventListenerObject {\n        switch (method) {\n            case \"next\":\n                return window.Lusift.next;\n            case \"prev\":\n                return window.Lusift.prev;\n            case \"close\":\n                return this.remove;\n            default:\n                return () => {};\n        }\n    }\n\n    private addEventListenerToTarget(\n        target: HTMLElement,\n        method = \"next\",\n        eventType = \"click\",\n    ): void {\n        // add this event listener at the creation of each tooltip step and\n        // remove it at removal of it\n        target.addEventListener(eventType, this.getListenerFromMethod(method));\n        this.targetsAndEventListeners.push({\n            method,\n            target,\n            eventType,\n        });\n    }\n\n    private removeAllEventListeners(): void {\n        this.backdropAutoUpdateCleanup && this.backdropAutoUpdateCleanup();\n        this.targetsAndEventListeners.forEach(({ method, target, eventType }) => {\n            target.removeEventListener(eventType, this.getListenerFromMethod(method));\n            log(`remove event listener of type ${eventType} ` + `and method ${method}`);\n        });\n        this.targetsAndEventListeners = [];\n    }\n}\n","import { document } from \"global\";\nimport { MODAL_OVERLAY_CLASS, MODAL_CLASS, DEFAULT_MODAL_BORDER_RADIUS, MODAL_OVERLAY_Z_INDEX } from \"../common/constants\";\nimport renderProgressBar from \"../common/progressBar\";\nimport renderCloseXButton from \"../common/closeXButton\";\n\nconst defaultBodyContent = `\n  <style>\n  .body-content h2{\n    font-weight: bold;\n    font-size: 1.5rem;\n  }\n  .body-content .button-area{\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    margin: 2rem 0;\n  }\n  </style>\n  <h2>Default Modal Content</h2>\n  <p>some text</p>\n  <div class=\"button-area\">\n  <button class=\"button\" onclick=\"Lusift.next()\">\n  Next\n  </button>\n  </div>`;\n\nconst div = () => document.createElement(\"div\");\n\nexport const noScrollBody = () => {\n  document.body.classList.add(\"lusift-no-scroll\");\n};\n\nexport const restoreScrollBody = () => {\n  document.body.classList.remove(\"lusift-no-scroll\");\n};\n\nconst createModal = ({ uid, index, closeButton = {} }): () => void => {\n\n  const modalOverlay = div();\n  const modal = div();\n  const lusiftWrapper = div();\n  modalOverlay.classList.add(MODAL_OVERLAY_CLASS);\n  modal.id = uid;\n  modal.classList.add(MODAL_CLASS);\n  lusiftWrapper.classList.add(\"lusift\");\n  modal.innerHTML = `\n    ${renderProgressBar()}\n    ${renderCloseXButton(closeButton, \"modal\")}\n    <section class=\"body-content\">\n    </section>\n  `;\n\n  Object.assign(modalOverlay.style, {\n    position:  'fixed',\n    overflowY: \"scroll\",\n    background: \"rgba(40,40,40, .55)\",\n    top: \"0\",\n    left: \"0\",\n    bottom: \"0\",\n    right: \"0\",\n    zIndex: MODAL_OVERLAY_Z_INDEX,\n  });\n\n  Object.assign(modal.style, {\n    margin: '15vh auto',\n    width: '80%',\n    maxWidth: '650px',\n    background: 'rgba(255,255,255, 1)',\n    position: 'relative',\n    borderRadius: DEFAULT_MODAL_BORDER_RADIUS,\n  });\n\n  lusiftWrapper.appendChild(modal);\n  modalOverlay.appendChild(lusiftWrapper);\n  document.body.appendChild(modalOverlay);\n\n  const Lusift = window[\"Lusift\"];\n\n  let bodyContent = defaultBodyContent;\n  const activeGuide = Lusift.getActiveGuide();\n\n  if (activeGuide) {\n    bodyContent = Lusift.getContent()[activeGuide.id].data.steps[index].data.bodyContent;\n  }\n\n  Lusift.render(bodyContent, \".lusift > .modal > .body-content\");\n  noScrollBody();\n\n  return function destroyModal() {\n    document.body.removeChild(modalOverlay);\n    restoreScrollBody();\n  };\n};\n\nexport default createModal;\n","import createModal, { noScrollBody, restoreScrollBody } from \"./createModal\";\nimport { document, window } from \"global\";\nimport { getStepUID, addFocusTrap } from \"../common/utils\";\nimport { ModalData } from \"../common/types\";\nimport { MODAL_OVERLAY_CLASS, MODAL_CLASS } from \"../common/constants\";\n\nclass Modal {\n    private data: ModalData = {};\n    private focusTrap: any;\n    private onRemove: Function;\n    private removeModal: Function;\n\n    constructor({ index, guideID, data, closeButton, onRemove }) {\n        const uid = getStepUID({ guideID, type: \"modal\", index });\n        this.data = data || {};\n        index = index;\n        closeButton = closeButton;\n\n        this.removeModal = createModal({\n            uid,\n            index,\n            closeButton\n        });\n\n        const { escToClose, clickOutsideToClose } = this.data;\n\n        const isDevMode = !window.Lusift.getActiveGuide();\n\n        this.focusTrap = addFocusTrap({\n            target: \".modal\",\n            escapeDeactivates: (e): boolean => {\n                if (!isDevMode && escToClose) {\n                    window['Lusift'].next();\n                    return true;\n                }\n                return false;\n            },\n            clickOutsideDeactivates: (e): boolean => {\n                if (\n                    !isDevMode &&\n                    clickOutsideToClose &&\n                    !e.target.classList.contains(MODAL_CLASS) &&\n                    e.target.classList.contains(MODAL_OVERLAY_CLASS) &&\n                    !e.target.closest(`.${MODAL_CLASS}`)\n                ) {\n                    window['Lusift'].next();\n                    return true;\n                }\n                return false;\n            },\n        });\n\n        this.onRemove = onRemove;\n    }\n\n    private remove(): void {\n        this.focusTrap.deactivate();\n        this.removeModal();\n        this.onRemove();\n    }\n}\n\nexport default Modal;\n","import styleObjectToString from \"../common/utils/styleObjectToString\";\nimport createTooltip from \"../common/createTooltip\";\nimport renderProgressBar from \"../common/progressBar\";\nimport { DEFAULT_TOOLTIP_BORDER_RADIUS } from \"../common/constants\";\n\nconst defaultBodyContent = `\n  <h3 style=\"font-weight: bold;\">Default title</h3>\n  <p style=\"font-weight: normal;\">Default tooltip content</p>\n`;\n\nconst renderTooltip = async ({ remove, data, target, styleProps, uid, index, onClickOutside, showOnCreate }) => {\n    const {\n        arrow,\n        placement,\n        offset,\n        // bodyContent = defaultBodyContent,\n    } = data;\n\n    const content = `\n    <style>\n      .tippy-box{\n        z-index: 999999;\n        border-radius: ${DEFAULT_TOOLTIP_BORDER_RADIUS};\n        ${styleObjectToString(styleProps)}\n      }\n    </style>\n\n    ${renderProgressBar()}\n    <div class=\"lusift\">\n      <div class=\"hotspot-tooltip\" id=\"tooltip-${uid}\">\n        <section class=\"body-content\">\n        </section>\n      </div>\n    </div>\n  `;\n\n    const tooltipInstance = await createTooltip({\n        target,\n        content,\n        arrow,\n        offset,\n        placement,\n        onClickOutside,\n        hideOnReferenceHidden: false,\n        hideOnTooltipEscape: false,\n        showOnCreate,\n        remove: () => {},\n    });\n\n    const Lusift = window[\"Lusift\"];\n\n    let bodyContent = defaultBodyContent;\n    const activeGuide = Lusift.getActiveGuide();\n\n    if (activeGuide) {\n      bodyContent = Lusift.getContent()[activeGuide.id].data.steps[index].data.bodyContent;\n    }\n\n    Lusift.render(bodyContent, \".lusift > .hotspot-tooltip > .body-content\", () => {\n        tooltipInstance.update();\n    });\n\n    return tooltipInstance;\n};\n\nexport default renderTooltip;\n","import { document, window } from \"global\";\nimport { styleObjectToString, getElementPosition } from \"../common/utils\";\nimport { BEACON_CONTAINER_CLASS, BEACON_Z_INDEX } from \"../common/constants\";\n\nconst appendTo = () => document.body;\n\nexport function div(): HTMLDivElement {\n  return document.createElement('div');\n}\n\nexport const positionBeacon = (\n  beaconElement: HTMLDivElement,\n  targetPosition,\n  beaconPlacement: { top: number; left: number; }\n) => {\n    const { targetTop, targetLeft, targetHeight, targetWidth } = targetPosition;\n\n    const { top, left } = beaconPlacement;\n\n    const beaconID = beaconElement.getAttribute('id');\n    const beaconContainer = beaconElement.parentElement!;\n    const beaconEventReceiver = <HTMLElement>beaconElement.querySelector(`#${beaconID}-er`)!;\n\n    Object.assign(beaconContainer.style, {\n      top: `${targetTop}px`,\n      left: `${targetLeft}px`,\n    });\n\n    const { width, height } = getElementPosition(<HTMLElement>beaconElement);\n\n    Object.assign(beaconEventReceiver.style, {\n        width: `${width}px`,\n        height: `${height}px`,\n    });\n\n    Object.assign(beaconElement.style, {\n        top: `${(top / 100) * targetHeight}px`,\n        left: `${(left / 100) * targetWidth}px`\n    });\n}\n\nexport const createBeaconElement = ({ beaconData, beaconID, toggleTooltip }) => {\n\n    const beaconContainer = div();\n    beaconContainer.classList.add(BEACON_CONTAINER_CLASS);\n    Object.assign(beaconContainer.style, {\n        position: \"absolute\",\n    });\n\n    let { size, color, type } = beaconData;\n    const animation = true;\n\n    beaconContainer.innerHTML = `\n    <style>\n      #${beaconID} {\n        background-color: ${color || \"#b9f\"};\n        border-radius: 50%;\n        position: absolute;\n        pointer-events: auto;\n        width: ${size * 13}px;\n        height: ${size * 13}px;\n\n        ${\n            animation\n                ? `\n        -webkit-animation: shine 2s ease-in-out infinite;\n        animation: shine 2s ease-in-out infinite;\n          `\n                : \"\"\n        }\n        cursor: pointer;\n        -webkit-animation-delay: 1s;\n        animation-delay: 1s;\n      }\n\n\n      @-webkit-keyframes shine {\n        0%, 20% {\n          box-shadow: 0px 0px 0px 0px rgba(187, 153, 255, 0.49);\n        }\n        100% {\n          box-shadow: 0px 0px 0px ${20 * size}px rgba(0, 0, 0, 0);\n        }\n      }\n\n      @keyframes shine {\n        0%, 20% {\n          box-shadow: 0px 0px 0px 0px rgba(187, 153, 255, 0.49);\n        }\n        100% {\n          box-shadow: 0px 0px 0px ${20 * size}px rgba(0, 0, 0, 0);\n        }\n      }\n    }\n    </style>\n    <div class=\"lusift-beacon\" id=\"${beaconID}\"></div>\n  `;\n\n\n    appendTo().appendChild(beaconContainer);\n    const beaconElement = <HTMLElement>beaconContainer.querySelector(`#${beaconID}`)!;\n\n    const beaconEventReceiver = div();\n    beaconEventReceiver.id = `${beaconID}-er`;\n\n    Object.assign(beaconEventReceiver.style, {\n        ...beaconElement!.style,\n        background: \"transparent\",\n        zIndex: BEACON_Z_INDEX,\n    });\n\n    beaconElement.appendChild(beaconEventReceiver);\n\n    beaconEventReceiver.addEventListener(\"click\", toggleTooltip);\n    return beaconEventReceiver;\n}\n","import { document, window } from \"global\";\nimport createHotspotTooltip from \"./createHotspotTooltip\";\nimport { createBeaconElement, positionBeacon } from \"./beacon-element\";\nimport { autoUpdate } from '@floating-ui/dom';\nimport {\n    getElementPosition,\n    getStepUID,\n    changeAsyncStepStatus,\n    debounce\n} from \"../common/utils\";\nimport { Hotspot as HotspotData } from \"../common/types\";\nimport { log, warn, error } from \"../common/logger\";\n\n// TODO_: In case of customizing hotspot's beacon, we can just have a beaconElement property\n// TODO: Should the beacon animation stop when tip is open?\n\nclass Hotspot {\n    private tipID: string;\n    private fuitInstance: any;\n    private targetElement: HTMLElement;\n    readonly data: HotspotData;\n    private beaconID: string;\n    private beaconAutoUpdateCleanup!: Function;\n    private onRemove: Function;\n\n    constructor({ data, guideID, onRemove }) {\n        log(data);\n        this.data = data;\n        this.onRemove = onRemove;\n        const { index, type, target } = data;\n        this.tipID = getStepUID({ guideID, type, index });\n        this.beaconID = getStepUID({\n            guideID,\n            type: \"beacon\",\n            index,\n        });\n        this.targetElement = document.querySelector(target.elementSelector);\n        this.addBeacon();\n        this.createTip();\n    }\n\n    private updateBeaconPosition() : void {\n        let {\n            top: targetTop,\n            left: targetLeft,\n            width: targetWidth,\n            height: targetHeight,\n        } = getElementPosition(this.targetElement);\n        const targetPosition = {\n            targetTop,\n            targetLeft,\n            targetWidth,\n            targetHeight,\n        };\n        const beaconData = this.data.beacon;\n\n        const beaconElement = document.getElementById(this.beaconID);\n        positionBeacon(beaconElement, targetPosition, beaconData.placement);\n    }\n\n    private addBeacon(): void {\n        log(\"adding beacon\");\n\n        const beaconData = this.data.beacon;\n\n        createBeaconElement({\n            beaconData,\n            beaconID: this.beaconID,\n            toggleTooltip: this.toggleTooltip.bind(this),\n        });\n        this.updateBeaconPosition();\n    }\n\n    private async createTip() {\n        const Lusift = window[\"Lusift\"];\n        const target = document.getElementById(`${this.beaconID}`);\n        const { data, styleProps } = this.data.tip;\n        const isDevMode = !Boolean(Lusift.getActiveGuide());\n\n        // do not allow async step to close in dev mode\n        const removeMethod = isDevMode ? Lusift.close : this.removeAndCloseAsync.bind(this);\n\n        this.fuitInstance = await createHotspotTooltip({\n            remove: removeMethod,\n            uid: this.tipID,\n            index: this.data.index,\n            target: target,\n            styleProps,\n            showOnCreate: false,\n            data,\n            onClickOutside: (instance, event) => {\n                removeMethod();\n            }\n        });\n\n        // reposition beacon on body and targetElement resize\n\n        const updateBeaconPosition = this.updateBeaconPosition.bind(this);\n\n        const debouncedUpdateBeaconPosition = debounce((_x?) => {\n            updateBeaconPosition();\n        }, 100);\n\n        this.beaconAutoUpdateCleanup = autoUpdate(\n            this.targetElement,\n            this.fuitInstance.tooltipElement,\n            () => {\n                debouncedUpdateBeaconPosition(undefined);\n            },\n            {\n                ancestorScroll: false,\n                ancestorResize: true,\n                elementResize: true\n            });\n    }\n\n    private async toggleTooltip() {\n        // log('toggle tooltip');\n\n        const activeHotspot = window.Lusift.activeHotspot;\n        const Lusift = window[\"Lusift\"];\n\n        if (activeHotspot && this.data.index !== activeHotspot.data.index) {\n            // hide any other potentially active hotspot tip\n            Lusift.activeHotspot.hideTooltip();\n        }\n\n        if (this.fuitInstance.getState().isRemoved) {\n            error(\"Uh... but it doesn't exist. unexpected\");\n            // if it's removed\n        } else if (this.fuitInstance.getState().isShown) {\n            await this.hideTooltip();\n        } else if (this.fuitInstance) {\n            // if it's hidden\n            await this.fuitInstance.show();\n            Lusift.activeHotspot = this;\n        }\n    }\n\n    // TODO: refactor names, here it could be hideTip()\n    public async hideTooltip() {\n        await this.fuitInstance.hide();\n        window.Lusift.activeHotspot = null;\n    }\n\n    private changeAsyncStepStatus(toOpen: boolean): void {\n        if (!this.data.async) return;\n        changeAsyncStepStatus(this.data.index, toOpen);\n    }\n\n    private async remove() {\n        log(`Removing id: ${this.data.index} hotspot`);\n\n        if (this.fuitInstance) {\n            if (this.fuitInstance.getState().isShown) {\n                await this.hideTooltip();\n            }\n            if (this.fuitInstance.getState().isRemoved) {\n                log(\"Hotspot's tooltip is already destroyed\");\n            } else {\n                this.fuitInstance.remove();\n            }\n        } else {\n            log(\"Hotspot closed without ever opening\");\n        }\n        const beaconElement = document.getElementById(this.beaconID);\n        if (beaconElement) {\n            beaconElement.parentElement.remove();\n        }\n    }\n\n    private removeResizeObservers(): void {\n        this.beaconAutoUpdateCleanup();\n    }\n\n    private removeAndCloseAsync(): void {\n        this.remove();\n        this.changeAsyncStepStatus(false);\n        this.removeResizeObservers();\n        this.onRemove();\n    }\n}\n\nexport default Hotspot;\n","import Tooltip from \"../tooltip\";\nimport Modal from \"../modal\";\nimport Hotspot from \"../hotspot\";\n\nconst startStepInstance = (stepData: any, guideID: string, onRemove: Function): void => {\n    const { index, target, type, data, closeButton } = stepData;\n    let activeStepInstance: any;\n\n    if (type === \"tooltip\") {\n        const { actions, styleProps } = stepData;\n\n        activeStepInstance = new Tooltip({\n            target,\n            data,\n            index,\n            guideID,\n            actions,\n            styleProps,\n            onRemove\n        });\n    } else if (type === \"modal\") {\n        activeStepInstance = new Modal({\n            index,\n            guideID,\n            data,\n            closeButton,\n            onRemove\n        });\n    } else if (type === \"hotspot\") {\n        activeStepInstance = new Hotspot({\n            data: stepData,\n            guideID,\n            onRemove\n        });\n    }\n    return activeStepInstance;\n};\n\nexport default startStepInstance;\n","import { window } from \"global\";\nimport { saveState, loadState } from \"../common/store\";\nimport { log, warn, error } from \"../common/logger\";\nimport {\n    changeAsyncStepStatus,\n    doesStepMatchDisplayCriteria,\n} from \"../common/utils\";\n\nimport startStepInstance from './startStepInstance';\n\nimport { GuideType, ActiveStep, TrackingState, StepTargetType } from \"../common/types\";\n\nexport default class Guide {\n    readonly guideData: GuideType;\n    private activeSteps: ActiveStep[] = [];\n\n    constructor(guideID: string) {\n        // localGuideState consists of trackingState and guideData\n        log(\"guide constructor\");\n        log(loadState());\n        const localGuideState = window['Lusift'].getContent()[guideID].data;\n        const guideData = Object.assign({}, localGuideState);\n\n        this.guideData = guideData;\n        log(\n            `%c Welcome to guide: ${this.guideData.name || this.guideData.id}`,\n            \"background: #222; color: #bada55\",\n        );\n        const trackingState = loadState()[guideID]?.trackingState;\n\n        if (!trackingState) {\n            this.resetTrackingState();\n        }\n    }\n\n    public getActiveSteps(): ActiveStep[] {\n        return this.activeSteps;\n    }\n\n    private generateNewTrackingState(): TrackingState {\n        let newTrackingState = {\n            currentStepIndex: 0,\n            finished: false,\n            prematurelyClosed: false,\n            asyncSteps: {},\n            enabled: false,\n        };\n\n        //for async steps\n        this.guideData.steps.forEach(step => {\n            if (\"async\" in step) {\n                if (step.async && step.type === \"hotspot\") {\n                    newTrackingState.asyncSteps[step.index] = {\n                        toOpen: false,\n                    };\n                }\n            }\n        });\n        return newTrackingState;\n    }\n\n    public start(): void {\n        const { finished, prematurelyClosed } = this.getTrackingState();\n        this.removeIllegalSteps();\n        this.attemptToStartAsyncSteps();\n\n        if (finished || prematurelyClosed) {\n            error(\"Guide is already finished or closed\");\n        } else {\n            this.attemptToShowActiveStep();\n        }\n    }\n\n    public removeAllActiveSteps(): void {\n        this.activeSteps.forEach(stepInstance => {\n            // instance.reRenderPageElements();\n            const { type, target, instance, async } = stepInstance;\n            if (async && type === \"hotspot\") {\n                instance.removeResizeObservers();\n            }\n            instance.remove();\n        });\n        this.activeSteps = [];\n    }\n\n    public reRenderStepElements(): void {\n        log(\"re-render step elements\");\n        this.removeAllActiveSteps();\n        this.start();\n    }\n\n    private attemptToShowActiveStep(): void {\n        // we start with some currentStep from this.trackingState\n        // if the step is async, set toOpen to true\n        // -- if display criteria matches and step isn't already displayed, then startStep\n        // if the step is async, loop back with stepIndex++\n        const { currentStepIndex } = this.getTrackingState();\n        let stepIndex = currentStepIndex;\n        const { steps } = this.guideData;\n        let isAsyncStep: boolean;\n\n        stepIndex--;\n        do {\n            stepIndex++;\n            const step = steps[stepIndex];\n            const { target, type } = steps[stepIndex];\n            let async = false;\n            if (\"async\" in step) {\n                async = step.async!;\n            }\n            const displayCriteriaMatches = doesStepMatchDisplayCriteria({\n                target,\n                type,\n            });\n            isAsyncStep = async && type === \"hotspot\";\n\n            if (isAsyncStep) {\n                changeAsyncStepStatus(stepIndex, true);\n            }\n            if (displayCriteriaMatches && !this.isStepActive(stepIndex)) {\n                this.activeSteps.push({\n                    index: stepIndex,\n                    instance: startStepInstance(\n                        steps[stepIndex],\n                        this.guideData.id,\n                        () => {\n                            this.activeSteps = this.activeSteps.filter(step => {\n                                return step.index !== stepIndex;\n                            });\n                        }\n                    ),\n                    target,\n                    type,\n                    async,\n                });\n            }\n        } while (isAsyncStep);\n\n        let newTrackingState = this.getTrackingState();\n        newTrackingState.currentStepIndex = stepIndex;\n        this.setTrackingState(newTrackingState);\n    }\n\n    private isStepActive(stepIndex: number): boolean {\n        return this.activeSteps.some(({ index }) => index === stepIndex);\n    }\n\n    public getProgress(): number {\n        // filter out steps that are not of type hotspot with async property of true\n        const syncSteps = this.guideData.steps.filter(step => {\n            return !(step.type === \"hotspot\" && step['async']);\n        });\n        const currentStep = this.guideData.steps[this.getTrackingState().currentStepIndex];\n\n        const progress =\n            ((syncSteps.findIndex(step => {\n                return step.index === currentStep.index;\n            }) +\n                1) /\n                (syncSteps.length + 1)) *\n            100;\n        return progress;\n    }\n\n    private attemptToStartAsyncSteps(): void {\n        // start all the async hotpots with toOpen true\n        const steps = this.guideData.steps;\n        steps.forEach(step => {\n            const { type, index, target } = step;\n            let async = false;\n            if (\"async\" in step) {\n                async = step.async!;\n            }\n            if (async && type === \"hotspot\") {\n                if (\n                    doesStepMatchDisplayCriteria({ target, type }) &&\n                    this.getTrackingState().asyncSteps[index].toOpen\n                ) {\n                    log(`Step ${index}: target path and element matched. toOpen is true`);\n                    // if step is already active warn that the step is already active\n                    if (this.isStepActive(index)) {\n                        return warn(`Step ${index} is already active`);\n                    }\n                    this.activeSteps.push({\n                        index,\n                        instance: startStepInstance(\n                            steps[index],\n                            this.guideData.id,\n                            () => {\n                                this.activeSteps = this.activeSteps.filter(step => {\n                                    return step.index !== index;\n                                });\n                            }\n                        ),\n                        target,\n                        type,\n                        async,\n                    });\n                }\n            }\n        });\n    }\n\n    private removeIllegalSteps(): void {\n        this.activeSteps = this.activeSteps.filter(stepInstance => {\n            // if step display criteria doesn't match, then run remove() and remove from this.activeSteps\n            const { type, target, instance, async } = stepInstance;\n            if (!doesStepMatchDisplayCriteria({ target, type })) {\n                if (async && type === \"hotspot\") {\n                    instance.removeResizeObservers();\n                }\n                instance.remove();\n                return false;\n            } else {\n                return true;\n            }\n        });\n    }\n\n    private setTrackingState(trackingState: TrackingState): void {\n        const existingState = loadState();\n        saveState({\n            ...existingState,\n            [this.guideData.id]: {\n                ...existingState[this.guideData.id],\n                trackingState,\n            },\n        });\n    }\n\n    public getTrackingState(): TrackingState {\n        return loadState()[this.guideData.id].trackingState;\n    }\n\n    private resetTrackingState(): void {\n        const newTrackingState = this.generateNewTrackingState();\n        this.setTrackingState(newTrackingState);\n    }\n\n    public setStep(newStepNum: number): void {\n        // change step and see which steps need to be unmounted or mounted\n        let newTrackingState = this.getTrackingState();\n        if (newStepNum < 0) {\n            return error(\"Step index can't be less than 0\");\n        } else if (newStepNum + 1 > this.guideData.steps.length) {\n            if (!newTrackingState.finished) {\n                this.closeCurrentStep();\n                newTrackingState.finished = true;\n                this.setTrackingState(newTrackingState);\n            }\n            log(\"Guide finished\");\n        } else {\n            this.closeCurrentStep();\n            newTrackingState.currentStepIndex = newStepNum;\n            this.setTrackingState(newTrackingState);\n            this.start();\n        }\n    }\n\n    public remove(): void {\n        // remove guide\n        // if current step is last step then finished=true, else prematurelyClosed=true\n        let newTrackingState = this.getTrackingState();\n        if (newTrackingState.currentStepIndex + 1 === this.guideData.steps.length) {\n            newTrackingState.finished = true;\n        } else {\n            newTrackingState.prematurelyClosed = true;\n        }\n        this.setTrackingState(newTrackingState);\n        this.removeAllActiveSteps();\n        log(\"guide closed\");\n    }\n\n    private closeCurrentStep(): void {\n        // if this.trackingState.activeStep is equal to any index of item from this.activeSteps, then log('hello')\n        const { currentStepIndex } = this.getTrackingState();\n        const currentStep = this.activeSteps.find(({ index }) => index === currentStepIndex);\n\n        if (currentStep) {\n            currentStep.instance.remove();\n            this.activeSteps = this.activeSteps.filter(\n                instance => instance.index !== currentStepIndex,\n            );\n        } else {\n            warn(\"There's no active step to close\");\n        }\n    }\n\n    public nextStep(): void {\n        const newStep = this.getTrackingState().currentStepIndex + 1;\n        if (newStep + 1 > this.guideData.steps.length) {\n            return error(\"No new steps\");\n        }\n        this.closeCurrentStep();\n        this.setStep(newStep);\n        typeof window.Lusift.onNext === \"function\" && window.Lusift.onNext();\n    }\n\n    public prevStep(): void {\n        // make newStep the index of the closest previus step with !step.async\n        let newStep = this.getTrackingState().currentStepIndex;\n\n        while (newStep > -2) {\n            newStep--;\n            const step = this.guideData.steps[newStep];\n            if (!step) {\n                break;\n            }\n            let async = false;\n            if (\"async\" in step) {\n                async = step.async!;\n            }\n            let stepIsAsync = step.type === \"hotspot\" && async;\n            if (!stepIsAsync) {\n                break;\n            }\n        }\n        if (newStep < 0) return error(\"No previous steps\");\n        this.closeCurrentStep();\n        this.setStep(newStep);\n        const Lusift = window[\"Lusift\"];\n        typeof Lusift.onPrev === \"function\" && Lusift.onPrev();\n    }\n}\n","import Guide from \"./Guide\";\nimport { saveState, loadState, setDefaultState } from \"../common/store\";\nimport { log, error, warn } from \"../common/logger\";\nimport { doesStepMatchDisplayCriteria } from \"../common/utils\";\nimport startStepInstance from './startStepInstance';\n\nimport { window, document } from \"global\";\n\nimport { Content, LocalState, ActiveGuide } from \"../common/types\";\n\nimport { isOfTypeContent, isObject } from \"../common/utils/isOfType\";\n\nimport addDefaultCSS from \"./addDefaultCSS\";\n\n// TODO: Write documentation\n\n// TODO: decide on making configuring easier, with inheritence, global levels etc.\n// TODO: Add merging with defaults\n// -- write a content object with defaults\n// -- Maybe don't have setContent take everything, seperate concerns. makes documenting easier too\n// NOTE_: Support for different typescript versions\n// TODO_: add support for angul*r\n// TODO: Tooltip positioning for different screen sizes\n// -- how do the comercial saas handle it? automatically or end-user config?\n// -- have the options for orientation be `auto` and `fixed` with positions being the different axis relative to\n// the target. With auto, the position is only picked when there is space for the tooltip, else it moves to different position\nconst positioning = {\n    position: '', // top, bottom, left, right\n    orientation: '' // auto, fixed\n}\n// NOTE: Handling versioning\n// TODO: Can we just export element classes (Tooltip, Modal, Hotspot, Backdrop) and have them be optionally loadable by the client?\n// -- something like how modifiers work in popperjs\n\nconst noOp = () => {}; // no-op function\n\nconst devNavMethod = () => {\n    error(`Can't run this method in dev mode`);\n}\n\nclass Lusift {\n    private content: Content = {};\n    public render: (body: any, targetPath: string, callback?: Function) => void = noOp;\n    private activeGuide: ActiveGuide | null = null;\n    private isDevMode: boolean = false;\n    private navigationMethods = {\n        next: noOp,\n        prev: noOp,\n        close: noOp,\n        goto: (x) => {},\n    }\n\n    constructor() {\n        log(\"%c Lusift constructor! \", \"background: #222; color: #bada55\");\n\n        const localData = loadState();\n        // set default state\n        if (!isObject(localData)) {\n            setDefaultState();\n        }\n        addDefaultCSS();\n    }\n\n    public next(): void {\n        return this.navigationMethods.next();\n    }\n\n    public prev(): void {\n        return this.navigationMethods.prev();\n    }\n\n    public goto(newStepNum: number): void {\n        return this.navigationMethods.goto(newStepNum);\n    }\n\n    public close(): void {\n        this.navigationMethods.close();\n    }\n\n    private showEnabledContent(): void {\n        const localData = loadState();\n        const enabledGuideID = Object.keys(localData).find(key => {\n            const { trackingState } = localData[key];\n            if(trackingState){\n                return trackingState.enabled\n            }\n            return false;\n        });\n        if (enabledGuideID) {\n            this.showContent(enabledGuideID);\n        } else {\n            return warn(`No content enabled.`)\n        }\n    }\n\n    public getActiveGuide(): ActiveGuide | null {\n        if (!this.activeGuide) return null;\n        let { instance, id } = this.activeGuide;\n        const {\n            guideData,\n            getTrackingState,\n            getActiveSteps,\n            getProgress,\n            reRenderStepElements,\n        } = instance;\n\n        return {\n            id,\n            instance: {\n                guideData,\n                getTrackingState,\n                getProgress,\n                getActiveSteps,\n                reRenderStepElements,\n            }\n        }\n    }\n\n    private doesGuideExist(guideID: string): boolean {\n        return Object.keys(this.getContent()!)\n            .some(key => key === guideID);\n    }\n\n    public enable(guideID: string): void {\n        let localData = this.getTrackingState();\n        if(!this.doesGuideExist(guideID)) {\n            return error(`Content of id '${guideID}' doesn't exist`);\n        }\n\n        // enable content of id $guideID, disable all else\n        Object.keys(localData).forEach(key => {\n            const { trackingState } = localData[key];\n            if(trackingState){\n                localData[key].trackingState.enabled = key === guideID;\n            }\n        });\n        saveState(localData);\n        this.showContent(guideID);\n    }\n\n    public disable(guideID: string): void {\n        let localData = loadState();\n        if(!this.doesGuideExist(guideID)) {\n            return error(`Content of id '${guideID}' doesn't exist`);\n        }\n        localData[guideID].trackingState.enabled = false;\n        saveState(localData);\n    }\n\n    public setContent(content: Content): void {\n        // filter and validate content\n        if (!isOfTypeContent(content)) {\n            return error(\"Content data type is invalid\");\n        }\n\n        // retrieve approriate properties from received content\n        this.content = content!;\n        Object.keys(content).forEach(key => {\n            const {\n                id,\n                name = \"\",\n                description = \"\",\n                steps,\n                onNext,\n                onPrev,\n                onClose,\n            } = content[key].data;\n\n            this.content[key].data = {\n                id,\n                name,\n                description,\n                steps,\n                onNext,\n                onPrev,\n                onClose,\n            };\n        });\n\n        // for any already active guide\n        if (this.activeGuide) {\n            const contentIDExists = this.doesGuideExist(this.activeGuide.id);\n            // if the contentID doesn't exist at all in the new content received\n            if (!contentIDExists!) {\n                this.activeGuide.instance.removeAllActiveSteps!();\n                this.activeGuide = null;\n            }\n        }\n    }\n\n    public getContent(): Content {\n        return this.content;\n    }\n\n    public refresh(): void {\n        // run page elements through step display conditionals again\n        if (this.activeGuide) {\n            this.activeGuide!.instance.start!();\n            log(\"Lusift refreshed\");\n        } else {\n            warn(\"No active guide instance to refresh\");\n            // Assuming this method is called every time on page load.\n            // Better than running in constructor which runs on import of Lusift\n            this.showEnabledContent();\n        }\n    }\n\n    public showContent<T extends string>(contentID: T extends \"\" ? never : T): void {\n        // Forces specific Lusift content to appear for the current user by passing in the ID.\n\n        if (this.isDevMode){\n            return devNavMethod();\n        }\n        this.isDevMode = false;\n        const content = this.getContent();\n        if (Object.keys(content).length === 0) {\n            return error(`Content not set, pass valid content data to setContent()`);\n        }\n        // see if content exists for contentID\n        if (!this.doesGuideExist(contentID)) {\n            return error(`Content with id of ${contentID} doesn't exist`);\n        }\n        // when there's an active guide already\n        if (this.activeGuide) {\n            const { instance, id } = this.activeGuide;\n\n            if (id === contentID) {\n                this.activeGuide.instance.reRenderStepElements();\n                return error(`${contentID} is already active`);\n            } else {\n                return this.close();\n            }\n        }\n\n        // See if contentID, if in trackingState, isn't closed\n        // if it is, don't instantiate it\n        const guideTrackingState = loadState()[contentID]?.trackingState;\n        if(guideTrackingState?.finished || guideTrackingState?.prematurelyClosed) {\n            return warn(`Guide '${contentID}' is closed.`);\n        }\n        const newGuideInstance = new Guide(contentID);\n\n        const {\n            nextStep,\n            prevStep,\n            setStep,\n            remove,\n            getTrackingState,\n            reRenderStepElements,\n            start,\n            getActiveSteps,\n            getProgress,\n            removeAllActiveSteps,\n            guideData\n        } = newGuideInstance;\n\n        this.activeGuide = {\n            id: contentID,\n            instance: {\n                guideData,\n                getTrackingState: getTrackingState.bind(newGuideInstance),\n                getProgress: getProgress.bind(newGuideInstance),\n                getActiveSteps: getActiveSteps.bind(newGuideInstance),\n                reRenderStepElements: reRenderStepElements.bind(newGuideInstance),\n                removeAllActiveSteps: removeAllActiveSteps.bind(newGuideInstance),\n                start: start.bind(newGuideInstance)\n            }\n        };\n        newGuideInstance.start();\n\n        // attach active content's navigation methods, and hooks to Lusift instance\n        const activeGuideID = this.activeGuide!.id;\n\n        const close = () => {\n            if (this.activeGuide) {\n                remove.bind(newGuideInstance)();\n                this.disable(activeGuideID);\n                typeof this.onClose === \"function\" && this.onClose();\n                this.activeGuide = null;\n                log(`Closed ${activeGuideID}`);\n            } else {\n                return error(`No active guide to close`);\n            }\n        }\n\n        this.navigationMethods = {\n            next: nextStep.bind(newGuideInstance),\n            prev: prevStep.bind(newGuideInstance),\n            goto: setStep.bind(newGuideInstance),\n            close,\n        }\n    }\n    public onNext(): void {\n        const activeGuideID = this.activeGuide!.id;\n        if (activeGuideID){\n            return this.content[activeGuideID].data.onNext!();\n        }\n    }\n\n    public onPrev(): void {\n        const activeGuideID = this.activeGuide!.id;\n        if (activeGuideID){\n            return this.content[activeGuideID].data.onPrev!();\n        }\n    }\n\n    public onClose(): void {\n        const activeGuideID = this.activeGuide!.id;\n        if (activeGuideID){\n            return this.content[activeGuideID].data.onClose!();\n        }\n    }\n\n    public setGlobalStyle(styleText: string): void {\n        let customStyle = document.querySelector(\"style[lusift-custom-css]\");\n        customStyle.textContent = styleText;\n    }\n\n    public getTrackingState(): LocalState {\n        return loadState();\n    }\n\n    public devShowStep(guideID: string, stepNumber: number): void {\n        // dev mode: to be used to develop/style step elements\n        // if there is some other content active already, refuse to show dev mode\n        if (this.activeGuide) {\n            return warn(\n                `Can\\'t enable dev mode because a ` + `guide is active using showContent()`,\n            );\n        }\n        if (!this.content) {\n            return warn(\n                `Content not set, pass valid content object ` +\n                    `to setContent() before running devShowStep()`,\n            );\n        }\n        this.navigationMethods = {\n            next: devNavMethod,\n            prev: devNavMethod,\n            goto: devNavMethod,\n            close: devNavMethod,\n        };\n        this.isDevMode = true;\n\n        if (this.content[guideID]) {\n            const { steps } = this.content[guideID].data;\n            const { target, type } = steps[stepNumber];\n\n            if (!doesStepMatchDisplayCriteria({ target, type })) {\n                return warn(\n                    `Display criteria for step do not match. Navigate to ` +\n                        `the right target page and make sure that the target ` +\n                        `element is in the visible screen, then reload page.`,\n                );\n            }\n\n            if (steps[stepNumber]) {\n                startStepInstance(\n                    steps[stepNumber],\n                    guideID,\n                    () => {}\n                );\n                log(\n                    `%c Showing step ${stepNumber} of ${guideID} in dev mode`,\n                    \"background: #222; color: #bada55\",\n                );\n            } else {\n                error(`Guide '${guideID}' doesn't have a step ${stepNumber}`);\n            }\n        } else {\n            error(`Guide with id '${guideID}' doesn't exist`);\n        }\n    }\n}\n\nexport default Lusift;\n","import { window, document } from \"global\";\nimport lusiftDefaultCSS from \"./style/lusift.css\";\n\n// Inject default lusift global styles\nexport default () => {\n    if (typeof document === \"undefined\") return;\n\n    const lusiftDefault = document.createElement(\"style\");\n    lusiftDefault.type = \"text/css\";\n    lusiftDefault.setAttribute(\"lusift-default\", \"\");\n    lusiftDefault.textContent = lusiftDefaultCSS;\n\n    const lusiftCustom = document.createElement(\"style\");\n    lusiftCustom.type = \"text/css\";\n    lusiftCustom.setAttribute(\"lusift-custom\", \"\");\n\n    const customStyle = document.createElement(\"style\");\n    customStyle.type = \"text/css\";\n    customStyle.setAttribute(\"lusift-custom-css\", \"\");\n\n    const docFrag = document.createDocumentFragment();\n    // append all style elements to the document fragment\n    docFrag.appendChild(lusiftDefault);\n    docFrag.appendChild(lusiftCustom);\n    docFrag.appendChild(customStyle);\n    // append the document fragment to the document\n    document.head.appendChild(docFrag);\n};\n","import Lusift from \"./Lusift\";\nimport { LusiftInstance } from '../common/types';\n\nconst lusiftInstance = new Lusift();\n\nconst {\n    setContent,\n    showContent,\n    getContent,\n    refresh,\n    getActiveGuide,\n    enable,\n    disable,\n    setGlobalStyle,\n    getTrackingState,\n    devShowStep,\n    close,\n    next,\n    prev,\n    goto,\n    onClose,\n    onNext,\n    onPrev,\n    render\n} = lusiftInstance;\n\n\nconst instance: LusiftInstance = {\n    setContent: setContent.bind(lusiftInstance),\n    showContent: showContent.bind(lusiftInstance),\n    getContent: getContent.bind(lusiftInstance),\n    refresh: refresh.bind(lusiftInstance),\n    getActiveGuide: getActiveGuide.bind(lusiftInstance),\n    enable: enable.bind(lusiftInstance),\n    disable: disable.bind(lusiftInstance),\n    setGlobalStyle: setGlobalStyle.bind(lusiftInstance),\n    getTrackingState: getTrackingState.bind(lusiftInstance),\n    devShowStep: devShowStep.bind(lusiftInstance),\n    close: close.bind(lusiftInstance),\n    next: next.bind(lusiftInstance),\n    prev: prev.bind(lusiftInstance),\n    goto: goto.bind(lusiftInstance),\n    onClose: onClose.bind(lusiftInstance),\n    onNext: onNext.bind(lusiftInstance),\n    onPrev: onPrev.bind(lusiftInstance),\n    render: render\n}\n\nexport default instance;\n","import React from \"react\";\nimport Lusift from \"../../lusift\";\nimport { window, document } from \"global\";\nimport ReactDOM from \"react-dom\";\nimport { Content } from \"../../common/types\";\nimport { vanillaRender } from \"../../common/utils\";\nimport { isReactComponent, isReactClassComponent } from \"../../common/utils/isOfType\";\n\nconst reactRender = (BodyComponent: any, targetPath: string, callback?: Function) => {\n    const target = document.querySelector(targetPath);\n    ReactDOM.render(<BodyComponent />, target);\n    if (callback) callback();\n};\n\nconst renderBodyContent = (body: any, targetPath: string, callback?: Function): void => {\n    if (isReactComponent(body)) {\n        reactRender(body, targetPath, callback);\n    } else {\n        vanillaRender(body, targetPath, callback);\n    }\n};\n\nif (typeof window !== \"undefined\") {\n    window.addEventListener(\"error\", e => console.log(e), true);\n    Lusift.render = renderBodyContent;\n    window[\"Lusift\"] = Lusift;\n}\n\nexport { Lusift as default, Content as LusiftContent };\n","const vanillaRender = (elementToRender: string, targetPath: string, callback?: Function) => {\n    const target = document.querySelector(targetPath);\n    target!.innerHTML = elementToRender;\n    if (callback) callback();\n};\n\nexport default vanillaRender;\n"],"names":["window_1","window","global","self","log","console","warn","message","_i","args","messagePrefix","error","STATE_ITEM_NAME","loadState","serialisedState","localStorage","getItem","JSON","parse","err","saveState","state","stringify","setItem","isObject","item","Object","constructor","isObjectOrUndefined","object","isOfTypeTooltipData","placements","forEach","p","push","arrow","offset","length","actions","includes","placement","contentBody","progressOn","backdrop","isOfTypeStep","index","type","elementSelectorExists","elementSelector","path","comparator","value","isOfTypeTarget","target","data","styleProps","isOfTypeTooltip","isOfTypeHotspot","closeButton","isOfTypeModal","isOfTypeContent","itemTypes","values","every","id","name","description","steps","hasOwnProperty","isOfTypeGuide","mergeObjects","obj1","obj2","assign","keys","key","e","styleObjectToString","stylesString","replace","m","toLowerCase","getStepUID","_a","guideID","getElementPosition","element","documentElement","document","body","scrollTop","pageYOffset","scrollLeft","pageXOffset","elementRect","getBoundingClientRect","top","left","right","width","bottom","height","changeAsyncStepStatus","stepIndex","toOpen","exisitingState","activeGuideID","Lusift","getActiveGuide","trackingState","asyncSteps","roundNum","decimalPlaces","Math","round","Number","EPSILON","pow","doesStepPathMatch","targetPath","str","location","currentPath","endsWith","startsWith","RegExp","test","doesStepMatchesDisplayCriteria","criteriaMatch","Boolean","querySelector","candidateSelectors","candidateSelector","join","matches","Element","prototype","msMatchesSelector","webkitMatchesSelector","getTabindex","node","tabindexAttr","parseInt","getAttribute","isNaN","contentEditable","isContentEditable","nodeName","tabIndex","sortOrderedTabbables","a","b","documentOrder","isInput","tagName","isNonTabbableRadio","isRadio","radioSet","radioScope","form","ownerDocument","queryRadios","querySelectorAll","CSS","escape","checked","nodes","i","getCheckedRadio","isTabbableRadio","isNodeMatchingSelectorFocusable","options","disabled","isHiddenInput","displayCheck","getComputedStyle","visibility","nodeUnderDetails","call","parentElement","_node$getBoundingClie","display","isHidden","Array","slice","apply","children","some","child","isDetailsWithSummary","parentNode","contains","isDisabledFromFieldset","isNodeMatchingSelectorTabbable","tabbable","el","regularTabbables","orderedTabbables","candidates","includeContainer","filter","unshift","getCandidates","bind","candidate","candidateTabindex","sort","map","concat","focusableCandidateSelector","isFocusable","Error","ownKeys","enumerableOnly","getOwnPropertySymbols","symbols","sym","getOwnPropertyDescriptor","enumerable","_defineProperty","obj","defineProperty","configurable","writable","trapQueue","activeFocusTraps","activateTrap","trap","activeTrap","pause","trapIndex","indexOf","splice","deactivateTrap","unpause","delay","fn","setTimeout","findIndex","arr","idx","valueOrHandler","_len","arguments","params","_key","getActualTarget","event","shadowRoot","composedPath","createFocusTrap","elements","userOptions","doc","config","source","getOwnPropertyDescriptors","defineProperties","_objectSpread2","returnFocusOnDeactivate","escapeDeactivates","delayInitialFocus","containers","tabbableGroups","nodeFocusedBeforeActivation","mostRecentlyFocusedNode","active","paused","delayInitialFocusTimer","undefined","getOption","configOverrideOptions","optionName","configOptionName","containersContain","container","getNodeForOption","optionValue","_len2","_key2","getInitialFocusNode","activeElement","firstTabbableGroup","firstTabbableNode","updateTabbableNodes","tabbableNodes","lastTabbableNode","group","tryFocus","focus","preventScroll","select","isSelectableInput","getReturnFocusNode","previousActiveElement","checkPointerDown","clickOutsideDeactivates","deactivate","returnFocus","allowOutsideClick","preventDefault","checkFocusIn","targetContained","Document","stopImmediatePropagation","checkKey","keyCode","isEscapeEvent","isTabEvent","destinationNode","containerIndex","_ref","shiftKey","startOfGroupIndex","_ref2","destinationGroupIndex","lastOfGroupIndex","_ref3","_destinationGroupIndex","checkTab","checkClick","addListeners","addEventListener","capture","passive","removeListeners","removeEventListener","activate","activateOptions","this","onActivate","onPostActivate","checkCanFocusTrap","finishActivation","then","deactivateOptions","clearTimeout","onDeactivate","onPostDeactivate","checkCanReturnFocus","finishDeactivation","updateContainerElements","containerElements","elementsAsArray","addFocusTrap","arg","_b","ft","focusTrap.createFocusTrap","debounce","ms","timeout","MODAL_OVERLAY_CLASS","MODAL_CLASS","DEFAULT_TOOLTIP_BORDER_RADIUS","DEFAULT_MODAL_BORDER_RADIUS","renderProgressBar","currentGuide","currentStep","getContent","currentStepIndex","progressBarData","progressBar","_c","color","borderRadius","progress","instance","getProgress","renderCloseXButton","stepType","module","t","o","setAttribute","n","style","r","createElement","s","box","content","_instance","props","onHide","transitionDuration","setState","isShown","onShow","l","d","__awaiter","c","u","h","f","g","v","w","x","y","_","E","S","O","k","C","T","H","D","L","z","A","j","P","R","U","q","I","M","N","W","V","F","X","B","G","__generator","J","label","toFlip","toShift","hideOnReferenceHidden","hideOnTooltipEscape","arrowSizeScale","resetPlacementOnUpdate","showOnCreate","middleware","__spreadArray","mainAxis","crossAxis","autoPlacement","shift","padding","flip","fallbackPlacements","fallbackStrategy","size","reference","floating","hide","computePosition","sent","middlewareData","referenceHidden","escaped","scrollIntoView","behavior","block","inline","centerOffset","split","fui","allowHTML","hideOnClick","onClickOutside","onStateChange","onRemove","maxWidth","updateDebounce","zIndex","updateOnEvents","isRemoved","updateListenerCleanup","toHideTooltip","clickHandler","tooltipElement","textContent","head","appendChild","hookEventListeners","debouncedUpdate","update","autoUpdate","updateTransitionDuration","create","className","innerHTML","innerText","getState","__assign","show","remove","require$$0","require$$1","createTooltip","floatingTooltip","renderTooltip","uid","navSection","nextButton","prevButton","dismissLink","renderNavButtons","tooltipInstance","bodyContent","activeGuide","render","text","areNumbersEqual","num1","num2","num1Precision","toString","substring","num2Precision","min","targetSelector","stageGap","opacity","stagedTargetClass","entries","createOverlay","focusTrap","Backdrop","toStopOverlay","removeOverlay","targetElement","clientHeight","clientWidth","documentWidth","max","documentHeight","scrollHeight","offsetHeight","getDocumentDimensions","targetPosition","hTop","hBottom","vLeft","vRight","overlayStyle","background","transition","position","border","cssText","classList","add","_this","overlaySelectorClass","hTopHeight","hTopWidth","hBottomHeight","overlaySumWidth","overlaySumHeight","resetBackdrop","defaultBackdropData","nextOnOverlayClick","defaultOffset","tooltipArrowSizeScale","defaultToolipActions","eventType","consolidateActions","Tooltip","fuitInstance","removeAllEventListeners","backdropInstance","isTooltipShown","from","getElementsByClassName","addEventListenerToTarget","_d","addBackdrop","_e","debouncedBackdropReset_1","_x","backdropAutoUpdateCleanup","ancestorScroll","ancestorResize","elementResize","method","next","prev","getListenerFromMethod","targetsAndEventListeners","div","createModal","modalOverlay","modal","lusiftWrapper","overflowY","margin","removeChild","removeModal","escToClose","clickOutsideToClose","isDevMode","closest","Modal","createBeaconElement","beaconData","beaconID","toggleTooltip","beaconContainer","beaconElement","beaconEventReceiver","tipID","addBeacon","createTip","Hotspot","targetTop","targetLeft","targetWidth","targetHeight","beacon","beaconPlacement","positionBeacon","getElementById","updateBeaconPosition","tip","removeMethod","close","removeAndCloseAsync","createHotspotTooltip","debouncedUpdateBeaconPosition","beaconAutoUpdateCleanup","activeHotspot","hideTooltip","async","removeResizeObservers","startStepInstance","stepData","activeStepInstance","localGuideState","guideData","resetTrackingState","Guide","activeSteps","newTrackingState","finished","prematurelyClosed","enabled","step","getTrackingState","removeIllegalSteps","attemptToStartAsyncSteps","attemptToShowActiveStep","stepInstance","removeAllActiveSteps","start","isAsyncStep","displayCriteriaMatches","doesStepMatchDisplayCriteria","isStepActive","setTrackingState","syncSteps","existingState","generateNewTrackingState","newStepNum","closeCurrentStep","find","newStep","setStep","onNext","onPrev","noOp","devNavMethod","goto","lusiftDefault","lusiftCustom","customStyle","docFrag","createDocumentFragment","addDefaultCSS","navigationMethods","localData","enabledGuideID","showContent","getActiveSteps","reRenderStepElements","doesGuideExist","onClose","showEnabledContent","contentID","guideTrackingState","newGuideInstance","nextStep","prevStep","disable","styleText","stepNumber","lusiftInstance","setContent","refresh","enable","setGlobalStyle","devShowStep","callback","BodyComponent","ReactDOM","React","reactRender","elementToRender","vanillaRender"],"mappings":"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"}